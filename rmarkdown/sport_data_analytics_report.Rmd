---
title: "SWISS OLYMPIC SPORT ANALYSIS"
output: html_document
date: "2023-02-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r importds, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
olympics <- read.csv("C:/Users/buson/OneDrive/Documenti/R_universita/sportdataanalytics/Data/athletics.csv")
```

## 1. Development of athletics

In this chapter, the development of athletics is shown. Four sports of athletics are examined, which are the 100m sprint, 200m, 400m and the long jump. Accordingly, the reader is first explained the sport and then the development of the times from 1930 to now are highlighted, as well as for men as for women.

```{r cars, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
library(readr)
library(tidyverse)
library(ggplot2)
athletics_master_0 <- olympics
```

## 1.1 Discipline - 100m sprint

### 1.1.1 Explanation of 100m sprint

Athletes competing in the 100-meter sprint must cover the distance in a straight line as quickly as they can. Athletes sprint off the line and pick up speed quickly to get to and maintain their top speed. Timing is done in hundredths of seconds, and the winner is the first competitor to cross the finish line. The 100-meter sprint calls for a lot of physical stamina, quickness, and explosive power in addition to coordination and technique. The start is important because a poor start or an incorrect starting position can cost vital tenths of a second. One of the most prestigious events in athletics is the 100-meter sprint, which is frequently referred to as the "supreme discipline."


### 1.1.2 Performance of the male athletes in 100m sprint 

```{r k1, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
athletics_master <- athletics_master_0
sprint_100m <- athletics_master %>%
  filter(athletics_master$Discipline == "100m", athletics_master$Gender == "Men", athletics_master$Year >= 1930, athletics_master$Competition %in% c("World Championships", "Olympic Games"), athletics_master$Rank %in% c("3"))

sprint_100m$Result <- na.omit(sprint_100m$Result)
sprint_100m$Result <- as.numeric(sprint_100m$Result)
Result_3rd_place <- sprint_100m$Result
Year <- sprint_100m$Year

ggplot()+ geom_line(sprint_100m, mapping = aes(x = Year, y = Result_3rd_place), color = "#00AFBB") 
```

An analysis of times in the men's 100m sprint at the Olympic Games and World Championships in Athletics from 1930 to the present shows that running times have continued to improve over the years. In the early 1930s through 1956, the average time for the third-place runner was 10.4 to 10.6 seconds. In the 1960s, the time for a medal was lowered to 10.1 seconds. After that, for the next ten years, it was possible to win a bronze medal with a faster time than 10.1 seconds. Starting in 1986, the times for a podium finish dropped dramatically and continued to evolve until today. Since 2012, a time of under 10.00 must be achieved to be considered for a medal. However, it should also be noted that the times from 1930 to 1986 have evolved much more dramatically than from 1986 to the present, which may indicate that the human (man) factor is reaching its limits.


### 1.1.3 Performance of the female athletes in 100m sprint 

```{r k2, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
athletics_master <- athletics_master_0
sprint_100m <- athletics_master %>%
  filter(athletics_master$Discipline == "100m", athletics_master$Gender == "Women", athletics_master$Year >= 1930, athletics_master$Competition %in% c("World Championships", "Olympic Games"), athletics_master$Rank %in% c("3"))

sprint_100m$Result <- na.omit(sprint_100m$Result)
sprint_100m$Result <- as.numeric(sprint_100m$Result)
Result_3rd_place <- sprint_100m$Result
Year <- sprint_100m$Year

ggplot()+ geom_line(sprint_100m, mapping = aes(x = Year, y = Result_3rd_place), color = "#00AFBB") 
```

In women's 100m sprint, a similar pattern to the men's can also be seen when observing the data. Here, too, one sees a steady improvement in times from 1930 to the present. From 1932 to 1956, times ranged from 12 to 11.70 seconds for a 3rd place finish at a major event. After that, the times decreased steadily to 11.24 seconds until 1968, which represents an improvement of about 4%. From the year 1968 until today the times for the bronze place developed continuously to 10.76 seconds. This means that the athlete who won a bronze medal in 1968 must be about 4.27% faster today.

## 1.2 Discipline - 200m 

### 1.2.1 Explanation of 200m

The 200-meter race is one of the disciplines in athletics that are in the sprint area. The distance is 200 meters and the athletes start from a starting block.
In a 200-meter race, the athletes must run a curve before getting onto the straight. The turn is usually tighter than the straight, which means that the athletes have to run tighter and can slow down their speed a bit. After the turn, athletes accelerate on the straight and try to reach and maintain their top speed to win the race.
There are special techniques that sprinters use to maintain their speed. For example, they may keep their arms close to their body and take quick, short strides to run faster. Good sprinting technique can make the difference between winning and losing.
The 200-meter dash is an exciting race because it requires a combination of speed, strength and technique. It also requires excellent physical conditioning, as athletes must maintain their maximum speed over a longer distance than in the 100-meter run.


### 1.2.2 Performance of the male athletes in 200m 

```{r k3, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
athletics_master <- athletics_master_0
sprint_200m <- athletics_master %>%
  filter(athletics_master$Discipline == "200m", athletics_master$Gender == "Men", athletics_master$Year >= 1930, athletics_master$Competition %in% c("World Championships", "Olympic Games"), athletics_master$Rank %in% c("3"))

sprint_200m$Result <- na.omit(sprint_200m$Result)
sprint_200m$Result <- as.numeric(sprint_200m$Result)
Result_3rd_place <- sprint_200m$Result
Year <- sprint_200m$Year

ggplot()+ geom_line(sprint_200m, mapping = aes(x = Year, y = Result_3rd_place), color = "#00AFBB") 
```

In 1932, the time of 21.50 seconds was enough to win a medal. Over the years, the athlete's times continued to develop, so that the time of 20.10 seconds was broken in 1968 by a bronze medalist. This means that it took 36 years to improve the bronze time of 1932 by about 6.6%. From then on, the improvement was volatile in the range of 19.74 seconds.

### 1.2.3 Performance of the female athletes in 200m 

```{r k4, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
athletics_master <- athletics_master_0
sprint_200m <- athletics_master %>%
  filter(athletics_master$Discipline == "200m", athletics_master$Gender == "Women", athletics_master$Year >= 1930, athletics_master$Competition %in% c("World Championships", "Olympic Games"), athletics_master$Rank %in% c("3"))

sprint_200m$Result <- na.omit(sprint_200m$Result)
sprint_200m$Result <- as.numeric(sprint_200m$Result)
Result_3rd_place <- sprint_200m$Result
Year <- sprint_200m$Year

ggplot()+ geom_line(sprint_200m, mapping = aes(x = Year, y = Result_3rd_place), color = "#00AFBB") 
```

When looking at the 3rd place times, a similar pattern can be identified for both men and women. From the year 1948 to 1968, the times improved rapidly from 25.20 to 22.88 seconds (- 9.02%). After that, the times develop volatile between the ranges 22.88 and 21.87 seconds.

## 1.3 Discipline - 400m 

### 1.3.1 Explanation of 400m

The 400-meter race is one of the most demanding disciplines in the track and field sprint section. In this discipline, athletes also start from a starting block and run once around the stadium track, which corresponds to a distance of 400 meters.
Athletes must perfect their speed and endurance during the race, as they must sprint for a longer time than in the 200-meter race. The race usually begins with a quick acceleration from the starting block, followed by a sustained top speed through the first turn. Then athletes enter the straightaway and must continue to maintain their pace while doing their best to reach the finish line.
A successful 400-meter runner needs excellent conditioning to achieve the speed and endurance required. It also requires good technique to ensure that the athlete uses their energy efficiently and can maintain their speed without exhausting themselves.
The 400-meter course is known for demanding everything from the athletes, especially in the last 100 meters when they have to move towards the finish line and give their maximum. The 400-meter race is an exhilarating event that requires both physical and mental strength and is often considered one of the most difficult events in track and field.


### 1.3.2 Performance of the male athletes in 400m 

```{r k5, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
athletics_master <- athletics_master_0
sprint_400m <- athletics_master %>%
  filter(athletics_master$Discipline == "400m", athletics_master$Gender == "Men", athletics_master$Year >= 1930, athletics_master$Competition %in% c("World Championships", "Olympic Games"), athletics_master$Rank %in% c("3"))

sprint_400m$Result <- na.omit(sprint_400m$Result)
sprint_400m$Result <- as.numeric(sprint_400m$Result)
Result_3rd_place <- sprint_400m$Result
Year <- sprint_400m$Year

ggplot()+ geom_line(sprint_400m, mapping = aes(x = Year, y = Result_3rd_place), color = "#00AFBB") 
```

In the men's 400m, times for a bronze medal ranged from 47.40 to 46.80 seconds from the early 1930s to 1956. Subsequently, the times for a podium finish developed steadily, so that in 1968 the time of 40.41 seconds was set by a third-place finisher. From the year 1968 until today the times improved discontinuously and the results moved in the range of 43.85 to 45.25 seconds. From this it can be concluded that the third place finisher in 1968 would also have a chance to win a medal in the 2000s.

### 1.3.3 Performance of the female athletes in 400m 

```{r k6, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
athletics_master <- athletics_master_0
sprint_400m <- athletics_master %>%
  filter(athletics_master$Discipline == "400m", athletics_master$Gender == "Women", athletics_master$Year >= 1930, athletics_master$Competition %in% c("World Championships", "Olympic Games"), athletics_master$Rank %in% c("3"))

sprint_400m$Result <- na.omit(sprint_400m$Result)
sprint_400m$Result <- as.numeric(sprint_400m$Result)
Result_3rd_place <- sprint_400m$Result
Year <- sprint_400m$Year

ggplot()+ geom_line(sprint_400m, mapping = aes(x = Year, y = Result_3rd_place), color = "#00AFBB") 
```

The women's 400m race was held for the first time at the 1964 Tokyo Olympics. In the first event, the third-place finisher clocked a time of 53.40 seconds. At the 1984 Olympics, a time of 49.62 seconds was needed to win a medal. After that, the times were mainly in the range of 49.46 to 50.45 seconds, with the exception of the bronze time of 49.10 seconds at the 1996 Olympics. 


## 1.4 Discipline - Long Jump 

### 1.4.1 Explanation of Long Jump

The long jump is one of the disciplines in track and field where the goal is to jump as far as possible. The athlete starts from a marker on a run-up track and then jumps into a sandbox.
The long jump begins with the run-up, where the athlete picks up speed and then jumps from the take-off board. During the run-up, it is important for the athlete to maintain speed and rhythm in order to achieve the best possible distance at the jump.
During the jump itself, the athlete must stay in the air and jump as far as possible before landing in the sandbox. There are special techniques that a long jumper can use to maximize their jumping distance. For example, they can position their arms and legs at certain angles to create more momentum and height.
After landing in the sandbox, the distance is measured by measuring the distance from the jump board to where the athlete landed in the sand. If an athlete exceeds the distance of another athlete, he wins the race.
The long jump requires a combination of speed, power and technique, and the best long jumpers are able to perfect these elements to maximize their performance. It is also a very visual and exciting discipline, as spectators can watch athletes sprint through the run-up lane at great speed and leap into the air before landing in the sand.


### 1.4.2 Performance of the male athletes in Long Jump 
```{r k7,echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
athletics_master <- athletics_master_0
LT <- athletics_master %>%
  filter(athletics_master$Discipline == "Long Jump", athletics_master$Gender == "Men", athletics_master$Year >= 1930, athletics_master$Competition %in% c("World Championships", "Olympic Games"), athletics_master$Rank %in% c("3"))

LT$Result <- na.omit(LT$Result)
LT$Result <- as.numeric(LT$Result)
Result_3rd_place <- LT$Result
Year <- LT$Year

ggplot()+ geom_line(LT, mapping = aes(x = Year, y = Result_3rd_place), color = "#00AFBB") 
```

From the 1930s to the late 1950s, the distances of bronze medalists ranged from 7.30 to 7.48 meters. From 1968 until today, the jump distances of the bronze medalists developed in the range of 8.03 meters to 8.42 meters.

### 1.4.3 Performance of the female athletes in Long Jump 

```{r k8,echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
athletics_master <- athletics_master_0
LT <- athletics_master %>%
  filter(athletics_master$Discipline == "Long Jump", athletics_master$Gender == "Women", athletics_master$Year >= 1930, athletics_master$Competition %in% c("World Championships", "Olympic Games"), athletics_master$Rank %in% c("3"))

LT$Result <- na.omit(LT$Result)
LT$Result <- as.numeric(LT$Result)
Result_3rd_place <- LT$Result
Year <- LT$Year

ggplot()+ geom_line(LT, mapping = aes(x = Year, y = Result_3rd_place), color = "#00AFBB") 
```

At the 1948 and 1952 Olympics, the respective bronze medalists achieved a distance of 5.52 meters and 5.92 meters. In 1983, at the World Championships, the third-placed athlete jumped a distance of 7.04 meters. From that year until today, the distances of the third-placed athlete at a major event have ranged between 6.69 meters and 7.08 meters.

## 1.5 Conclusion of the chapter "Development of athletics"

The improvement in track and field times can be attributed to several factors, including improvements in training methodology and nutrition, as well as advances in technology and materials of starting blocks and running shoes. It is also interesting to note that in recent decades there has been some controversy regarding the performance of athletes who have doped. However, anti-doping campaigns have intensified in recent years, which has helped improve the sport's credibility and integrity. Overall, performance development in athletics has been amazing over the past 90 years, and best times are likely to continue to improve as athletes and scientists continue to work hard to find new ways to overcome the limits of human performance.


## 2 Athletics Result Trends: Switzerland compared to the World Best

```{r setup2, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# load packages
library(pacman)
pacman::p_load(janitor, dplyr, tidyr, ggplot2, plotly, fmsb)

# load data
athletics_master <- olympics
```

### 2.1 Documentation


```{r data preperation 100m Men, include=FALSE}
# data cleaning and selection 
athletics_selection_100m_men <- athletics_master %>% 
  mutate(Rank = as.numeric(Rank), Result = as.numeric(Result)) %>% 
  filter(Year %in% c(2000:2023), !is.na(Rank), !is.na(Result), !Competition == "Diamond League", Discipline == "100m", Gender == "Men") %>% 
  select(Year, Competition, Discipline, Gender, Class, Person.Team, Person, Rank, Age, Nationality, Result)

# results of finalists in Wch and OG who came in last
rank8_wch_og_100m_men <- athletics_selection_100m_men %>% 
  # filter results so that outliers are not being taken into consideration
  filter(Rank %in% c(1:8), Result < 10.5, Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_max(Rank) %>% 
  ungroup()%>% 
  mutate(reference_type = "Certificate_WCh_and_OG")
  
# results of finalists in Wch and OG who came in first
rank1_wch_og_100m_men <- athletics_selection_100m_men %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_min(Rank) %>% 
  ungroup() %>% 
  group_by(Year, Rank) %>% 
  slice_min(Result) %>% 
  ungroup() %>% 
  mutate(reference_type = "Rank1_WCh_and_OG")

# best result of each season from Swiss athletes
swissathletes_100m_men <- athletics_selection_100m_men %>% 
  filter(Nationality == "SUI", Class == "Seniors") %>%
  group_by(Year) %>% 
  slice_min(Result) %>%
  ungroup() %>% 
  mutate(reference_type = "Swiss_Season_Best") 

# combining data frames to one whole
referencetimes_100m_men <- bind_rows(rank8_wch_og_100m_men, rank1_wch_og_100m_men, swissathletes_100m_men) 

# individual results of chosen Swiss athletes
 get_swissindividual_100m_men <- function(athlete = "Muijnga Kambundji"){
   athletics_selection_100m_men %>%
   filter(Nationality == "SUI", Person == athlete) %>%
   group_by(Year) %>%
   slice_min(Result) %>%
   mutate(reference_type = athlete)
 }

# create ggplot
 g_reference_100m_men <- ggplot(data = referencetimes_100m_men, mapping = aes(Year, Result))+
   geom_line(mapping = aes(colour = reference_type))+
   #geom_point(data = get_swissindividual_100m_men(athlete = "Alex Wilson"), mapping = aes(Year, Result, colour = reference_type), inherit.aes = FALSE) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )

```



```{r Difference Switzerland to Worlds Best 100m Men, echo=FALSE}
# diff_referencetimes_100m_men <- referencetimes_100m_men %>% 
#   distinct(Year, reference_type, Result) %>% 
#   group_by(Year) %>% 
#   pivot_wider(names_from = reference_type, values_from = Result) %>% 
#   ungroup() %>% 
#   arrange(Year) %>% 
#   mutate(difftoworldbest = Swiss_Season_Best - Seasons_World_Best,
#          difftorank1 = Swiss_Season_Best - Rank1_WCh_and_OG,
#          difftorank8 = Swiss_Season_Best - Certificate_WCh_and_OG) %>% 
#   select(Year, difftoworldbest, difftorank1, difftorank8) %>% 
#   pivot_longer(cols = c(2:4), names_to = "reference_type", values_to = "value") %>%
#   filter(!is.na(value))

# ggplotly(ggplot(diff_referencetimes_100m_men, aes(Year, value, colour = reference_type))+
#   geom_line())

```


```{r data preperation 200m Men, include=FALSE}
# data cleaning and selection 
athletics_selection_200m_men <- athletics_master %>% 
  mutate(Rank = as.numeric(Rank), Result = as.numeric(Result)) %>% 
  filter(Year %in% c(2000:2023), !is.na(Rank), !is.na(Result), !Competition == "Diamond League", Discipline == "200m", Gender == "Men") %>% 
  select(Year, Competition, Discipline, Gender, Class, Person.Team, Person, Rank, Age, Nationality, Result)

# results of finalists in Wch and OG who came in last
rank8_wch_og_200m_men <- athletics_selection_200m_men %>% 
  # filter results so that outliers are not being taken into consideration
  filter(Rank %in% c(1:8), Result < 21.00, Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_max(Rank) %>% 
  ungroup()%>% 
  mutate(reference_type = "Certificate_WCh_and_OG")
  
# results of finalists in Wch and OG who came in first
rank1_wch_og_200m_men <- athletics_selection_200m_men %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_min(Rank) %>% 
  ungroup() %>% 
  group_by(Year, Rank) %>% 
  slice_min(Result) %>% 
  ungroup() %>% 
  mutate(reference_type = "Rank1_WCh_and_OG")

# best result of each season from swiss athletes
swissathletes_200m_men <- athletics_selection_200m_men %>% 
  filter(Nationality == "SUI", Class == "Seniors") %>%
  group_by(Year) %>% 
  slice_min(Result) %>%
  ungroup() %>% 
  mutate(reference_type = "Swiss_Season_Best")

# combining dataframes to one whole
referencetimes_200m_men <- bind_rows(rank8_wch_og_200m_men, rank1_wch_og_200m_men, swissathletes_200m_men)

# individual results of chosen swiss athletes
get_swissindividual_200m_men <- function(athlete = "Muijnga Kambundji"){
  athletics_selection_200m_men %>% 
  filter(Nationality == "SUI", Person == athlete) %>%
  group_by(Year) %>% 
  slice_min(Result) %>% 
  mutate(reference_type = athlete)
}

# create ggplot
g_reference_200m_men <- ggplot(data = referencetimes_200m_men, mapping = aes(Year, Result))+
  geom_line(mapping = aes(colour = reference_type))+
  #geom_point(data = get_swissindividual_200m_men(athlete = "Alex Wilson"), mapping = aes(Year, Result, colour = reference_type), inherit.aes = FALSE) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )

```


```{r Difference Switzerland to Worlds Best 200m Men, echo=FALSE}
# diff_referencetimes_200m_men <- referencetimes_200m_men %>% 
#   distinct(Year, reference_type, Result) %>% 
#   group_by(Year) %>% 
#   pivot_wider(names_from = reference_type, values_from = Result) %>% 
#   ungroup() %>% 
#   arrange(Year) %>% 
#   mutate(difftoworldbest = Swiss_Season_Best - Seasons_World_Best,
#          difftorank1 = Swiss_Season_Best - Rank1_WCh_and_OG,
#          difftorank8 = Swiss_Season_Best - Certificate_WCh_and_OG) %>% 
#   select(Year, difftoworldbest, difftorank1, difftorank8) %>% 
#   pivot_longer(cols = c(2:4), names_to = "reference_type", values_to = "value") %>%
#   filter(!is.na(value))
# 
# ggplotly(ggplot(diff_referencetimes_200m_men, aes(Year, value, colour = reference_type))+
#   geom_line())

```




```{r data preperation 400m Men, include=FALSE}
# data cleaning and selection 
athletics_selection_400m_men <- athletics_master %>% 
  mutate(Rank = as.numeric(Rank), Result = as.numeric(Result)) %>% 
  filter(Year %in% c(2000:2023), !is.na(Rank), !is.na(Result), !Competition == "Diamond League", Discipline == "400m", Gender == "Men") %>% 
  select(Year, Competition, Discipline, Gender, Class, Person.Team, Person, Rank, Age, Nationality, Result)

# results of finalists in Wch and OG who came in last
rank8_wch_og_400m_men <- athletics_selection_400m_men %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_max(Rank) %>% 
  ungroup()%>% 
  mutate(reference_type = "Certificate_WCh_and_OG")
  
# results of finalists in Wch and OG who came in first
rank1_wch_og_400m_men <- athletics_selection_400m_men %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_min(Rank) %>% 
  ungroup() %>% 
  group_by(Year, Rank) %>% 
  slice_min(Result) %>% 
  ungroup() %>% 
  mutate(reference_type = "Rank1_WCh_and_OG")

# best result of each season from swiss athletes
swissathletes_400m_men <- athletics_selection_400m_men %>% 
  filter(Nationality == "SUI") %>%
  group_by(Year) %>% 
  slice_min(Result) %>%
  ungroup() %>% 
  mutate(reference_type = "Swiss_Season_Best")

# combining dataframes to one whole
referencetimes_400m_men <- bind_rows(rank8_wch_og_400m_men, rank1_wch_og_400m_men, swissathletes_400m_men)

# individual results of chosen swiss athletes
get_swissindividual_400m_men <- function(athlete = "Muijnga Kambundji"){
  athletics_selection_400m_men %>% 
  filter(Nationality == "SUI", Person == athlete) %>%
  group_by(Year) %>% 
  slice_min(Result) %>% 
  mutate(reference_type = athlete)
}

# create ggplot
g_reference_400m_men <- ggplot(data = referencetimes_400m_men, mapping = aes(Year, Result))+
  geom_line(mapping = aes(colour = reference_type))+
  #geom_point(data = get_swissindividual_400m_men(athlete = "Ricky Petrucciani"), mapping = aes(Year, Result, colour = reference_type), inherit.aes = FALSE) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )

```


```{r Difference Switzerland to Worlds Best 400m Men, echo=FALSE}
# diff_referencetimes_400m_men <- referencetimes_400m_men %>% 
#   distinct(Year, reference_type, Result) %>% 
#   group_by(Year) %>% 
#   pivot_wider(names_from = reference_type, values_from = Result) %>% 
#   ungroup() %>% 
#   arrange(Year) %>% 
#   mutate(difftoworldbest = Swiss_Season_Best - Seasons_World_Best,
#          difftorank1 = Swiss_Season_Best - Rank1_WCh_and_OG,
#          difftorank8 = Swiss_Season_Best - Certificate_WCh_and_OG) %>% 
#   select(Year, difftoworldbest, difftorank1, difftorank8) %>% 
#   pivot_longer(cols = c(2:4), names_to = "reference_type", values_to = "value") %>%
#   filter(!is.na(value))
# 
# ggplotly(ggplot(diff_referencetimes_400m_men, aes(Year, value, colour = reference_type))+
#   geom_line())

```



```{r data preperation Long Jump Men, include=FALSE}
# data cleaning and selection 
athletics_selection_longjump_men <- athletics_master %>% 
  mutate(Rank = as.numeric(Rank), Result = as.numeric(Result)) %>% 
  filter(Year %in% c(2000:2023), !is.na(Rank), !is.na(Result), !Competition %in% c("Diamond League", "World Indoor Tour"), Discipline == "Long Jump", Gender == "Men") %>% 
  select(Year, Competition, Discipline, Gender, Class, Person.Team, Person, Rank, Age, Nationality, Result)

# results of finalists in Wch and OG who came in last
rank8_wch_og_longjump_men <- athletics_selection_longjump_men %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_max(Rank) %>% 
  ungroup()%>% 
  mutate(reference_type = "Certificate_WCh_and_OG")
  
# results of finalists in Wch and OG who came in first
rank1_wch_og_longjump_men <- athletics_selection_longjump_men %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_min(Rank) %>% 
  ungroup() %>% 
  group_by(Year, Rank) %>% 
  slice_max(Result) %>% 
  ungroup() %>% 
  mutate(reference_type = "Rank1_WCh_and_OG")

# best result of each season from swiss athletes
swissathletes_longjump_men <- athletics_selection_longjump_men %>% 
  filter(Nationality == "SUI") %>%
  group_by(Year) %>% 
  slice_max(Result) %>%
  ungroup() %>% 
  mutate(reference_type = "Swiss_Season_Best")

# combining dataframes to one whole
reference_longjump_men <- bind_rows(rank8_wch_og_longjump_men, rank1_wch_og_longjump_men, swissathletes_longjump_men)

# individual results of chosen swiss athletes
get_swissindividual_longjump_men <- function(athlete = "Muijnga Kambundji"){
  athletics_selection_longjump_men %>% 
  filter(Nationality == "SUI", Person == athlete) %>%
  group_by(Year) %>% 
  slice_max(Result) %>% 
  mutate(reference_type = athlete)
}

# create ggplot
g_reference_longjump_men <- ggplot(data = reference_longjump_men, mapping = aes(Year, Result))+
  geom_line(mapping = aes(colour = reference_type))+
  #geom_point(data = get_swissindividual_longjump_men(athlete = "Simon Ehammer"), mapping = aes(Year, Result, colour = reference_type), inherit.aes = FALSE) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )

```


```{r Difference Switzerland to Worlds Best Long Jump Men, echo=FALSE}
# diff_reference_longjump_men <- reference_longjump_men %>% 
#   distinct(Year, reference_type, Result) %>% 
#   group_by(Year) %>% 
#   pivot_wider(names_from = reference_type, values_from = Result) %>% 
#   ungroup() %>% 
#   arrange(Year) %>% 
#   mutate(difftoworldbest = Seasons_World_Best - Swiss_Season_Best,
#          difftorank1 = Rank1_WCh_and_OG - Swiss_Season_Best,
#          difftorank8 = Certificate_WCh_and_OG - Swiss_Season_Best) %>% 
#   select(Year, difftoworldbest, difftorank1, difftorank8) %>% 
#   pivot_longer(cols = c(2:4), names_to = "reference_type", values_to = "value") %>%
#   filter(!is.na(value))
# 
# ggplotly(ggplot(diff_reference_longjump_men, aes(Year, value, colour = reference_type))+
#   geom_line())

```


```{r dataframes for spider plot men, echo=FALSE, error=FALSE}
# World Records
seasonsworldbest_100m_men <- athletics_selection_100m_men %>% 
  filter(Class == "Seniors") %>%
  slice_min(Result, with_ties = F) %>% 
  ungroup() %>% 
  mutate(reference_type = "Seasons_World_Best")

seasonsworldbest_200m_men <- athletics_selection_200m_men %>% 
  filter(Class == "Seniors") %>%
  slice_min(Result, with_ties = F) %>%
  mutate(reference_type = "Seasons_World_Best")

seasonsworldbest_400m_men <- athletics_selection_400m_men %>% 
  filter(Class == "Seniors") %>%
  slice_min(Result, with_ties = F) %>% 
  mutate(reference_type = "Seasons_World_Best")

seasonsworldbest_longjump_men <- athletics_selection_longjump_men %>% 
  filter(Class == "Seniors") %>%
  slice_max(Result, with_ties = F) %>% 
  mutate(reference_type = "Seasons_World_Best")

# Mittelwert über die letzten 6 Jahre bilden (2016 - 2022)
mean_referencetimes_100m_men <- referencetimes_100m_men %>% 
  filter(Year %in% 2016:2022) %>% 
  group_by(reference_type) %>% 
  summarize(mean = mean(Result)) %>% 
  ungroup() %>%
# Weltrekord hinzufügen 
  bind_rows(seasonsworldbest_100m_men %>% summarize(mean = min(Result), reference_type = "Seasons_World_Best")) %>% 
  mutate(discipline = "100m_men") %>% 
  pivot_wider(names_from = reference_type, values_from = mean) %>% 
# Vergleichen mit Weltrekord (normalisieren)  
  mutate(Certificate_WCh_and_OG = (11.19-Certificate_WCh_and_OG)/(11.19-Seasons_World_Best),
         Rank1_WCh_and_OG = (11.19-Rank1_WCh_and_OG)/(11.19-Seasons_World_Best),
         Swiss_Season_Best = (11.19-Swiss_Season_Best)/(11.19-Seasons_World_Best),
         Seasons_World_Best = 1) %>% 
  rename(
    "Certificate WCh and OG" = Certificate_WCh_and_OG,
    "Gold Medal WCh and OG" = Rank1_WCh_and_OG,
    "Swiss Season Best" = Swiss_Season_Best,
    "World Record" = Seasons_World_Best
  )

# Mittelwert über die letzten 6 Jahre bilden 
mean_referencetimes_200m_men <- referencetimes_200m_men %>% 
  filter(Year %in% 2016:2022) %>% 
  group_by(reference_type) %>% 
  summarize(mean = mean(Result)) %>% 
  ungroup() %>% 
# Weltrekord hinzufügen 
  bind_rows(seasonsworldbest_200m_men %>% summarize(mean = min(Result), reference_type = "Seasons_World_Best")) %>%
  mutate(discipline = "200m_men") %>% 
  pivot_wider(names_from = reference_type, values_from = mean) %>% 
# Vergleichen mit Weltrekord (normalisieren)  
  mutate(Certificate_WCh_and_OG = (22.97-Certificate_WCh_and_OG)/(22.97-Seasons_World_Best),
         Rank1_WCh_and_OG = (22.97-Rank1_WCh_and_OG)/(22.97-Seasons_World_Best),
         Swiss_Season_Best = (22.97-Swiss_Season_Best)/(22.97-Seasons_World_Best),
         Seasons_World_Best = 1) %>% 
  rename(
    "Certificate WCh and OG" = Certificate_WCh_and_OG,
    "Gold Medal WCh and OG" = Rank1_WCh_and_OG,
    "Swiss Season Best" = Swiss_Season_Best,
    "World Record" = Seasons_World_Best
  )

# Mittelwert über die letzten 6 Jahre bilden 
mean_referencetimes_400m_men <- referencetimes_400m_men %>% 
  filter(Year %in% 2016:2022) %>% 
  group_by(reference_type) %>% 
  summarize(mean = mean(Result)) %>% 
  ungroup() %>% 
# Weltrekord hinzufügen 
  bind_rows(seasonsworldbest_400m_men %>% summarize(mean = min(Result), reference_type = "Seasons_World_Best")) %>%
  mutate(discipline = "400m_men") %>% 
  pivot_wider(names_from = reference_type, values_from = mean) %>% 
# Vergleichen mit Weltrekord (normalisieren)  
  mutate(Certificate_WCh_and_OG = (50.97-Certificate_WCh_and_OG)/(50.97-Seasons_World_Best),
         Rank1_WCh_and_OG = (50.97-Rank1_WCh_and_OG)/(50.97-Seasons_World_Best),
         Swiss_Season_Best = (50.97-Swiss_Season_Best)/(50.97-Seasons_World_Best),
         Seasons_World_Best = 1) %>% 
  rename(
    "Certificate WCh and OG" = Certificate_WCh_and_OG,
    "Gold Medal WCh and OG" = Rank1_WCh_and_OG,
    "Swiss Season Best" = Swiss_Season_Best,
    "World Record" = Seasons_World_Best
  )

# Mittelwert über die letzten 6 Jahre bilden 
mean_reference_longjump_men <- reference_longjump_men %>% 
  filter(Year %in% 2016:2022) %>% 
  group_by(reference_type) %>% 
  summarize(mean = mean(Result)) %>% 
  ungroup() %>% 
# Weltrekord hinzufügen  
  bind_rows(seasonsworldbest_longjump_men %>% summarize(mean = max(Result), reference_type = "Seasons_World_Best")) %>%
  mutate(discipline = "longjump_men") %>% 
  pivot_wider(names_from = reference_type, values_from = mean) %>% 
# Vergleichen mit Weltrekord (normalisieren)  
  mutate(Certificate_WCh_and_OG = (6.80-Certificate_WCh_and_OG)/(6.80-Seasons_World_Best),
         Rank1_WCh_and_OG = (6.80-Rank1_WCh_and_OG)/(6.80-Seasons_World_Best),
         Swiss_Season_Best = (6.80-Swiss_Season_Best)/(6.80-Seasons_World_Best),
         Seasons_World_Best = 1) %>% 
  rename(
    "Certificate WCh and OG" = Certificate_WCh_and_OG,
    "Gold Medal WCh and OG" = Rank1_WCh_and_OG,
    "Swiss Season Best" = Swiss_Season_Best,
    "World Record" = Seasons_World_Best
  )

# max und min Werte für normalisierte Daten definieren (Voraussetzung für radar plot)
max_min_men <- data.frame(reference_type = c("min", "max"),'100m_men' = c(0, 1), '200m_men' = c(0, 1), '400m_men' = c(0, 1), 'longjump_men' = c(0, 1)) %>% 
  rename("100m_men" = X100m_men,
         "200m_men" = X200m_men,
         "400m_men" = X400m_men,
         )

# Daten der verschiedenen Disziplinen zusammenführen
mean_reference_men <- bind_rows(mean_referencetimes_100m_men, mean_referencetimes_200m_men, mean_referencetimes_400m_men, mean_reference_longjump_men) %>% 
  pivot_longer(cols = c(2:5), names_to = "reference_type", values_to = "results") %>%
  filter(!results == 1) %>% 
  pivot_wider(names_from = discipline, values_from = results) %>% 
  bind_rows(max_min_men) %>% 
  mutate(reference_type = factor(reference_type, levels = c("max", "min", "Gold Medal WCh and OG", "Certificate WCh and OG", "Swiss Season Best"))) %>% 
  arrange(reference_type)
```

```{r data preperation 100m women, include=FALSE}
# data cleaning and selection 
athletics_selection_100m_women <- athletics_master %>% 
  mutate(Rank = as.numeric(Rank), Result = as.numeric(Result)) %>% 
  filter(Year %in% c(2000:2023), !is.na(Rank), !is.na(Result), !Competition == "Diamond League", Discipline == "100m", Gender == "Women") %>% 
  select(Year, Competition, Discipline, Gender, Class, Person.Team, Person, Rank, Age, Nationality, Result)

# results of finalists in Wch and OG who came in last
rank8_wch_og_100m_women <- athletics_selection_100m_women %>% 
  # filter results so that outliers are not being taken into consideration
  filter(Rank %in% c(1:8), Result < 11.5, Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_max(Rank) %>% 
  ungroup()%>% 
  mutate(reference_type = "Certificate_WCh_and_OG")
  
# results of finalists in Wch and OG who came in first
rank1_wch_og_100m_women <- athletics_selection_100m_women %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_min(Rank) %>% 
  ungroup() %>% 
  group_by(Year, Rank) %>% 
  slice_min(Result) %>% 
  ungroup() %>% 
  mutate(reference_type = "Rank1_WCh_and_OG")

# best result of each season from swiss athletes
swissathletes_100m_women <- athletics_selection_100m_women %>% 
  filter(Nationality == "SUI") %>%
  group_by(Year) %>% 
  slice_min(Result) %>%
  ungroup() %>% 
  mutate(reference_type = "Swiss_Season_Best") 

# combining dataframes to one whole
referencetimes_100m_women <- bind_rows(rank8_wch_og_100m_women, rank1_wch_og_100m_women, swissathletes_100m_women) 

# individual results of chosen swiss athletes
 get_swissindividual_100m_women <- function(athlete = "Muijnga Kambundji"){
   athletics_selection_100m_women %>%
   filter(Nationality == "SUI", Person == athlete) %>%
   group_by(Year) %>%
   slice_min(Result) %>%
   mutate(reference_type = athlete)
 }

# create ggplot
 g_reference_100m_women <- ggplot(data = referencetimes_100m_women, mapping = aes(Year, Result))+
   geom_line(mapping = aes(colour = reference_type))+
   #geom_point(data = get_swissindividual_100m_women(athlete = "Mujinga Kambundji"), mapping = aes(Year, Result, colour = reference_type), inherit.aes = FALSE) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )
 
```



```{r Difference Switzerland to Worlds Best 100m women, echo=FALSE}
# diff_referencetimes_100m_women <- referencetimes_100m_women %>% 
#   distinct(Year, reference_type, Result) %>% 
#   group_by(Year) %>% 
#   pivot_wider(names_from = reference_type, values_from = Result) %>% 
#   ungroup() %>% 
#   arrange(Year) %>% 
#   mutate(difftoworldbest = Swiss_Season_Best - Seasons_World_Best,
#          difftorank1 = Swiss_Season_Best - Rank1_WCh_and_OG,
#          difftorank8 = Swiss_Season_Best - Certificate_WCh_and_OG) %>% 
#   select(Year, difftoworldbest, difftorank1, difftorank8) %>% 
#   pivot_longer(cols = c(2:4), names_to = "reference_type", values_to = "value") %>%
#   filter(!is.na(value))

# ggplotly(ggplot(diff_referencetimes_100m_women, aes(Year, value, colour = reference_type))+
#   geom_line())

```


```{r data preperation 200m Women, include=FALSE}
# data cleaning and selection 
athletics_selection_200m_women <- athletics_master %>% 
  mutate(Rank = as.numeric(Rank), Result = as.numeric(Result)) %>% 
  filter(Year %in% c(2000:2023), !is.na(Rank), !is.na(Result), !Competition == "Diamond League", Discipline == "200m", Gender == "Women") %>% 
  select(Year, Competition, Discipline, Gender, Class, Person.Team, Person, Rank, Age, Nationality, Result)

# results of finalists in Wch and OG who came in last
rank8_wch_og_200m_women <- athletics_selection_200m_women %>% 
  # filter results so that outliers are not being taken into consideration
  filter(Rank %in% c(1:8), Result < 23.5, Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_max(Rank) %>% 
  ungroup()%>% 
  mutate(reference_type = "Certificate_WCh_and_OG")
  
# results of finalists in Wch and OG who came in first
rank1_wch_og_200m_women <- athletics_selection_200m_women %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_min(Rank) %>% 
  ungroup() %>% 
  group_by(Year, Rank) %>% 
  slice_min(Result) %>% 
  ungroup() %>% 
  mutate(reference_type = "Rank1_WCh_and_OG")

# best result of each season from swiss athletes
swissathletes_200m_women <- athletics_selection_200m_women %>% 
  filter(Nationality == "SUI", Class == "Seniors") %>%
  group_by(Year) %>% 
  slice_min(Result) %>%
  ungroup() %>% 
  mutate(reference_type = "Swiss_Season_Best")

# combining dataframes to one whole
referencetimes_200m_women <- bind_rows(rank8_wch_og_200m_women, rank1_wch_og_200m_women, swissathletes_200m_women)

# individual results of chosen swiss athletes
get_swissindividual_200m_women <- function(athlete = "Muijnga Kambundji"){
  athletics_selection_200m_women %>% 
  filter(Nationality == "SUI", Person == athlete) %>%
  group_by(Year) %>% 
  slice_min(Result) %>% 
  mutate(reference_type = athlete)
}

# create ggplot
g_reference_200m_women <- ggplot(data = referencetimes_200m_women, mapping = aes(Year, Result))+
  geom_line(mapping = aes(colour = reference_type))+
  #geom_point(data = get_swissindividual_200m_women(athlete = "Mujinga Kambundji"), mapping = aes(Year, Result, colour = reference_type), inherit.aes = FALSE) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )

```


```{r Difference Switzerland to Worlds Best 200m Women, echo=FALSE}
# diff_referencetimes_200m_women <- referencetimes_200m_women %>% 
#   distinct(Year, reference_type, Result) %>% 
#   group_by(Year) %>% 
#   pivot_wider(names_from = reference_type, values_from = Result) %>% 
#   ungroup() %>% 
#   arrange(Year) %>% 
#   mutate(difftoworldbest = Swiss_Season_Best - Seasons_World_Best,
#          difftorank1 = Swiss_Season_Best - Rank1_WCh_and_OG,
#          difftorank8 = Swiss_Season_Best - Certificate_WCh_and_OG) %>% 
#   select(Year, difftoworldbest, difftorank1, difftorank8) %>% 
#   pivot_longer(cols = c(2:4), names_to = "reference_type", values_to = "value") %>%
#   filter(!is.na(value))
# 
# ggplotly(ggplot(diff_referencetimes_200m_women, aes(Year, value, colour = reference_type))+
#   geom_line())

```




```{r data preperation 400m Women, include=FALSE}
# data cleaning and selection 
athletics_selection_400m_women <- athletics_master %>% 
  mutate(Rank = as.numeric(Rank), Result = as.numeric(Result)) %>% 
  filter(Year %in% c(2000:2023), !is.na(Rank), !is.na(Result), !Competition == "Diamond League", Discipline == "400m", Gender == "Women") %>% 
  select(Year, Competition, Discipline, Gender, Class, Person.Team, Person, Rank, Age, Nationality, Result)

# results of finalists in Wch and OG who came in last
rank8_wch_og_400m_women <- athletics_selection_400m_women %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_max(Rank) %>% 
  ungroup()%>% 
  mutate(reference_type = "Certificate_WCh_and_OG")
  
# results of finalists in Wch and OG who came in first
rank1_wch_og_400m_women <- athletics_selection_400m_women %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_min(Rank) %>% 
  ungroup() %>% 
  group_by(Year, Rank) %>% 
  slice_min(Result) %>% 
  ungroup() %>% 
  mutate(reference_type = "Rank1_WCh_and_OG")

# best result of each season from swiss athletes
swissathletes_400m_women <- athletics_selection_400m_women %>% 
  filter(Nationality == "SUI") %>%
  group_by(Year) %>% 
  slice_min(Result) %>%
  ungroup() %>% 
  mutate(reference_type = "Swiss_Season_Best")

# combining dataframes to one whole
referencetimes_400m_women <- bind_rows(rank8_wch_og_400m_women, rank1_wch_og_400m_women, swissathletes_400m_women)

# individual results of chosen swiss athletes
get_swissindividual_400m_women <- function(athlete = "Muijnga Kambundji"){
  athletics_selection_400m_women %>% 
  filter(Nationality == "SUI", Person == athlete) %>%
  group_by(Year) %>% 
  slice_min(Result) %>% 
  mutate(reference_type = athlete)
}

# create ggplot
g_reference_400m_women <- ggplot(data = referencetimes_400m_women, mapping = aes(Year, Result))+
  geom_line(mapping = aes(colour = reference_type))+
  #geom_point(data = get_swissindividual_400m_women(athlete = "Silke Lemmens"), mapping = aes(Year, Result, colour = reference_type), inherit.aes = FALSE) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )

```


```{r Difference Switzerland to Worlds Best 400m Women, echo=FALSE}
# diff_referencetimes_400m_women <- referencetimes_400m_women %>% 
#   distinct(Year, reference_type, Result) %>% 
#   group_by(Year) %>% 
#   pivot_wider(names_from = reference_type, values_from = Result) %>% 
#   ungroup() %>% 
#   arrange(Year) %>% 
#   mutate(difftoworldbest = Swiss_Season_Best - Seasons_World_Best,
#          difftorank1 = Swiss_Season_Best - Rank1_WCh_and_OG,
#          difftorank8 = Swiss_Season_Best - Certificate_WCh_and_OG) %>% 
#   select(Year, difftoworldbest, difftorank1, difftorank8) %>% 
#   pivot_longer(cols = c(2:4), names_to = "reference_type", values_to = "value") %>%
#   filter(!is.na(value))
# 
# ggplotly(ggplot(diff_referencetimes_400m_women, aes(Year, value, colour = reference_type))+
#   geom_line())

```



```{r data preperation Long Jump Women, include=FALSE}
# data cleaning and selection 
athletics_selection_longjump_women <- athletics_master %>% 
  mutate(Rank = as.numeric(Rank), Result = as.numeric(Result)) %>% 
  filter(Year %in% c(2000:2023), !is.na(Rank), !is.na(Result), !Competition %in% c("Diamond League", "World Indoor Tour"), Discipline == "Long Jump", Gender == "Women") %>% 
  select(Year, Competition, Discipline, Gender, Class, Person.Team, Person, Rank, Age, Nationality, Result)

# results of finalists in Wch and OG who came in last
rank8_wch_og_longjump_women <- athletics_selection_longjump_women %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_max(Rank) %>% 
  ungroup()%>% 
  mutate(reference_type = "Certificate_WCh_and_OG")
  
# results of finalists in Wch and OG who came in first
rank1_wch_og_longjump_women <- athletics_selection_longjump_women %>% 
  filter(Rank %in% c(1:8), Class == "Seniors", Competition %in% c("World Championships", "Olympic Games")) %>%
  group_by(Year) %>% 
  slice_min(Rank) %>% 
  ungroup() %>% 
  group_by(Year, Rank) %>% 
  slice_max(Result) %>% 
  ungroup() %>% 
  mutate(reference_type = "Rank1_WCh_and_OG")

# best result of each season from swiss athletes
swissathletes_longjump_women <- athletics_selection_longjump_women %>% 
  filter(Nationality == "SUI") %>%
  group_by(Year) %>% 
  slice_max(Result) %>%
  ungroup() %>% 
  mutate(reference_type = "Swiss_Season_Best")

# combining dataframes to one whole
reference_longjump_women <- bind_rows(rank8_wch_og_longjump_women, rank1_wch_og_longjump_women, swissathletes_longjump_women)

# individual results of chosen swiss athletes
get_swissindividual_longjump_women <- function(athlete = "Muijnga Kambundji"){
  athletics_selection_longjump_women %>% 
  filter(Nationality == "SUI", Person == athlete) %>%
  group_by(Year) %>% 
  slice_max(Result) %>% 
  mutate(reference_type = athlete)
}

# create ggplot
g_reference_longjump_women <- ggplot(data = reference_longjump_women, mapping = aes(Year, Result))+
  geom_line(mapping = aes(colour = reference_type))+
  #geom_point(data = get_swissindividual_longjump_women(athlete = "Annik Kälin"), mapping = aes(Year, Result, colour = reference_type), inherit.aes = FALSE) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )

```


```{r Difference Switzerland to Worlds Best Long Jump Women, echo=FALSE}
# diff_reference_longjump_women <- reference_longjump_women %>% 
#   distinct(Year, reference_type, Result) %>% 
#   group_by(Year) %>% 
#   pivot_wider(names_from = reference_type, values_from = Result) %>% 
#   ungroup() %>% 
#   arrange(Year) %>% 
#   mutate(difftoworldbest = Seasons_World_Best - Swiss_Season_Best,
#          difftorank1 = Rank1_WCh_and_OG - Swiss_Season_Best,
#          difftorank8 = Certificate_WCh_and_OG - Swiss_Season_Best) %>% 
#   select(Year, difftoworldbest, difftorank1, difftorank8) %>% 
#   pivot_longer(cols = c(2:4), names_to = "reference_type", values_to = "value") %>%
#   filter(!is.na(value))
# 
# ggplotly(ggplot(diff_reference_longjump_women, aes(Year, value, colour = reference_type))+
#   geom_line())

```


```{r dataframes for spider plot women, echo=FALSE, error=FALSE}
# World Records
seasonsworldbest_100m_women <- athletics_selection_100m_women %>% 
  filter(Class == "Seniors") %>%
  slice_min(Result, with_ties = F) %>% 
  ungroup() %>% 
  mutate(reference_type = "Seasons_World_Best")

seasonsworldbest_200m_women <- athletics_selection_200m_women %>% 
  filter(Class == "Seniors") %>%
  slice_min(Result, with_ties = F) %>%
  mutate(reference_type = "Seasons_World_Best")

seasonsworldbest_400m_women <- athletics_selection_400m_women %>% 
  filter(Class == "Seniors") %>%
  slice_min(Result, with_ties = F) %>% 
  mutate(reference_type = "Seasons_World_Best")

seasonsworldbest_longjump_women <- athletics_selection_longjump_women %>% 
  filter(Class == "Seniors") %>%
  slice_max(Result, with_ties = F) %>% 
  mutate(reference_type = "Seasons_World_Best")

# Mittelwert über die letzten 6 Jahre bilden (2016 - 2022)
mean_referencetimes_100m_women <- referencetimes_100m_women %>% 
  filter(Year %in% 2016:2022) %>% 
  group_by(reference_type) %>% 
  summarize(mean = mean(Result)) %>% 
  ungroup() %>%
# Weltrekord hinzufügen 
  bind_rows(seasonsworldbest_100m_women %>% summarize(mean = min(Result), reference_type = "Seasons_World_Best")) %>% 
  mutate(discipline = "100m_women") %>% 
  pivot_wider(names_from = reference_type, values_from = mean) %>% 
# Vergleichen mit Weltrekord (normalisieren)  
  mutate(Certificate_WCh_and_OG = (12.43-Certificate_WCh_and_OG)/(12.43-Seasons_World_Best),
         Rank1_WCh_and_OG = (12.43-Rank1_WCh_and_OG)/ (12.43-Seasons_World_Best),
         Swiss_Season_Best = (12.43-Swiss_Season_Best)/(12.42-Seasons_World_Best),
         Seasons_World_Best = 1) %>% 
  rename(
    "Certificate WCh and OG" = Certificate_WCh_and_OG,
    "Gold Medal WCh and OG" = Rank1_WCh_and_OG,
    "Swiss Season Best" = Swiss_Season_Best,
    "World Record" = Seasons_World_Best
  )

# Mittelwert über die letzten 6 Jahre bilden 
mean_referencetimes_200m_women <- referencetimes_200m_women %>% 
  filter(Year %in% 2016:2022) %>% 
  group_by(reference_type) %>% 
  summarize(mean = mean(Result)) %>% 
  ungroup() %>% 
# Weltrekord hinzufügen 
  bind_rows(seasonsworldbest_200m_women %>% summarize(mean = min(Result), reference_type = "Seasons_World_Best")) %>%
  mutate(discipline = "200m_women") %>% 
  pivot_wider(names_from = reference_type, values_from = mean) %>% 
# Vergleichen mit Weltrekord (normalisieren)  
  mutate(Certificate_WCh_and_OG = (25.74-Certificate_WCh_and_OG)/(25.74-Seasons_World_Best),
         Rank1_WCh_and_OG = (25.74-Rank1_WCh_and_OG)/ (25.74-Seasons_World_Best),
         Swiss_Season_Best = (25.74-Swiss_Season_Best)/(25.74-Seasons_World_Best),
         Seasons_World_Best = 1) %>% 
  rename(
    "Certificate WCh and OG" = Certificate_WCh_and_OG,
    "Gold Medal WCh and OG" = Rank1_WCh_and_OG,
    "Swiss Season Best" = Swiss_Season_Best,
    "World Record" = Seasons_World_Best
  )

# Mittelwert über die letzten 6 Jahre bilden 
mean_referencetimes_400m_women <- referencetimes_400m_women %>% 
  filter(Year %in% 2016:2022) %>% 
  group_by(reference_type) %>% 
  summarize(mean = mean(Result)) %>% 
  ungroup() %>% 
# Weltrekord hinzufügen 
  bind_rows(seasonsworldbest_400m_women %>% summarize(mean = min(Result), reference_type = "Seasons_World_Best")) %>%
  mutate(discipline = "400m_women") %>% 
  pivot_wider(names_from = reference_type, values_from = mean) %>% 
# Vergleichen mit Weltrekord (normalisieren)  
  mutate(Certificate_WCh_and_OG = (58.57-Certificate_WCh_and_OG)/(58.57-Seasons_World_Best),
         Rank1_WCh_and_OG = (58.57-Rank1_WCh_and_OG)/ (58.57-Seasons_World_Best),
         Swiss_Season_Best = (58.57-Swiss_Season_Best)/(58.57-Seasons_World_Best),
         Seasons_World_Best = 1) %>% 
  rename(
    "Certificate WCh and OG" = Certificate_WCh_and_OG,
    "Gold Medal WCh and OG" = Rank1_WCh_and_OG,
    "Swiss Season Best" = Swiss_Season_Best,
    "World Record" = Seasons_World_Best
  )

# Mittelwert über die letzten 6 Jahre bilden 
mean_reference_longjump_women <- reference_longjump_women %>% 
  filter(Year %in% 2016:2022) %>% 
  group_by(reference_type) %>% 
  summarize(mean = mean(Result)) %>% 
  ungroup() %>% 
# Weltrekord hinzufügen  
  bind_rows(seasonsworldbest_longjump_women %>% summarize(mean = max(Result), reference_type = "Seasons_World_Best")) %>%
  mutate(discipline = "longjump_women") %>% 
  pivot_wider(names_from = reference_type, values_from = mean) %>% 
# Vergleichen mit Weltrekord (normalisieren)  
  mutate(Certificate_WCh_and_OG = (5.72-Certificate_WCh_and_OG)/ (5.72-Seasons_World_Best),
         Rank1_WCh_and_OG = (5.72-Rank1_WCh_and_OG)/(5.72-Seasons_World_Best),
         Swiss_Season_Best = (5.72-Swiss_Season_Best)/ (5.72-Seasons_World_Best),
         Seasons_World_Best = 1) %>% 
  rename(
    "Certificate WCh and OG" = Certificate_WCh_and_OG,
    "Gold Medal WCh and OG" = Rank1_WCh_and_OG,
    "Swiss Season Best" = Swiss_Season_Best,
    "World Record" = Seasons_World_Best
  )

# max und min Werte für normalisierte Daten definieren (Voraussetzung für radar plot)
max_min_women <- data.frame(reference_type = c("min", "max"),'100m_women' = c(0, 1), '200m_women' = c(0, 1), '400m_women' = c(0, 1), 'longjump_women' = c(0, 1)) %>% 
  rename("100m_women" = X100m_women,
         "200m_women" = X200m_women,
         "400m_women" = X400m_women,
         )

# Daten der verschiedenen Disziplinen zusammenführen
mean_reference_women <- bind_rows(mean_referencetimes_100m_women, mean_referencetimes_200m_women, mean_referencetimes_400m_women, mean_reference_longjump_women) %>% 
  pivot_longer(cols = c(2:5), names_to = "reference_type", values_to = "results") %>%
  filter(!results == 1) %>% 
  pivot_wider(names_from = discipline, values_from = results) %>% 
  bind_rows(max_min_women) %>% 
  mutate(reference_type = factor(reference_type, levels = c("max", "min", "Gold Medal WCh and OG", "Certificate WCh and OG", "Swiss Season Best"))) %>% 
  arrange(reference_type)


```

## 2.2 Overview Women

Aim:

The following plot concentrated on the last six years (2016 - 2022) and is supposed to show the general trend of Swiss results compared to the world best results in the disciplines 100m, 200m, 400m and Long Jump. 

Method:

For creating the plot, the mean values of the following variables have been used:

- Result of the Gold Medal Winner at World Championships or Olympic Games during the last six year

- Result of the finalist who came in last place in the final of World Championships or Olympic Games during the last six years

- Result of Swiss athletes' season best during the last six years

To normalize the results for each discipline, the mean values have been compared to the current World Record (100%). As a baseline (0%) the "red curve"-value  for 16 year old athletes (see Swiss Athletics, 2022: https://www.swiss-athletics.ch/wp-content/uploads/Leistungskurve-Red-Curve-2022-1.pdf) was used. That's the reason why the radarchart's axis is labeled from 0% - 100%.

Result:

Green Line = Swiss Season Best    
Red Line = Result needed for Top 8    
Black Line = Result of World Champion or Olympic Champion   
100% = Current World Record

If we compare Swiss results (green line) of female athletes in the disciplines 100m, 200m, 400m and Long Jump to the results of the best athletes in the world, we can see that in the disciplines 100m and 200m, Switzerland is in the middle of the world top 8 athletes (red line) the last six years. On the other hand Switzerland seems to be far away from the world top 8 athletes in the disciplines 400m and Long Jump. To see the development over the last 6 years and beyond, it is suggested to take a closer look at each discipline.

```{r plot 1 Radar Chart Women, echo=FALSE}
# Radar Chart erstellen
linetype <-  c("dotted", "dashed", "solid")
labels <- c("100m Women", "200m Women", "400m Women", "Long Jump Women")
color <- c("black", "red", "green")

radarchart(mean_reference_women[2:5],
           title = "Results 2016 - 2022 Compared to World Record (100%)",
           axistype = 1,
           vlabels = labels,
           vlcex = 1.1,
           pcol = color,
           plwd = 3,
           plty = linetype,
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6)
legend("topright",
       legend = c("Mean Gold Medal Results", "Mean Result of Last Finalist", "Swiss Season Best"),
       bty = "n", pch = 20, lty = linetype, fill = color, col = color,
       text.col = "grey25", pt.cex = 2)
```

### 2.2.1 100m Women

If we're taking a closer look at the 100m women, we can see that in the past 20 years it was necessary to run under 11 seconds to have a chance for a gold medal. Only in 2000 and 2007 a gold medal was achieved with a time over 11 seconds. Nevertheless, a certificate at World Championships or Olympic Games was possible with a time over, but close to, 11 seconds. In 2016 it was the first time the finalists even ran all under 11 seconds. 

If we look closer at the best times of Swiss athletes in each season, we see a strong development. Until and with 2017 even if Swiss athletes ran their best time in a major event, they ran more slowly the 100m than all finalists. In 2018, it was the first time that the Swiss Season Best was better than the time ran by the last finalist. It was not only in 2018, but all the years afterwards, that the Swiss Season Best was as good as to be in the top 8 of the world. In 2021, even the "magic barrier" of 11s was broken through by Swiss athletes, confirming the positive trend in this discipline.

```{r plot 1 100m Women, echo=FALSE}
ggplotly(g_reference_100m_women)
```

### 2.2.2 200m Women

For the times of 200m Women, we can see a big development over the past 22 years. While in 2000 a time over 22.5s was enough to win a gold medal at Olympic Games,  in 2022 the World Champion ran more than 1s faster (21.45s). So, it became normal that athletes have to run close to or under 22s to win a gold medal at major events. 

All finalists at major events usually run around 23s seconds or better. The final of the Olympic Games Tokyo 2020 (reported to 2021) was the "fastest final of all times", with all finalists running under 22.5s (22.3s and better)). 

Swiss athletes didn't have international results between 2000 and 2012. Nevertheless, from 2012 the discipline 200m Women developed strongly in Switzerland. Since 2017 the Swiss Season Best was regularly good enough to run into the top 8 of a major event. 

```{r plot 1 200m Women, echo=FALSE}
ggplotly(g_reference_200m_women)
```

### 2.2.3 400m Women

The discipline 400m Women didn't have a strong development compared to 100m and 200m women. In 2000 and 2022 a gold medal at Olympic Games/ World Championships was won with the same time (49.11s). It can be said, that a time around 49s is needed to be able to win a gold medal at major events and a time under 51s is normal for all finalists at Olympic Games or World Championships

In Switzerland, the first international result was registered in 2012. Until today Switzerland doesn't catch up to the world best in 400m Women. Anyways, a positive development can be seen. At least a 1s improvement in Swiss Season Best time hast to be made to be able to compete with the world best.

```{r plot 1 400m Women, echo=FALSE}
ggplotly(g_reference_400m_women)
```

### 2.2.4 Long Jump Women

In Women Long Jump athletes had to jump at least 6.82m in the last 22 years to be able to win a gold medal at World Championships or Olympic Games. The results of the finalist who ended up last place in their final lie around 6.50m and vary between 6.35m and 6.82m. Only from 2009 - 2012, 2014 and 2022 Swiss athletes' season best is higher than 6.50m. From 2016 to 2022 a strong development of the Swiss Season Best time in 200m Women can be seen.


```{r plot 1 Long Jump Women, echo=FALSE}
ggplotly(g_reference_longjump_women)
```

\newpage
## 2.3 Overview Men

Aim:

The following plot concentrated on the last six years (2016 - 2022) and is supposed to show the general trend of Swiss results compared to the world best results in the disciplines 100m, 200m, 400m and Long Jump. 

Method:

For creating the plot, the mean values of the following variables have been used:

- Result of the Gold Medal Winner at World Championships or Olympic Games during the last six years

- Result of the finalist who came in last place in the final of World Championships or Olympic Games during the last six years

- Result of Swiss athletes' season best during the last six years

To normalize the results for each discipline, the mean values have been compared to the current World Record (100%). As a baseline (0%) the "red curve"-value  for 16 year old athletes (see Swiss Athletics, 2022: https://www.swiss-athletics.ch/wp-content/uploads/Leistungskurve-Red-Curve-2022-1.pdf) was used. That's the reason why the radarchart's axis is labeled from 0% - 100%.

Result:

Green Line = Swiss Season Best    
Red Line = Result needed for Top 8    
Black Line = Result of World Champion or Olympic Champion   
100% = Current World Record

If we compare Swiss results (green line) of male athletes in the disciplines 100m, 200m, 400m and Long Jump to the results of the best athletes in the world, we can see that Switzerland is in general behind the world top 8 athletes (red line) the last six years. Swiss athletes have gotten the closest to a top 8 result in the 200m, and are the most far in the disciplines 400m and Long Jump. To see the development over the last 6 years and beyond, it is suggested to take a closer look at each discipline.


```{r plot 1 Radar Chart Men, echo=FALSE}
# Radar Chart erstellen
linetype <-  c("dotted", "dashed", "solid")
labels <- c("100m Men", "200m Men", "400m Men", "Long Jump Men")
color <- c("black", "red", "green")

overview_men <- radarchart(mean_reference_men[2:5],
           title = "Results 2016 - 2022 Compared to World Record (100%)",
           axistype = 1,
           vlabels = labels,
           vlcex = 1.1,
           pcol = color,
           plwd = 3,
           plty = linetype,
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6) 

legend("topright",
       legend = c("Mean Gold Medal Results", "Mean Result of Last Finalist", "Swiss Season Best"),
       bty = "n", pch = 20, lty = linetype, fill = color, col = color,
       text.col = "grey25", pt.cex = 2)

```

### 2.3.1 100m Men

If we're taking a closer look at the 100m men, we can see that in the past 2022 years it was necessary to run under 10 seconds to have a chance for a gold medal. Only in 2003 a gold medal was achieved with a time over 10 seconds. Nevertheless, a certificate at World Championships or Olympic Games was possible with a time over, but close to, 10 seconds. In 2021 it was the first time the finalists even ran all under 10 seconds. If we look closer at the best times of Swiss athletes in each season, it seems to be clear that even if Swiss athletes run their best time in a major event, they run more slowly the 100m than all finalists, with an exception in 2017.

```{r plot 1 100m Men, echo=FALSE}
ggplotly(g_reference_100m_men)
```

### 2.3.2 200m Men

For the 200m Men it seems, that over the last 20 years a time under 20 seconds was established to reach a gold medal at World Championships or Olympic Games. The last time a time over 20 seconds was enough for a gold medal was in 2017. In certain years (2007 - 2012 and 2022) there was a big gap of 1 second or more between the time of the gold medalists and the last finalist. This is mostly due to the results of the exceptional athlete Usain Bolt. All finalists usually run around 20.5 seconds or better. Swiss ahtletes come closer to the times of finalists in 200m men than in 100m men. In 2018 and 2019 Alex Wilson even ran a season best, which is better than the time of finalists in World Championships and Olympic Games.

```{r plot 1 200m Men, echo=FALSE}
ggplotly(g_reference_200m_men)
```

### 2.3.3 400m Men

In 400m Men, athletes have to run a time around 44 seconds to be able to achieve a gold medal at World Championships or Olympic Games. Finalists times were between 44.6 and 46.1 seconds form 2000 - 2023. Swiss athletes haven't run times for finalist ranks in the past. But, in 2021 and 2022 the best time of the season for Swiss athletes was as good as or better than times of finalists at World Championships or Olympic Games.

```{r plot 1 400m Men, echo=FALSE}
ggplotly(g_reference_400m_men)
```

### 2.4.4 Long Jump Men

In Men Long Jump athletes had to jump at least 8.31m in the last 20 years to be able to win a gold medal at World Championships or Olympic Games. The results of the finalist who ended up last place in their final lie around 8m and vary between 7.85m and 8.21m. Only in the last two years (2021, 2022) Swiss athletes' season best is higher than 8m and thus had a chance to be under the top 8 athletes in the world. 

```{r plot 1 Long Jump Men, echo=FALSE, error=FALSE}
ggplotly(g_reference_longjump_men)
```

## 2.4 Conclusion

At the moment, Switzerland can compete with the world best athletes in the disciplines 100m Women, 200m Women, 400m Men and Long Jump Men and is showing in general a positive trend of development in the above analysed "sprint disciplines". With top results in all four disciplines (if we look at men and women together), it seems that there is the Know-How in Switzerland to succeed in all four "sprint disciplines". 

Nevertheless, there is still a gap to the gold medalists at Olympic Games and World Championships and the world record. The question for the future is: how can Swiss athletes close the gap to win a gold medal at major events?

Additionally, if we take a closer look at Switzerland's best results in the application, we can see that the results are depending on individual top performers. To guarantee the success and the positive development in the future, more athletes with world class performances are needed.

## 3. Distance from records: analysis of swiss athletes

In this section we will analyse data from Swiss athletes in order to better understand how far they are from international records.

First of all we will divide our report considering sport, gender and the three classes, Senior, Junior and Youth. This operation makes it possible to compare athletes that have the same age and that are running, or jumping, in the same competition. 

Our purpose is helping the Swiss Federation in strategic decisions. In fact, we want to provide them with graphs that can show the main trends. Moreover, we aim to analyse the achievements and results throughout the years to figure out where to invest in order to be more and more competitive.

We, therefore, start with the men's 100m competition. 

## 3.1 Men's 100 m

First of all we want to show a general plot to understand if there are some interesting patterns. 
We decided to use a simple scatterplot in which every class has its own colour. We opted for showing the linear regression line. This operation does not mean we are trying to forecast anything, we just believe that in this way the reader can have a clearer idea of the global trend. 

```{r 100mMplotEDA, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
library(ggplot2)
library(plotly)
library(fmsb)
# creating a dataset of Swiss athlete in 100m men.
suimale100m <- olympics[which(olympics$Discipline == "100m"), ]
suimale100m <- suimale100m[which(suimale100m$Gender == "Men"), ]
suimale100m <- suimale100m[which(suimale100m$Class != "Under 23"), ]
suimale100m <- suimale100m[which(suimale100m$Nationality == "SUI"), ]
suimale100m <- suimale100m[which(suimale100m$Result != ""), ]
suimale100m <- suimale100m[which(suimale100m$Result <= 12), ] # there were a result of 23, we decided not to consider it in our model
suimale100m[, "Result"] <- as.double(suimale100m$Result)
# summary(suimale100m$Result)

# fit <- lm(data = suimale100m[which(suimale100m$Class == "Seniors"), ], 
#           formula = Result ~ Year)
# summary(fit)

p <- ggplot(data = suimale100m,
       aes(x = Year, y = Result, color = Class)) +
  geom_point() +
  geom_smooth(method = "lm")

ggplotly(p)
```

In particular, we want the reader to focus on the amount of dots from the Senior class (since the other two classes present just a few records and we hope in the future more data will be collected). It is interesting how a huge percentage of these records occurred after the year 2000. From our point of view, this element is very important and it highlights how positive was the Federation's work in the last period. 

We want now to answer the question “how far are we from records?”. In order to do it, we need to analyse some athletes in detail. 

We decided to show the analysis of two important runners, Alex Wilson and Pascal Mancini. 

```{r script100mM, echo=FALSE, include = FALSE}
sprint100mMale <- olympics[which(olympics$Discipline == "100m"), ]
sprint100mMale <- sprint100mMale[which(sprint100mMale$Year>=1990), ]
sprint100mMale <- sprint100mMale[which(sprint100mMale$Competition == "Olympic Games" 
                 | sprint100mMale$Competition == "World Championships"), ]
sprint100mMale <- sprint100mMale[which(sprint100mMale$Gender == "Men"), ]
sprint100mMale <- sprint100mMale[which(sprint100mMale$Class == "Seniors"), ]
sprint100mMale <- sprint100mMale[which(sprint100mMale$Result != ""), ]
# sprint100mMale <- sprint100mMale[which(sprint100mMale$Medal != ""), ]
sprint100mMale[, "Result"] <- as.double(sprint100mMale$Result)
summary(sprint100mMale$Result)

sprint100mMaleJunior <- olympics[which(olympics$Discipline == "100m"), ]
sprint100mMaleJunior <- sprint100mMaleJunior[which(sprint100mMaleJunior$Year>=1990), ]
sprint100mMaleJunior <- sprint100mMaleJunior[which(sprint100mMaleJunior$Competition == "World Junior Championships"), ]
sprint100mMaleJunior <- sprint100mMaleJunior[which(sprint100mMaleJunior$Gender == "Men"), ]
sprint100mMaleJunior <- sprint100mMaleJunior[which(sprint100mMaleJunior$Class == "Juniors"), ]
sprint100mMaleJunior <- sprint100mMaleJunior[which(sprint100mMaleJunior$Result != ""), ]
# sprint100mMaleJunior <- sprint100mMaleJunior[which(sprint100mMaleJunior$Medal != ""), ]
sprint100mMaleJunior[, "Result"] <- as.double(sprint100mMaleJunior$Result)
summary(sprint100mMaleJunior$Result)

sprint100mMaleYouth <- olympics[which(olympics$Discipline == "100m"), ]
sprint100mMaleYouth <- sprint100mMaleYouth[which(sprint100mMaleYouth$Year>=1990), ]
sprint100mMaleYouth <- sprint100mMaleYouth[which(sprint100mMaleYouth$Competition == "World Youth Championships"
                                         | sprint100mMaleYouth$Competition == "Youth Olympic Games"), ]
sprint100mMaleYouth <- sprint100mMaleYouth[which(sprint100mMaleYouth$Gender == "Men"), ]
sprint100mMaleYouth <- sprint100mMaleYouth[which(sprint100mMaleYouth$Class == "Youth"), ]
sprint100mMaleYouth <- sprint100mMaleYouth[which(sprint100mMaleYouth$Result != ""), ]
# sprint100mMaleYouth <- sprint100mMaleYouth[which(sprint100mMaleYouth$Medal != ""), ]
sprint100mMaleYouth[, "Result"] <- as.double(sprint100mMaleYouth$Result)
summary(sprint100mMaleYouth$Result)


i <- 2
j <- 2
k <- 2
vector_senior_year <- c(min(sprint100mMale[which(sprint100mMale$Year == 2000), "Result"]))
vector_junior_year <- c(min(sprint100mMaleJunior[which(sprint100mMaleJunior$Year == 2000), "Result"]))
vector_youth_year <- c(min(sprint100mMaleYouth[which(sprint100mMaleYouth$Year == 2001), "Result"]))
for (year in 2001:2022){
  vector_senior_year[i] <- min(c(min(sprint100mMale[which(sprint100mMale$Year == year), "Result"]), vector_senior_year[i-1]))
  i <- i + 1
  vector_junior_year[j] <- min(c(min(sprint100mMaleJunior[which(sprint100mMaleJunior$Year == year), "Result"]), vector_junior_year[j-1]))
  j <- j + 1
  vector_youth_year[k] <- min(c(min(sprint100mMaleYouth[which(sprint100mMaleYouth$Year == year), "Result"]), vector_youth_year[k-1]))
  k <- k + 1
}

i <- 2
j <- 2
k <- 2
vector_senior_year_8 <- c(sprint100mMale[which(sprint100mMale$Year == 1999 & sprint100mMale$Rank == "8"), "Result"])
vector_junior_year_8 <- c(sprint100mMaleJunior[which(sprint100mMaleJunior$Year == 2000 & sprint100mMaleJunior$Rank == "8"), "Result"])
vector_youth_year_8 <- c(sprint100mMaleYouth[which(sprint100mMaleYouth$Year == 2001 & sprint100mMaleYouth$Rank == "8"), "Result"])
for (year in 2001:2022){
  vector_senior_year_8[i] <- min(c(sprint100mMale[which(sprint100mMale$Year == year & sprint100mMale$Rank == "8"), "Result"], vector_senior_year_8[i-1]))
  i <- i + 1
  vector_junior_year_8[j] <- min(c(sprint100mMaleJunior[which(sprint100mMaleJunior$Year == year & sprint100mMaleJunior$Rank == "8"), "Result"], vector_junior_year_8[j-1]))
  j <- j + 1
  vector_youth_year_8[k] <- min(c(sprint100mMaleYouth[which(sprint100mMaleYouth$Year == year & sprint100mMaleYouth$Rank == "8"), "Result"], vector_youth_year_8[k-1]))
  k <- k + 1
}



vector_senior_year_8
vector_junior_year_8
vector_youth_year_8
vector_best_year <- c(vector_senior_year, vector_junior_year, vector_youth_year)
vector_8_year <- c(vector_senior_year_8, vector_junior_year_8, vector_youth_year_8)
v1 <- 2000:2022
years <- c(v1,v1,v1)
years
vector_class <- c()
vector_class[1:23] <- "Seniors"
vector_class[24:46] <- "Juniors"
vector_class[47:69] <- "Youth"
vector_class

df_result <- data.frame(Year = years,
                        Top_8 = vector_8_year,
                        Top_1 = vector_best_year,
                        Class = vector_class)
df_result

switzerland_athlete_Men_100m <- olympics[which(olympics$Discipline == "100m"), ]
switzerland_athlete_Men_100m <- switzerland_athlete_Men_100m[which(switzerland_athlete_Men_100m$Year>=2000), ]
switzerland_athlete_Men_100m <- switzerland_athlete_Men_100m[which(switzerland_athlete_Men_100m$Gender == "Men"), ]
switzerland_athlete_Men_100m <- switzerland_athlete_Men_100m[which(switzerland_athlete_Men_100m$Nationality == "SUI"), ]
switzerland_athlete_Men_100m <- switzerland_athlete_Men_100m[which(switzerland_athlete_Men_100m$Result != ""), ]
# sprint100mMale <- sprint100mMale[which(sprint100mMale$Medal != ""), ]
switzerland_athlete_Men_100m[, "Result"] <- as.double(switzerland_athlete_Men_100m$Result)
summary(switzerland_athlete_Men_100m$Result)
table(switzerland_athlete_Men_100m$Person)


switzerland_athlete_Men_100m <- data.frame(Name = switzerland_athlete_Men_100m$Person,
                                           Result = switzerland_athlete_Men_100m$Result,
                                           Year = switzerland_athlete_Men_100m$Year,
                                           Class = switzerland_athlete_Men_100m$Class)

switzerland_athlete_Men_100m <- merge(x = switzerland_athlete_Men_100m,
                                      y = df_result, 
                                      by = c("Year", "Class")
                                )
switzerland_athlete_Men_100m


# Da fare in shiny con un input sul nome dell'atleta.

athlete_list_M <- as.list(unique(switzerland_athlete_Men_100m$Name))
athlete_result <- c()
athlete_name <- c()
athlete_year <- c()
athlete_class <- c()
top8 <- c()
top1 <- c()
i = 1
for (name in athlete_list_M){
  print(name)
  for (year in min(switzerland_athlete_Men_100m$Year):max(switzerland_athlete_Men_100m$Year)){
    print(year)
    if(length(switzerland_athlete_Men_100m[which(switzerland_athlete_Men_100m$Name == name 
                                                 & switzerland_athlete_Men_100m$Year == year), "Result"] != 0)){
      athlete_name[i] <- name
      
      athlete_result[i] <- min(switzerland_athlete_Men_100m[which(switzerland_athlete_Men_100m$Name == name
                                                           & switzerland_athlete_Men_100m$Year == year),"Result"])
      athlete_year[i] <- year
      athlete_class[i] <- switzerland_athlete_Men_100m[which(switzerland_athlete_Men_100m$Result == athlete_result[i] &
                                                               switzerland_athlete_Men_100m$Name == name & 
                                                               switzerland_athlete_Men_100m$Year == year),"Class"]
      top1[i] <- switzerland_athlete_Men_100m[which(switzerland_athlete_Men_100m$Result == athlete_result[i] &
                                                       switzerland_athlete_Men_100m$Name == name & 
                                                       switzerland_athlete_Men_100m$Year == year),"Top_1"]
      print(top1[i])
      top8[i] <- switzerland_athlete_Men_100m[which(switzerland_athlete_Men_100m$Result == athlete_result[i] &
                                                       switzerland_athlete_Men_100m$Name == name & 
                                                       switzerland_athlete_Men_100m$Year == year),"Top_8"]
      i <- i + 1
    }
  }
}
athlete100mM <- data.frame(Year = athlete_year,
                      Name = athlete_name,
                      Result = athlete_result,
                      Class = athlete_class,
                      Top_8 = top8,
                      Top_1 = top1)
athlete100mM
```

```{r plot100mM1, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
pWilson <- ggplot(data = athlete100mM[which(athlete100mM$Name == "Alex Wilson"), ],
       aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Alex Wilson") +
  xlab("Year") + 
  ylab("Time") 

pMancini <- ggplot(data = athlete100mM[which(athlete100mM$Name == "Pascal Mancini"), ],
       aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Pascal Mancini") +
  xlab("Year") + 
  ylab("Time")


library(gridExtra)

grid.arrange(pWilson, pMancini, ncol=1, nrow = 2)
```

The first graph is about the difference from the best performance of an athlete against the best results. The range of top results is represented by a blue coloured band in which the upper bound is the best time for a runner that finished the competition in the 8th palace and the lower bound is the best time of the winner .

What we can see is the general situation. These athletes are the most performing in Switzerland in the last ten years. 
We, therefore, dive more deeply into the analysis of the three runners. 
In this case we are going to do that using two other types of graph. Firstly, we created a radar chart, to track how distant was an athlete from the record in each class. 
The second graph is counting the frequency of the difference in time from the minimum result to achieve a certificate. The black blocks represent the athlete count. The intervals have a width of 0.05s. 

```{r radarchart100mM, echo=FALSE, include =FALSE, warning=FALSE, message=FALSE}
WR100mMen <- min(sprint100mMale$Result)
WR100mMenJ <- min(sprint100mMaleJunior$Result)
WR100mMenY <- min(sprint100mMaleYouth$Result)

SR100mMen <- min(athlete100mM$Result[which(athlete100mM$Class == "Seniors")])
SR100mMenJ <- min(athlete100mM$Result[which(athlete100mM$Class == "Juniors")])
SR100mMenY <- min(athlete100mM$Result[which(athlete100mM$Class == "Youth")])

i <- 1
a_name <- c()
result <- c()
class <- c()
wr <- c()
sr <- c()
for (name in athlete_list_M){
  a_name[i] <- name
  if (min(athlete100mM[which(athlete100mM$Name == name & athlete100mM$Class == "Seniors"), "Result"]) == Inf){
    result[i] <- 0
  }
  else{
    result[i] <- (11.19 - min(athlete100mM[which(athlete100mM$Name == name & athlete100mM$Class == "Seniors"), "Result"]))/(11.19 - WR100mMen)
  }
  print(result[i])
  class[i] <- "Seniors"
  wr[i] <- 1
  sr[i] <- (11.19 - SR100mMen)/(11.19-WR100mMen)
  i <- i + 1
}
i <- 1
a_nameJ <- c()
resultJ <- c()
classJ <- c()
wrJ <- c()
srJ <- c()
for (name in athlete_list_M){
  a_nameJ[i] <- name
  if (min(athlete100mM[which(athlete100mM$Name == name & athlete100mM$Class == "Juniors"), "Result"]) == Inf){
    resultJ[i] <- 0
  }
  else{
    resultJ[i] <- (11.19 - min(athlete100mM[which(athlete100mM$Name == name & athlete100mM$Class == "Juniors"), "Result"]))/(11.19 - WR100mMenJ)
  }
  print(result[i])
  classJ[i] <- "Juniors"
  wrJ[i] <- 1
  srJ[i] <- (11.19 - SR100mMenJ)/(11.19-WR100mMenJ)

  i <- i + 1
}
i <- 1
a_nameY <- c()
resultY <- c()
classY <- c()
wrY <- c()
srY <- c()
for (name in athlete_list_M){
  a_nameY[i] <- name
  if (min(athlete100mM[which(athlete100mM$Name == name & athlete100mM$Class == "Youth"), "Result"]) == Inf){
    resultY[i] <- 0
  }
  else{
    resultY[i] <- (11.19 - min(athlete100mM[which(athlete100mM$Name == name & athlete100mM$Class == "Youth"), "Result"]))/(11.19 - WR100mMenY)
  }
  classY[i] <- "Youth"
  wrY[i] <- 1
  srY[i] <- (11.19 - SR100mMenY)/(11.19-WR100mMenY)
  i <- i + 1
}
i <- 1
radar_frameS <- data.frame(Name = a_name,
                          Result = result, 
                          Class = class, 
                          WR = wr,
                          SR = sr)
radar_frameJ <- data.frame(Name = a_nameJ,
                           Result = resultJ, 
                           Class = classJ, 
                           WR = wrJ,
                           SR = srJ)
radar_frameY <- data.frame(Name = a_nameY,
                           Result = resultY, 
                           Class = classY, 
                           WR = wrY,
                           SR = srY)

radar_frame <- merge(x = merge(x = radar_frameS, y = radar_frameJ, by = "Name"), y = radar_frameY, by = "Name")

radar_frame <- subset(radar_frame, select = -c(Class.x, WR.x, SR.x, Class.y, WR.y, SR.y, Class, WR, SR))

colnames(radar_frame) <- c("Name", "Seniors", "Juniors", "Youth")

radar_frame[(length(radar_frame$Name) + 1), ] <- c("World Record in the class", 1,1,1)
radar_frame[(length(radar_frame$Name) + 1), ] <- c("Fictious baseline", 0,0,0)
radar_frame[(length(radar_frame$Name) + 1), ] <- c("Swiss Record in the class", (11.19 - SR100mMen)/(11.19-WR100mMen), (11.19 - SR100mMenJ)/(11.19-WR100mMenJ), (11.19 - SR100mMenY)/(11.19-WR100mMenY))
radar_frame$Seniors <- as.numeric(radar_frame$Seniors)
radar_frame$Juniors <- as.numeric(radar_frame$Juniors)
radar_frame$Youth <- as.numeric(radar_frame$Youth)
radar_frame
```

```{r plot100mM2AW, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frame[which(radar_frame$Name == "Alex Wilson" | radar_frame$Name == "World Record in the class"
                             | radar_frame$Name == "Fictious baseline" | radar_frame$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
           )
legend(0.5,1.2, legend=unique(radar_frame[which(radar_frame$Name == "Alex Wilson" | radar_frame$Name == "World Record in the class"
                                              | radar_frame$Name == "Fictious baseline" | radar_frame$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=0.75, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
       )
```

```{r plot100mM2PM, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frame[which(radar_frame$Name == "Pascal Mancini" | radar_frame$Name == "World Record in the class"
                             | radar_frame$Name == "Fictious baseline" | radar_frame$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
           )
legend(0.5,1.2, legend=unique(radar_frame[which(radar_frame$Name == "Pascal Mancini" | radar_frame$Name == "World Record in the class"
                                              | radar_frame$Name == "Fictious baseline" | radar_frame$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=0.75, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
       )
```

**NB**: it is important to understand that, sometimes, athletes with good final results have 0% in one or two classes. This is not due to the fact that they were extremely bad at one point of their career. In fact, we can explain this problem with the lack of records. It could be that the athlete gained the chance to participate in one of the major competitions in a Senior age or that the athlete is still in Youth/Junior age and he has no records in the Senior class. 

```{r plot100mM3, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
athlete100mM[, "Difference_8"] <- athlete100mM$Result - athlete100mM$Top_8

pWilson <- ggplot(data = athlete100mM)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .05) +
  geom_histogram(data = athlete100mM[which(athlete100mM$Name == "Alex Wilson"), ],
                 aes(x = Difference_8), binwidth = 0.05) +
  scale_fill_manual(name = "Alex Wilson", values = heat.colors(4))  +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

pMancini <- ggplot(data = athlete100mM)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .05) +
  geom_histogram(data = athlete100mM[which(athlete100mM$Name == "Pascal Mancini"), ],
                 aes(x = Difference_8), binwidth = 0.05) +
  scale_fill_manual(name = "Pascal Mancini", values = heat.colors(4))  +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  ) +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

grid.arrange(pWilson, pMancini, ncol=1, nrow = 2)
```

**NB**: in this case the more the black bars are on the left, the better the result of the athlete.

Throughout the years, Swiss athletes started to perform better and better. However, none of the athletes could reach a medal or a certificate in this period. We are confident that the Swiss Federation is working in the right direction. In addition, we advise to keep investing in the discipline for two main reasons: the athlete's bright future and the media impact of the competition. 

## 3.2 Women's 100 m

The first step will be to spot possible patterns in data. We have used a scatter plot in which every class has its own colour and regression line. As before, we believe this is the best plot to show the general trend in data.

```{r 100mWplotEDA, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
library(ggplot2)
library(plotly)
library(fmsb)
# creating a dataset of Swiss athlete in 100m women.
suifemale100m <- olympics[which(olympics$Discipline == "100m"), ]
suifemale100m <- suifemale100m[which(suifemale100m$Gender == "Women"), ]
suifemale100m <- suifemale100m[which(suifemale100m$Class != "Under 23"), ]
suifemale100m <- suifemale100m[which(suifemale100m$Nationality == "SUI"), ]
suifemale100m <- suifemale100m[which(suifemale100m$Result != ""), ]
suifemale100m <- suifemale100m[which(suifemale100m$Result <= 12), ]
suifemale100m[, "Result"] <- as.double(suifemale100m$Result)
# summary(suifemale100m$Result)

# fit <- lm(data = suifemale100m[which(suifemale100m$Class == "Seniors"), ], 
#           formula = Result ~ Year)
# summary(fit)

p <- ggplot(data = suifemale100m,
            aes(x = Year, y = Result, color = Class)) +
  geom_point() +
  geom_smooth(method = "lm")

ggplotly(p)
```

Looking into data, it is clear how the majority of the data were collected after 2010. This could mean that the Swiss Federation is creating the right environment for athletes to develop their full potential. However, we believe it is also true that, in the last ten years, Switzerland Team had extremely performant runners and it could be a unique event for a country that counts less than 9 million inhabitants.

We want now to answer the question “how far are we from records?”. We, therefore, analyse moer deeply some of the athletes. 

We decided to show the analysis of runners, Mujinga Kambundji, Ajla Del Ponte.

```{r script100mW, echo=FALSE, include = FALSE}
sprint100mWoman <- olympics[which(olympics$Discipline == "100m"), ]
sprint100mWoman <- sprint100mWoman[which(sprint100mWoman$Year>=1990), ]
sprint100mWoman <- sprint100mWoman[which(sprint100mWoman$Competition == "Olympic Games" 
                                       | sprint100mWoman$Competition == "World Championships"), ]
sprint100mWoman <- sprint100mWoman[which(sprint100mWoman$Gender == "Women"), ]
sprint100mWoman <- sprint100mWoman[which(sprint100mWoman$Class == "Seniors"), ]
sprint100mWoman <- sprint100mWoman[which(sprint100mWoman$Result != ""), ]
# sprint100mWoman <- sprint100mWoman[which(sprint100mWoman$Medal != ""), ]
sprint100mWoman[, "Result"] <- as.double(sprint100mWoman$Result)
summary(sprint100mWoman$Result)

sprint100mWomanJunior <- olympics[which(olympics$Discipline == "100m"), ]
sprint100mWomanJunior <- sprint100mWomanJunior[which(sprint100mWomanJunior$Year>=1990), ]
sprint100mWomanJunior <- sprint100mWomanJunior[which(sprint100mWomanJunior$Competition == "World Junior Championships"), ]
sprint100mWomanJunior <- sprint100mWomanJunior[which(sprint100mWomanJunior$Gender == "Women"), ]
sprint100mWomanJunior <- sprint100mWomanJunior[which(sprint100mWomanJunior$Class == "Juniors"), ]
sprint100mWomanJunior <- sprint100mWomanJunior[which(sprint100mWomanJunior$Result != ""), ]
# sprint100mWomanJunior <- sprint100mWomanJunior[which(sprint100mWomanJunior$Medal != ""), ]
sprint100mWomanJunior[, "Result"] <- as.double(sprint100mWomanJunior$Result)
summary(sprint100mWomanJunior$Result)

sprint100mWomanYouth <- olympics[which(olympics$Discipline == "100m"), ]
sprint100mWomanYouth <- sprint100mWomanYouth[which(sprint100mWomanYouth$Year>=1990), ]
sprint100mWomanYouth <- sprint100mWomanYouth[which(sprint100mWomanYouth$Competition == "World Youth Championships"
                                                 | sprint100mWomanYouth$Competition == "Youth Olympic Games"), ]
sprint100mWomanYouth <- sprint100mWomanYouth[which(sprint100mWomanYouth$Gender == "Women"), ]
sprint100mWomanYouth <- sprint100mWomanYouth[which(sprint100mWomanYouth$Class == "Youth"), ]
sprint100mWomanYouth <- sprint100mWomanYouth[which(sprint100mWomanYouth$Result != ""), ]
# sprint100mWomanYouth <- sprint100mWomanYouth[which(sprint100mWomanYouth$Medal != ""), ]
sprint100mWomanYouth[, "Result"] <- as.double(sprint100mWomanYouth$Result)
summary(sprint100mWomanYouth$Result)


i <- 2
j <- 2
k <- 2
vector_senior_year <- c(min(sprint100mWoman[which(sprint100mWoman$Year == 2000), "Result"]))
vector_junior_year <- c(min(sprint100mWomanJunior[which(sprint100mWomanJunior$Year == 2000), "Result"]))
vector_youth_year <- c(min(sprint100mWomanYouth[which(sprint100mWomanYouth$Year == 2001), "Result"]))
for (year in 2001:2022){
  vector_senior_year[i] <- min(c(min(sprint100mWoman[which(sprint100mWoman$Year == year), "Result"]), vector_senior_year[i-1]))
  i <- i + 1
  vector_junior_year[j] <- min(c(min(sprint100mWomanJunior[which(sprint100mWomanJunior$Year == year), "Result"]), vector_junior_year[j-1]))
  j <- j + 1
  vector_youth_year[k] <- min(c(min(sprint100mWomanYouth[which(sprint100mWomanYouth$Year == year), "Result"]), vector_youth_year[k-1]))
  k <- k + 1
}

i <- 2
j <- 2
k <- 2
vector_senior_year_8 <- c(sprint100mWoman[which(sprint100mWoman$Year == 1999 & sprint100mWoman$Rank == "8"), "Result"])
vector_junior_year_8 <- c(sprint100mWomanJunior[which(sprint100mWomanJunior$Year == 2000 & sprint100mWomanJunior$Rank == "8"), "Result"])
vector_youth_year_8 <- c(sprint100mWomanYouth[which(sprint100mWomanYouth$Year == 2003 & sprint100mWomanYouth$Rank == "8"), "Result"])
for (year in 2001:2022){
  vector_senior_year_8[i] <- min(c(sprint100mWoman[which(sprint100mWoman$Year == year & sprint100mWoman$Rank == "8"), "Result"], vector_senior_year_8[i-1]))
  i <- i + 1
  vector_junior_year_8[j] <- min(c(sprint100mWomanJunior[which(sprint100mWomanJunior$Year == year & sprint100mWomanJunior$Rank == "8"), "Result"], vector_junior_year_8[j-1]))
  j <- j + 1
  vector_youth_year_8[k] <- min(c(sprint100mWomanYouth[which(sprint100mWomanYouth$Year == year & sprint100mWomanYouth$Rank == "8"), "Result"], vector_youth_year_8[k-1]))
  k <- k + 1
}



vector_senior_year_8
vector_junior_year_8
vector_youth_year_8
vector_best_year <- c(vector_senior_year, vector_junior_year, vector_youth_year)
vector_8_year <- c(vector_senior_year_8, vector_junior_year_8, vector_youth_year_8)
v1 <- 2000:2022
years <- c(v1,v1,v1)
years
vector_class <- c()
vector_class[1:23] <- "Seniors"
vector_class[24:46] <- "Juniors"
vector_class[47:69] <- "Youth"
vector_class

df_result <- data.frame(Year = years,
                        Top_8 = vector_8_year,
                        Top_1 = vector_best_year,
                        Class = vector_class)
df_result

switzerland_athlete_Women_100m <- olympics[which(olympics$Discipline == "100m"), ]
switzerland_athlete_Women_100m <- switzerland_athlete_Women_100m[which(switzerland_athlete_Women_100m$Year>=2000), ]
switzerland_athlete_Women_100m <- switzerland_athlete_Women_100m[which(switzerland_athlete_Women_100m$Gender == "Women"), ]
switzerland_athlete_Women_100m <- switzerland_athlete_Women_100m[which(switzerland_athlete_Women_100m$Nationality == "SUI"), ]
switzerland_athlete_Women_100m <- switzerland_athlete_Women_100m[which(switzerland_athlete_Women_100m$Result != ""), ]
# sprint100mWoman <- sprint100mWoman[which(sprint100mWoman$Medal != ""), ]
switzerland_athlete_Women_100m[, "Result"] <- as.double(switzerland_athlete_Women_100m$Result)
summary(switzerland_athlete_Women_100m$Result)
table(switzerland_athlete_Women_100m$Person)


switzerland_athlete_Women_100m <- data.frame(Name = switzerland_athlete_Women_100m$Person,
                                           Result = switzerland_athlete_Women_100m$Result,
                                           Year = switzerland_athlete_Women_100m$Year,
                                           Class = switzerland_athlete_Women_100m$Class)

switzerland_athlete_Women_100m <- merge(x = switzerland_athlete_Women_100m,
                                      y = df_result, 
                                      by = c("Year", "Class")
)
switzerland_athlete_Women_100m


# Da fare in shiny con un input sul nome dell'atleta.

athlete_list_W <- as.list(unique(switzerland_athlete_Women_100m$Name))
athlete_result <- c()
athlete_name <- c()
athlete_year <- c()
athlete_class <- c()
top8 <- c()
top1 <- c()
i = 1
for (name in athlete_list_W){
  print(name)
  for (year in min(switzerland_athlete_Women_100m$Year):max(switzerland_athlete_Women_100m$Year)){
    print(year)
    if(length(switzerland_athlete_Women_100m[which(switzerland_athlete_Women_100m$Name == name 
                                                 & switzerland_athlete_Women_100m$Year == year), "Result"] != 0)){
      athlete_name[i] <- name
      
      athlete_result[i] <- min(switzerland_athlete_Women_100m[which(switzerland_athlete_Women_100m$Name == name
                                                                  & switzerland_athlete_Women_100m$Year == year),"Result"])
      athlete_year[i] <- year
      athlete_class[i] <- switzerland_athlete_Women_100m[which(switzerland_athlete_Women_100m$Result == athlete_result[i] &
                                                               switzerland_athlete_Women_100m$Name == name & 
                                                               switzerland_athlete_Women_100m$Year == year),"Class"]
      top1[i] <- switzerland_athlete_Women_100m[which(switzerland_athlete_Women_100m$Result == athlete_result[i] &
                                                      switzerland_athlete_Women_100m$Name == name & 
                                                      switzerland_athlete_Women_100m$Year == year),"Top_1"]
      print(top1[i])
      top8[i] <- switzerland_athlete_Women_100m[which(switzerland_athlete_Women_100m$Result == athlete_result[i] &
                                                      switzerland_athlete_Women_100m$Name == name & 
                                                      switzerland_athlete_Women_100m$Year == year),"Top_8"]
      i <- i + 1
    }
  }
}
athlete100mW <- data.frame(Year = athlete_year,
                           Name = athlete_name,
                           Result = athlete_result,
                           Class = athlete_class,
                           Top_8 = top8,
                           Top_1 = top1)
athlete100mW

```

```{r plot100mW1, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
pKabumbundji <- ggplot(data = athlete100mW[which(athlete100mW$Name == "Mujinga Kambundji"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Mujinga Kambundji") +
  xlab("Year") + 
  ylab("Time") 


pDelPonte <- ggplot(data = athlete100mW[which(athlete100mW$Name == "Ajla Del Ponte"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Ajla Del Ponte") +
  xlab("Year") + 
  ylab("Time") 

library(gridExtra)

grid.arrange(pKabumbundji, pDelPonte, ncol=1, nrow = 2)
```

The first graph is about the difference from the best performance of an athlete against the best results. The range of top results is represented by a blue coloured band in which the upper bound is the best time for a runner that finished the competition in the 8th palace and the lower bound is the best time of the winner.

What we can see is the general situation. These athletes are the most performing in Switzerland in the last ten years. In particular, Mujinga  Kambundji and Ajla Del Ponte are considered top performers in their disciplines. 
For what concern Mujinga Kambundj, she won a bronze medal and a silver medal in the European Championship 2016 and 2022.
Ajla Del Ponte won in 2019 the Universiadi, and in the major competitions reached the 5th position in 2021 in the Olympic Games. 
It is necessary then to go into detail to figure out more about them. 
As before, we define two different graphs, the radar chart and the histogram of frequency with interval width of 0.05s. 

```{r radarchart100mW, echo=FALSE, include =FALSE, warning=FALSE, message=FALSE}
WR100mWomen <- min(sprint100mWoman$Result)
WR100mWomenJ <- min(sprint100mWomanJunior$Result)
WR100mWomenY <- min(sprint100mWomanYouth$Result)

SR100mWomen <- min(athlete100mW$Result[which(athlete100mW$Class == "Seniors")])
SR100mWomenJ <- min(athlete100mW$Result[which(athlete100mW$Class == "Juniors")])
SR100mWomenY <- min(athlete100mW$Result[which(athlete100mW$Class == "Youth")])

i <- 1
a_name <- c()
result <- c()
class <- c()
wr <- c()
sr <- c()
for (name in athlete_list_W){
  a_name[i] <- name
  if (min(athlete100mW[which(athlete100mW$Name == name & athlete100mW$Class == "Seniors"), "Result"]) == Inf){
    result[i] <- 0
  }
  else{
    result[i] <- (12.43 - min(athlete100mW[which(athlete100mW$Name == name & athlete100mW$Class == "Seniors"), "Result"]))/(12.43 - WR100mWomen)
  }
  print(result[i])
  class[i] <- "Seniors"
  wr[i] <- 1
  sr[i] <- (12.43 - SR100mWomen)/(12.43-WR100mWomen)
  i <- i + 1
}
i <- 1
a_nameJ <- c()
resultJ <- c()
classJ <- c()
wrJ <- c()
srJ <- c()
for (name in athlete_list_W){
  a_nameJ[i] <- name
  if (min(athlete100mW[which(athlete100mW$Name == name & athlete100mW$Class == "Juniors"), "Result"]) == Inf){
    resultJ[i] <- 0
  }
  else{
    resultJ[i] <- (12.43 - min(athlete100mW[which(athlete100mW$Name == name & athlete100mW$Class == "Juniors"), "Result"]))/(12.43 - WR100mWomenJ)
  }
  print(result[i])
  classJ[i] <- "Juniors"
  wrJ[i] <- 1
  srJ[i] <- (12.43 - SR100mWomenJ)/(12.43-WR100mWomenJ)
  
  i <- i + 1
}
i <- 1
a_nameY <- c()
resultY <- c()
classY <- c()
wrY <- c()
srY <- c()
for (name in athlete_list_W){
  a_nameY[i] <- name
  if (min(athlete100mW[which(athlete100mW$Name == name & athlete100mW$Class == "Youth"), "Result"]) == Inf){
    resultY[i] <- 0
  }
  else{
    resultY[i] <- (12.43 - min(athlete100mW[which(athlete100mW$Name == name & athlete100mW$Class == "Youth"), "Result"]))/(12.43 - WR100mWomenY)
  }
  classY[i] <- "Youth"
  wrY[i] <- 1
  srY[i] <- (12.43 - SR100mWomenY)/(12.43-WR100mWomenY)
  i <- i + 1
}
i <- 1
radar_frameS <- data.frame(Name = a_name,
                          Result = result, 
                          Class = class, 
                          WR = wr,
                          SR = sr)
radar_frameJ <- data.frame(Name = a_nameJ,
                           Result = resultJ, 
                           Class = classJ, 
                           WR = wrJ,
                           SR = srJ)
radar_frameY <- data.frame(Name = a_nameY,
                           Result = resultY, 
                           Class = classY, 
                           WR = wrY,
                           SR = srY)

radar_frameW <- merge(x = merge(x = radar_frameS, y = radar_frameJ, by = "Name"), y = radar_frameY, by = "Name")
radar_frameW

radar_frameW <- subset(radar_frameW, select = -c(Class.x, WR.x, SR.x, Class.y, WR.y, SR.y, Class, WR, SR))

colnames(radar_frameW) <- c("Name", "Seniors", "Juniors", "Youth")

radar_frameW[(length(radar_frameW$Name) + 1), ] <- c("World Record in the class", 1,1,1)
radar_frameW[(length(radar_frameW$Name) + 1), ] <- c("Fictious baseline", 0,0,0)
radar_frameW[(length(radar_frameW$Name) + 1), ] <- c("Swiss Record in the class", (12.43 - SR100mWomen)/(12.43-WR100mWomen), (12.43 - SR100mWomenJ)/(12.43-WR100mWomenJ), (12.43 - SR100mWomenY)/(12.43-WR100mWomenY))
radar_frameW$Seniors <- as.numeric(radar_frameW$Seniors)
radar_frameW$Juniors <- as.numeric(radar_frameW$Juniors)
radar_frameW$Youth <- as.numeric(radar_frameW$Youth)
radar_frameW
```

```{r plot100mW2MK, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frameW[which(radar_frameW$Name == "Mujinga Kambundji" | radar_frameW$Name == "World Record in the class"
                             | radar_frameW$Name == "Fictious baseline" | radar_frameW$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,2,1,2),
           plty = c("solid", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frameW[which(radar_frameW$Name == "Mujinga Kambundji" | radar_frameW$Name == "World Record in the class"
                                            | radar_frameW$Name == "Fictious baseline" | radar_frameW$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=0.75, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

```{r plot100mW2ADP, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frameW[which(radar_frameW$Name == "Ajla Del Ponte" | radar_frameW$Name == "World Record in the class"
                             | radar_frameW$Name == "Fictious baseline" | radar_frameW$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,2,1,2),
           plty = c("solid", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frameW[which(radar_frameW$Name == "Ajla Del Ponte" | radar_frameW$Name == "World Record in the class"
                                            | radar_frameW$Name == "Fictious baseline" | radar_frameW$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=0.75, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

**NB**: it is important to understand that, sometimes, athletes with good final results have 0% in one or two classes. This is not due to the fact that they were extremely bad at one point of their career. In fact, we can explain this problem with the lack of records. It could be that the athlete gained the chance to participate in one of the major competitions in a Senior age or that the athlete is still in Youth/Junior age and he has no records in the Senior class. 

```{r plot100mW3, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
athlete100mW[, "Difference_8"] <- athlete100mW$Result - athlete100mW$Top_8

pKabumbundji <-  ggplot(data = athlete100mW)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .05) +
  geom_histogram(data = athlete100mW[which(athlete100mW$Name == "Mujinga Kambundji"), ],
                 aes(x = Difference_8), binwidth = 0.05) +
  scale_fill_manual(name = "Mujinga Kambundji", values = heat.colors(4)) +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

pDelPonte <- ggplot(data = athlete100mW)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .05) +
  geom_histogram(data = athlete100mW[which(athlete100mW$Name == "Ajla Del Ponte"), ],
                 aes(x = Difference_8), binwidth = 0.05) +
  scale_fill_manual(name = "Ajla Del Ponte", values = heat.colors(4)) +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")


grid.arrange(pKabumbundji, pDelPonte, ncol=1, nrow = 2)
```

**NB**: in this case the more the black bars are on the left, the better the result of the athlete.

Differently from the men’s situation, women athletes can compete for a medal. This is not a minor detail, since the purpose of the Federation is to develop the athletes in order to reach the top position in the major competitions. We, therefore, believe that the investment in the woman’s sprinters academies should be maintained. First of all, due to the symbolic importance of this particular discipline, followed by people from all over the globe with extreme interest. Then, because as we were saying before, it could be a matter of luck that more than a single athlete, from such a small country as Switzerland, can compete at top levels (of course, we hope to be wrong on this point). 

## 3.3 Men's 200m

The men’s 200m situation is quite similar to the one in the 100m. We decided to use a simple scatterplot in which every class has its own colour. We opted for showing the linear regression line. This operation does not mean we are trying to forecast anything, we just believe that in this way the reader can have a clearer idea of the global trend. 

```{r 200mMplotEDA, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
# creating a dataset of Swiss athlete in 100m men.
suimale200m <- olympics[which(olympics$Discipline == "200m"), ]
suimale200m <- suimale200m[which(suimale200m$Class!="Under 23"), ]
suimale200m <- suimale200m[which(suimale200m$Gender == "Men"), ]
suimale200m <- suimale200m[which(suimale200m$Nationality == "SUI"), ]
suimale200m <- suimale200m[which(suimale200m$Result != ""), ]
suimale200m[, "Result"] <- as.double(suimale200m$Result)
# summary(suimale200m$Result)
# 
# 
# fit <- lm(data = suimale200m, 
#           formula = Result ~ Year)
# summary(fit)

p <- ggplot(data = suimale200m,
            aes(x = Year, y = Result, colour = Class)) +
  geom_point() +
  geom_smooth(method = "lm")

ggplotly(p)
```

The majority of the records are in the temporal range that goes from 2000 to today. Using the scatterplot we want to underline another aspect that we believe could eventually become a problem. It is undeniable that we have a lot of records in Seniors class. However, what makes us confused is the lack of record in the Youth championship. This could be due to many different factors, in particular, we believe that the hypothesis of no generational change cannot be ruled out. 

As usual, we want now to answer the question “how far are we from records?”. In order to do it, we need to analyse Swiss top athletes in detail. 

We decided to show the analysis of the following runners, Alex Wilson, Marc Schneeberger. 

```{r script200mM, echo=FALSE, include = FALSE}
sprint200mMale <- olympics[which(olympics$Discipline == "200m"), ]
sprint200mMale <- sprint200mMale[which(sprint200mMale$Year>=1990), ]
sprint200mMale <- sprint200mMale[which(sprint200mMale$Competition == "Olympic Games" 
                                       | sprint200mMale$Competition == "World Championships"), ]
sprint200mMale <- sprint200mMale[which(sprint200mMale$Gender == "Men"), ]
sprint200mMale <- sprint200mMale[which(sprint200mMale$Class == "Seniors"), ]
sprint200mMale <- sprint200mMale[which(sprint200mMale$Result != ""), ]
# sprint200mMale <- sprint200mMale[which(sprint200mMale$Medal != ""), ]
sprint200mMale[, "Result"] <- as.double(sprint200mMale$Result)
sprint200mMale <- sprint200mMale[which(!is.na(sprint200mMale$Result)), ]
summary(sprint200mMale$Result[which(!is.na(sprint200mMale$Result))])

sprint200mMaleJunior <- olympics[which(olympics$Discipline == "200m"), ]
sprint200mMaleJunior <- sprint200mMaleJunior[which(sprint200mMaleJunior$Year>=1990), ]
sprint200mMaleJunior <- sprint200mMaleJunior[which(sprint200mMaleJunior$Competition == "World Junior Championships"), ]
sprint200mMaleJunior <- sprint200mMaleJunior[which(sprint200mMaleJunior$Gender == "Men"), ]
sprint200mMaleJunior <- sprint200mMaleJunior[which(sprint200mMaleJunior$Class == "Juniors"), ]
sprint200mMaleJunior <- sprint200mMaleJunior[which(sprint200mMaleJunior$Result != ""), ]
# sprint200mMaleJunior <- sprint200mMaleJunior[which(sprint200mMaleJunior$Medal != ""), ]
sprint200mMaleJunior[, "Result"] <- as.double(sprint200mMaleJunior$Result)
sprint200mMaleJunior <- sprint200mMaleJunior[which(!is.na(sprint200mMaleJunior$Result)), ]
summary(sprint200mMaleJunior$Result)

sprint200mMaleYouth <- olympics[which(olympics$Discipline == "200m"), ]
sprint200mMaleYouth <- sprint200mMaleYouth[which(sprint200mMaleYouth$Year>=1990), ]
sprint200mMaleYouth <- sprint200mMaleYouth[which(sprint200mMaleYouth$Competition == "World Youth Championships"
                                                 | sprint200mMaleYouth$Competition == "Youth Olympic Games"), ]
sprint200mMaleYouth <- sprint200mMaleYouth[which(sprint200mMaleYouth$Gender == "Men"), ]
sprint200mMaleYouth <- sprint200mMaleYouth[which(sprint200mMaleYouth$Class == "Youth"), ]
sprint200mMaleYouth <- sprint200mMaleYouth[which(sprint200mMaleYouth$Result != ""), ]
# sprint200mMaleYouth <- sprint200mMaleYouth[which(sprint200mMaleYouth$Medal != ""), ]
sprint200mMaleYouth[, "Result"] <- as.double(sprint200mMaleYouth$Result)
summary(sprint200mMaleYouth$Result)


i <- 2
j <- 2
k <- 2
vector_senior_year <- c(min(sprint200mMale[which(sprint200mMale$Year == 2000), "Result"]))
vector_junior_year <- c(min(sprint200mMaleJunior[which(sprint200mMaleJunior$Year == 2000), "Result"]))
vector_youth_year <- c(min(sprint200mMaleYouth[which(sprint200mMaleYouth$Year == 2001), "Result"]))
for (year in 2001:2022){
  vector_senior_year[i] <- min(c(min(sprint200mMale[which(sprint200mMale$Year == year), "Result"]), vector_senior_year[i-1]))
  i <- i + 1
  vector_junior_year[j] <- min(c(min(sprint200mMaleJunior[which(sprint200mMaleJunior$Year == year), "Result"]), vector_junior_year[j-1]))
  j <- j + 1
  vector_youth_year[k] <- min(c(min(sprint200mMaleYouth[which(sprint200mMaleYouth$Year == year), "Result"]), vector_youth_year[k-1]))
  k <- k + 1
}

i <- 2
j <- 2
k <- 2
vector_senior_year_8 <- c(sprint200mMale[which(sprint200mMale$Year == 2000 & sprint200mMale$Rank == "8"), "Result"])
vector_junior_year_8 <- c(sprint200mMaleJunior[which(sprint200mMaleJunior$Year == 2000 & sprint200mMaleJunior$Rank == "8"), "Result"])
vector_youth_year_8 <- c(sprint200mMaleYouth[which(sprint200mMaleYouth$Year == 2009 & sprint200mMaleYouth$Rank == "8"), "Result"])
for (year in 2001:2022){
  vector_senior_year_8[i] <- min(c(sprint200mMale[which(sprint200mMale$Year == year & sprint200mMale$Rank == "8"), "Result"], vector_senior_year_8[i-1]))
  i <- i + 1
  vector_junior_year_8[j] <- min(c(sprint200mMaleJunior[which(sprint200mMaleJunior$Year == year & sprint200mMaleJunior$Rank == "8"), "Result"], vector_junior_year_8[j-1]))
  j <- j + 1
  vector_youth_year_8[k] <- min(c(sprint200mMaleYouth[which(sprint200mMaleYouth$Year == year & sprint200mMaleYouth$Rank == "8"), "Result"], vector_youth_year_8[k-1]))
  k <- k + 1
}


vector_best_year <- c(vector_senior_year, vector_junior_year, vector_youth_year)
vector_8_year <- c(vector_senior_year_8, vector_junior_year_8, vector_youth_year_8)
v1 <- 2000:2022
years <- c(v1,v1,v1)
years
vector_class <- c()
vector_class[1:23] <- "Seniors"
vector_class[24:46] <- "Juniors"
vector_class[47:69] <- "Youth"
vector_class

df_result <- data.frame(Year = years,
                        Top_8 = vector_8_year,
                        Top_1 = vector_best_year,
                        Class = vector_class)
df_result

switzerland_athlete_Men_200m <- olympics[which(olympics$Discipline == "200m"), ]
switzerland_athlete_Men_200m <- switzerland_athlete_Men_200m[which(switzerland_athlete_Men_200m$Year>=2000), ]
switzerland_athlete_Men_200m <- switzerland_athlete_Men_200m[which(switzerland_athlete_Men_200m$Gender == "Men"), ]
switzerland_athlete_Men_200m <- switzerland_athlete_Men_200m[which(switzerland_athlete_Men_200m$Nationality == "SUI"), ]
switzerland_athlete_Men_200m <- switzerland_athlete_Men_200m[which(switzerland_athlete_Men_200m$Result != ""), ]
# sprint200mMale <- sprint200mMale[which(sprint200mMale$Medal != ""), ]
switzerland_athlete_Men_200m[, "Result"] <- as.double(switzerland_athlete_Men_200m$Result)
summary(switzerland_athlete_Men_200m$Result)
table(switzerland_athlete_Men_200m$Person)


switzerland_athlete_Men_200m <- data.frame(Name = switzerland_athlete_Men_200m$Person,
                                           Result = switzerland_athlete_Men_200m$Result,
                                           Year = switzerland_athlete_Men_200m$Year,
                                           Class = switzerland_athlete_Men_200m$Class)

switzerland_athlete_Men_200m <- merge(x = switzerland_athlete_Men_200m,
                                      y = df_result, 
                                      by = c("Year", "Class")
)
switzerland_athlete_Men_200m


# Da fare in shiny con un input sul nome dell'atleta.

athlete_list_M_200m <- as.list(unique(switzerland_athlete_Men_200m$Name))
athlete_result <- c()
athlete_name <- c()
athlete_year <- c()
athlete_class <- c()
top8 <- c()
top1 <- c()
i = 1
for (name in athlete_list_M_200m){
  print(name)
  for (year in min(switzerland_athlete_Men_200m$Year):max(switzerland_athlete_Men_200m$Year)){
    print(year)
    if(length(switzerland_athlete_Men_200m[which(switzerland_athlete_Men_200m$Name == name 
                                                 & switzerland_athlete_Men_200m$Year == year), "Result"] != 0)){
      athlete_name[i] <- name
      
      athlete_result[i] <- min(switzerland_athlete_Men_200m[which(switzerland_athlete_Men_200m$Name == name
                                                                  & switzerland_athlete_Men_200m$Year == year),"Result"])
      athlete_year[i] <- year
      athlete_class[i] <- switzerland_athlete_Men_200m[which(switzerland_athlete_Men_200m$Result == athlete_result[i] &
                                                               switzerland_athlete_Men_200m$Name == name & 
                                                               switzerland_athlete_Men_200m$Year == year),"Class"]
      top1[i] <- switzerland_athlete_Men_200m[which(switzerland_athlete_Men_200m$Result == athlete_result[i] &
                                                      switzerland_athlete_Men_200m$Name == name & 
                                                      switzerland_athlete_Men_200m$Year == year),"Top_1"]
      print(top1[i])
      top8[i] <- switzerland_athlete_Men_200m[which(switzerland_athlete_Men_200m$Result == athlete_result[i] &
                                                      switzerland_athlete_Men_200m$Name == name & 
                                                      switzerland_athlete_Men_200m$Year == year),"Top_8"]
      i <- i + 1
    }
  }
}
athlete200mM <- data.frame(Year = athlete_year,
                           Name = athlete_name,
                           Result = athlete_result,
                           Class = athlete_class,
                           Top_8 = top8,
                           Top_1 = top1)
athlete200mM
```

```{r plot200mM1, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
pWilson <- ggplot(data = athlete200mM[which(athlete200mM$Name == "Alex Wilson"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Alex Wilson") +
  xlab("Year") + 
  ylab("Time") 

pSchneeberger <- ggplot(data = athlete200mM[which(athlete200mM$Name == "Marc Schneeberger"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Marc Schneeberger") +
  xlab("Year") + 
  ylab("Time")

library(gridExtra)

grid.arrange(pWilson, pSchneeberger, ncol=1, nrow = 2)
```

The first graph is about the difference from the best performance of an athlete against the best results. The range of top results is represented by a blue coloured band in which the upper bound is the best time for a runner that finished the competition in the 8th palace and the lower bound is the best time of the winner .

Generally, in the 200m Swiss athletes seem to be more competitive than in the 100m. In particular, a top performer (also) in the 100m run, Alex Wilson, achieved the bronze medal in the European Championship 2018. Moreover, William Reais won the European Championship competition Under 23 (out of our analysis, but interesting to know) in 2021. 
We are going to show two types of graph, a radar chart, to track how distant was an athlete from the record in each class, and a graph counting the frequency of the difference in time from the minimum result to achieve a certificate. The black blocks represent the athlete count. The intervals have a width of 0.15s. 

```{r radarchart200mM, echo=FALSE, include =FALSE, warning=FALSE, message=FALSE}
WR200mMen <- min(sprint200mMale$Result)
WR200mMenJ <- min(sprint200mMaleJunior$Result)
WR200mMenY <- min(sprint200mMaleYouth$Result)

SR200mMen <- min(athlete200mM$Result[which(athlete200mM$Class == "Seniors")])
SR200mMenJ <- min(athlete200mM$Result[which(athlete200mM$Class == "Juniors")])
SR200mMenY <- min(athlete200mM$Result[which(athlete200mM$Class == "Youth")])

i <- 1
a_name <- c()
result <- c()
class <- c()
wr <- c()
sr <- c()
for (name in athlete_list_M_200m){
  a_name[i] <- name
  if (min(athlete200mM[which(athlete200mM$Name == name & athlete200mM$Class == "Seniors"), "Result"]) == Inf){
    result[i] <- 0
  }
  else{
    result[i] <- (22.97 - min(athlete200mM[which(athlete200mM$Name == name & athlete200mM$Class == "Seniors"), "Result"]))/(22.97 - WR200mMen)
  }
  print(result[i])
  class[i] <- "Seniors"
  wr[i] <- 1
  sr[i] <- (22.97 - SR200mMen)/(22.97-WR200mMen)
  i <- i + 1
}
i <- 1
a_nameJ <- c()
resultJ <- c()
classJ <- c()
wrJ <- c()
srJ <- c()
for (name in athlete_list_M_200m){
  a_nameJ[i] <- name
  if (min(athlete200mM[which(athlete200mM$Name == name & athlete200mM$Class == "Juniors"), "Result"]) == Inf){
    resultJ[i] <- 0
  }
  else{
    resultJ[i] <- (22.97 - min(athlete200mM[which(athlete200mM$Name == name & athlete200mM$Class == "Juniors"), "Result"]))/(22.97 - WR200mMenJ)
  }
  print(result[i])
  classJ[i] <- "Juniors"
  wrJ[i] <- 1
  srJ[i] <- (22.97 - SR200mMenJ)/(22.97-WR200mMenJ)
  
  i <- i + 1
}
i <- 1
a_nameY <- c()
resultY <- c()
classY <- c()
wrY <- c()
srY <- c()
for (name in athlete_list_M_200m){
  a_nameY[i] <- name
  if (min(athlete200mM[which(athlete200mM$Name == name & athlete200mM$Class == "Youth"), "Result"]) == Inf){
    resultY[i] <- 0
  }
  else{
    resultY[i] <- (22.97 - min(athlete200mM[which(athlete200mM$Name == name & athlete200mM$Class == "Youth"), "Result"]))/(22.97 - WR200mMenY)
  }
  classY[i] <- "Youth"
  wrY[i] <- 1
  srY[i] <- (22.97 - SR200mMenY)/(22.97-WR200mMenY)
  i <- i + 1
}
i <- 1
radar_frameS <- data.frame(Name = a_name,
                           Result = result, 
                           Class = class, 
                           WR = wr,
                           SR = sr)
radar_frameJ <- data.frame(Name = a_nameJ,
                           Result = resultJ, 
                           Class = classJ, 
                           WR = wrJ,
                           SR = srJ)
radar_frameY <- data.frame(Name = a_nameY,
                           Result = resultY, 
                           Class = classY, 
                           WR = wrY,
                           SR = srY)

radar_frame200 <- merge(x = merge(x = radar_frameS, y = radar_frameJ, by = "Name"), y = radar_frameY, by = "Name")

radar_frame200 <- subset(radar_frame200, select = -c(Class.x, WR.x, SR.x, Class.y, WR.y, SR.y, Class, WR, SR))

colnames(radar_frame200) <- c("Name", "Seniors", "Juniors", "Youth")

radar_frame200[(length(radar_frame200$Name) + 1), ] <- c("World Record in the class", 1,1,1)
radar_frame200[(length(radar_frame200$Name) + 1), ] <- c("Fictious baseline", 0,0,0)
radar_frame200[(length(radar_frame200$Name) + 1), ] <- c("Swiss Record in the class", (22.97 - SR200mMen)/(22.97-WR200mMen), (22.97 - SR200mMenJ)/(22.97-WR200mMenJ), (22.97 - SR200mMenY)/(22.97-WR200mMenY))
radar_frame200$Seniors <- as.numeric(radar_frame200$Seniors)
radar_frame200$Juniors <- as.numeric(radar_frame200$Juniors)
radar_frame200$Youth <- as.numeric(radar_frame200$Youth)
radar_frame200
```

```{r plot200mM2AW, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frame200[which(radar_frame200$Name == "Alex Wilson" | radar_frame200$Name == "World Record in the class"
                             | radar_frame200$Name == "Fictious baseline" | radar_frame200$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frame200[which(radar_frame200$Name == "Alex Wilson" | radar_frame200$Name == "World Record in the class"
                                            | radar_frame200$Name == "Fictious baseline" | radar_frame200$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=0.75, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

```{r plot200mM2MS, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frame200[which(radar_frame200$Name == "Marc Schneeberger" | radar_frame200$Name == "World Record in the class"
                             | radar_frame200$Name == "Fictious baseline" | radar_frame200$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frame200[which(radar_frame200$Name == "Marc Schneeberger" | radar_frame200$Name == "World Record in the class"
                                            | radar_frame200$Name == "Fictious baseline" | radar_frame200$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=0.75, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

**NB**: it is important to understand that, sometimes, athletes with good final results have 0% in one or two classes. This is not due to the fact that they were extremely bad at one point of their career. In fact, we can explain this problem with the lack of records. It could be that the athlete gained the chance to participate in one of the major competitions in a Senior age or that the athlete is still in Youth/Junior age and he has no records in the Senior class. 

```{r plot200mM3, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
athlete200mM[, "Difference_8"] <- athlete200mM$Result - athlete200mM$Top_8

pWilson <- ggplot(data = athlete200mM)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .15) +
  geom_histogram(data = athlete200mM[which(athlete200mM$Name == "Alex Wilson"), ],
                 aes(x = Difference_8), binwidth = 0.15) +
  scale_fill_manual(name = "Alex Wilson", values = heat.colors(4))  +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

pSchneeberger <-ggplot(data = athlete200mM)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .15) +
  geom_histogram(data = athlete200mM[which(athlete200mM$Name == "Marc Schneeberger"), ],
                 aes(x = Difference_8), binwidth = 0.15) +
  scale_fill_manual(name = "Marc Schneeberger", values = heat.colors(4))  +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  ) +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

grid.arrange(pWilson, pSchneeberger, ncol=1, nrow = 2)
```

**NB**: in this case the more the black bars are on the left, the better the result of the athlete.

The results in this case are pretty much clear. The athletes are performing better and better, they won some medals in the major competitions, there is a large number of performers that are world class level. We think that the Federation should proceed this way, keep investing in the development of the athletes, putting attention to monitoring the Youth situation, not totally understandable from the few records that we have at the moment. 

## 3.4 Women's 200m

As usual, we want to show the possible patterns in data of this discipline. We used a scatter plot in which every class has its own colour. The linear regression is shown just to have an idea of the trends. 

```{r 200mWplotEDA, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
suifemale200m <- olympics[which(olympics$Discipline == "200m"), ]
suifemale200m <- suifemale200m[which(suifemale200m$Year>=1990), ]
suifemale200m <- suifemale200m[which(suifemale200m$Gender == "Women"), ]
suifemale200m <- suifemale200m[which(suifemale200m$Class != "Under 23"), ]
suifemale200m <- suifemale200m[which(suifemale200m$Nationality == "SUI"), ]
suifemale200m <- suifemale200m[which(suifemale200m$Result != ""), ]
suifemale200m[, "Result"] <- as.double(suifemale200m$Result)
# summary(suifemale200m$Result)
# 
# fit <- lm(data = suifemale200m, 
#           formula = Result ~ Year)
# summary(fit)

p <- ggplot(data = suifemale200m,
            aes(x = Year, y = Result, colour = Class)) +
  geom_point() +
  geom_smooth(method = "lm")

ggplotly(p)
```

Similarly to the case of women 100m, the data are concentrated between 2010 and today. It is possible to notice how many values are in the Senior class and in the Juniors. Also in this discipline the top athlete is Mujinga Kambundji, followed by Sarah Atcho and Lea Sprunger. 
In particular Mujinga Kambundji won a gold medal in the last European Championship. Apart from her, only Sarah Atcho could go under 23s in the discipline.

The question is “how far are we from records?”. To answer, we need to understand Swiss athletes in detail. 

We decided to show the analysis of two of the athletes nominated above. 

```{r script200mW, echo=FALSE, include = FALSE}
sprint200mWoman <- olympics[which(olympics$Discipline == "200m"), ]
sprint200mWoman <- sprint200mWoman[which(sprint200mWoman$Year>=1990), ]
sprint200mWoman <- sprint200mWoman[which(sprint200mWoman$Competition == "Olympic Games" 
                                       | sprint200mWoman$Competition == "World Championships"), ]
sprint200mWoman <- sprint200mWoman[which(sprint200mWoman$Gender == "Women"), ]
sprint200mWoman <- sprint200mWoman[which(sprint200mWoman$Class == "Seniors"), ]
sprint200mWoman <- sprint200mWoman[which(sprint200mWoman$Result != ""), ]
# sprint200mWoman <- sprint200mWoman[which(sprint200mWoman$Medal != ""), ]
sprint200mWoman[, "Result"] <- as.double(sprint200mWoman$Result)
sprint200mWoman <- sprint200mWoman[which(!is.na(sprint200mWoman$Result)), ]
summary(sprint200mWoman$Result[which(!is.na(sprint200mWoman$Result))])

sprint200mWomanJunior <- olympics[which(olympics$Discipline == "200m"), ]
sprint200mWomanJunior <- sprint200mWomanJunior[which(sprint200mWomanJunior$Year>=1990), ]
sprint200mWomanJunior <- sprint200mWomanJunior[which(sprint200mWomanJunior$Competition == "World Junior Championships"), ]
sprint200mWomanJunior <- sprint200mWomanJunior[which(sprint200mWomanJunior$Gender == "Women"), ]
sprint200mWomanJunior <- sprint200mWomanJunior[which(sprint200mWomanJunior$Class == "Juniors"), ]
sprint200mWomanJunior <- sprint200mWomanJunior[which(sprint200mWomanJunior$Result != ""), ]
# sprint200mWomanJunior <- sprint200mWomanJunior[which(sprint200mWomanJunior$Medal != ""), ]
sprint200mWomanJunior[, "Result"] <- as.double(sprint200mWomanJunior$Result)
sprint200mWomanJunior <- sprint200mWomanJunior[which(!is.na(sprint200mWomanJunior$Result)), ]
summary(sprint200mWomanJunior$Result)

sprint200mWomanYouth <- olympics[which(olympics$Discipline == "200m"), ]
sprint200mWomanYouth <- sprint200mWomanYouth[which(sprint200mWomanYouth$Year>=1990), ]
sprint200mWomanYouth <- sprint200mWomanYouth[which(sprint200mWomanYouth$Competition == "World Youth Championships"
                                                 | sprint200mWomanYouth$Competition == "Youth Olympic Games"), ]
sprint200mWomanYouth <- sprint200mWomanYouth[which(sprint200mWomanYouth$Gender == "Women"), ]
sprint200mWomanYouth <- sprint200mWomanYouth[which(sprint200mWomanYouth$Class == "Youth"), ]
sprint200mWomanYouth <- sprint200mWomanYouth[which(sprint200mWomanYouth$Result != ""), ]
# sprint200mWomanYouth <- sprint200mWomanYouth[which(sprint200mWomanYouth$Medal != ""), ]
sprint200mWomanYouth[, "Result"] <- as.double(sprint200mWomanYouth$Result)
summary(sprint200mWomanYouth$Result)


i <- 2
j <- 2
k <- 2
vector_senior_year <- c(min(sprint200mWoman[which(sprint200mWoman$Year == 2000), "Result"]))
vector_junior_year <- c(min(sprint200mWomanJunior[which(sprint200mWomanJunior$Year == 2000), "Result"]))
vector_youth_year <- c(min(sprint200mWomanYouth[which(sprint200mWomanYouth$Year == 2001), "Result"]))
for (year in 2001:2022){
  vector_senior_year[i] <- min(c(min(sprint200mWoman[which(sprint200mWoman$Year == year), "Result"]), vector_senior_year[i-1]))
  i <- i + 1
  vector_junior_year[j] <- min(c(min(sprint200mWomanJunior[which(sprint200mWomanJunior$Year == year), "Result"]), vector_junior_year[j-1]))
  j <- j + 1
  vector_youth_year[k] <- min(c(min(sprint200mWomanYouth[which(sprint200mWomanYouth$Year == year), "Result"]), vector_youth_year[k-1]))
  k <- k + 1
}

i <- 2
j <- 2
k <- 2
vector_senior_year_8 <- c(sprint200mWoman[which(sprint200mWoman$Year == 2000 & sprint200mWoman$Rank == "8"), "Result"])
vector_junior_year_8 <- c(sprint200mWomanJunior[which(sprint200mWomanJunior$Year == 2000 & sprint200mWomanJunior$Rank == "8"), "Result"])
vector_youth_year_8 <- c(sprint200mWomanYouth[which(sprint200mWomanYouth$Year == 2003 & sprint200mWomanYouth$Rank == "8"), "Result"])
for (year in 2001:2022){
  vector_senior_year_8[i] <- min(c(sprint200mWoman[which(sprint200mWoman$Year == year & sprint200mWoman$Rank == "8"), "Result"], vector_senior_year_8[i-1]))
  i <- i + 1
  vector_junior_year_8[j] <- min(c(sprint200mWomanJunior[which(sprint200mWomanJunior$Year == year & sprint200mWomanJunior$Rank == "8"), "Result"], vector_junior_year_8[j-1]))
  j <- j + 1
  vector_youth_year_8[k] <- min(c(sprint200mWomanYouth[which(sprint200mWomanYouth$Year == year & sprint200mWomanYouth$Rank == "8"), "Result"], vector_youth_year_8[k-1]))
  k <- k + 1
}


vector_best_year <- c(vector_senior_year, vector_junior_year, vector_youth_year)
vector_8_year <- c(vector_senior_year_8, vector_junior_year_8, vector_youth_year_8)
v1 <- 2000:2022
years <- c(v1,v1,v1)
years
vector_class <- c()
vector_class[1:23] <- "Seniors"
vector_class[24:46] <- "Juniors"
vector_class[47:69] <- "Youth"
vector_class

df_result <- data.frame(Year = years,
                        Top_8 = vector_8_year,
                        Top_1 = vector_best_year,
                        Class = vector_class)
df_result

switzerland_athlete_Women_200m <- olympics[which(olympics$Discipline == "200m"), ]
switzerland_athlete_Women_200m <- switzerland_athlete_Women_200m[which(switzerland_athlete_Women_200m$Year>=2000), ]
switzerland_athlete_Women_200m <- switzerland_athlete_Women_200m[which(switzerland_athlete_Women_200m$Gender == "Women"), ]
switzerland_athlete_Women_200m <- switzerland_athlete_Women_200m[which(switzerland_athlete_Women_200m$Nationality == "SUI"), ]
switzerland_athlete_Women_200m <- switzerland_athlete_Women_200m[which(switzerland_athlete_Women_200m$Result != ""), ]
# sprint200mWoman <- sprint200mWoman[which(sprint200mWoman$Medal != ""), ]
switzerland_athlete_Women_200m[, "Result"] <- as.double(switzerland_athlete_Women_200m$Result)
summary(switzerland_athlete_Women_200m$Result)
table(switzerland_athlete_Women_200m$Person)


switzerland_athlete_Women_200m <- data.frame(Name = switzerland_athlete_Women_200m$Person,
                                           Result = switzerland_athlete_Women_200m$Result,
                                           Year = switzerland_athlete_Women_200m$Year,
                                           Class = switzerland_athlete_Women_200m$Class)

switzerland_athlete_Women_200m <- merge(x = switzerland_athlete_Women_200m,
                                      y = df_result, 
                                      by = c("Year", "Class")
)
switzerland_athlete_Women_200m


# Da fare in shiny con un input sul nome dell'atleta.

athlete_list_W_200m <- as.list(unique(switzerland_athlete_Women_200m$Name))
athlete_result <- c()
athlete_name <- c()
athlete_year <- c()
athlete_class <- c()
top8 <- c()
top1 <- c()
i = 1
for (name in athlete_list_W_200m){
  print(name)
  for (year in min(switzerland_athlete_Women_200m$Year):max(switzerland_athlete_Women_200m$Year)){
    print(year)
    if(length(switzerland_athlete_Women_200m[which(switzerland_athlete_Women_200m$Name == name 
                                                 & switzerland_athlete_Women_200m$Year == year), "Result"] != 0)){
      athlete_name[i] <- name
      
      athlete_result[i] <- min(switzerland_athlete_Women_200m[which(switzerland_athlete_Women_200m$Name == name
                                                                  & switzerland_athlete_Women_200m$Year == year),"Result"])
      athlete_year[i] <- year
      athlete_class[i] <- switzerland_athlete_Women_200m[which(switzerland_athlete_Women_200m$Result == athlete_result[i] &
                                                               switzerland_athlete_Women_200m$Name == name & 
                                                               switzerland_athlete_Women_200m$Year == year),"Class"]
      top1[i] <- switzerland_athlete_Women_200m[which(switzerland_athlete_Women_200m$Result == athlete_result[i] &
                                                      switzerland_athlete_Women_200m$Name == name & 
                                                      switzerland_athlete_Women_200m$Year == year),"Top_1"]
      print(top1[i])
      top8[i] <- switzerland_athlete_Women_200m[which(switzerland_athlete_Women_200m$Result == athlete_result[i] &
                                                      switzerland_athlete_Women_200m$Name == name & 
                                                      switzerland_athlete_Women_200m$Year == year),"Top_8"]
      i <- i + 1
    }
  }
}
athlete200mW <- data.frame(Year = athlete_year,
                           Name = athlete_name,
                           Result = athlete_result,
                           Class = athlete_class,
                           Top_8 = top8,
                           Top_1 = top1)
athlete200mW
```

```{r plot200mW1, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
pKabumbundji <- ggplot(data = athlete200mW[which(athlete200mW$Name == "Mujinga Kambundji"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Mujinga Kambundji") +
  xlab("Year") + 
  ylab("Time") 

pAtcho <- ggplot(data = athlete200mW[which(athlete200mW$Name == "Sarah Atcho"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Sarah Atcho") +
  xlab("Year") + 
  ylab("Time") 

library(gridExtra)

grid.arrange(pKabumbundji, pAtcho, ncol=1, nrow = 2)
```

The first graph is about the difference from the best performance of an athlete against the best results. The range of top results is represented by a blue coloured band in which the upper bound is the best time for a runner that finished the competition in the 8th palace and the lower bound is the best time of the winner.

In the next section two different graph will be used, a radar chart and a histogram.
As the men, in this discipline the athletes seem to be more performant. Mujinga Kambundji is the top performer in each class and it is possible to notice that from the radar chart. 
The second kind of graph is representing the distance from the minimum possible result to have high probability to achieve a certificate or a medal. The black blocks represent the athlete count. The intervals have a width of 0.15s.


```{r radarchart200mW, echo=FALSE, include =FALSE, warning=FALSE, message=FALSE}
WR200mWomen <- min(sprint200mWoman$Result)
WR200mWomenJ <- min(sprint200mWomanJunior$Result)
WR200mWomenY <- min(sprint200mWomanYouth$Result)

SR200mWomen <- min(athlete200mW$Result[which(athlete200mW$Class == "Seniors")])
SR200mWomenJ <- min(athlete200mW$Result[which(athlete200mW$Class == "Juniors")])
SR200mWomenY <- min(athlete200mW$Result[which(athlete200mW$Class == "Youth")])

i <- 1
a_name <- c()
result <- c()
class <- c()
wr <- c()
sr <- c()
for (name in athlete_list_W_200m){
  a_name[i] <- name
  if (min(athlete200mW[which(athlete200mW$Name == name & athlete200mW$Class == "Seniors"), "Result"]) == Inf){
    result[i] <- 0
  }
  else{
    result[i] <- (25.74 - min(athlete200mW[which(athlete200mW$Name == name & athlete200mW$Class == "Seniors"), "Result"]))/(25.74 - WR200mWomen)
  }
  print(result[i])
  class[i] <- "Seniors"
  wr[i] <- 1
  sr[i] <- (25.74 - SR200mWomen)/(25.74-WR200mWomen)
  i <- i + 1
}
i <- 1
a_nameJ <- c()
resultJ <- c()
classJ <- c()
wrJ <- c()
srJ <- c()
for (name in athlete_list_W_200m){
  a_nameJ[i] <- name
  if (min(athlete200mW[which(athlete200mW$Name == name & athlete200mW$Class == "Juniors"), "Result"]) == Inf){
    resultJ[i] <- 0
  }
  else{
    resultJ[i] <- (25.74 - min(athlete200mW[which(athlete200mW$Name == name & athlete200mW$Class == "Juniors"), "Result"]))/(25.74 - WR200mWomenJ)
  }
  print(result[i])
  classJ[i] <- "Juniors"
  wrJ[i] <- 1
  srJ[i] <- (25.74 - SR200mWomenJ)/(25.74-WR200mWomenJ)
  
  i <- i + 1
}
i <- 1
a_nameY <- c()
resultY <- c()
classY <- c()
wrY <- c()
srY <- c()
for (name in athlete_list_W_200m){
  a_nameY[i] <- name
  if (min(athlete200mW[which(athlete200mW$Name == name & athlete200mW$Class == "Youth"), "Result"]) == Inf){
    resultY[i] <- 0
  }
  else{
    resultY[i] <- (25.74 - min(athlete200mW[which(athlete200mW$Name == name & athlete200mW$Class == "Youth"), "Result"]))/(25.74 - WR200mWomenY)
  }
  classY[i] <- "Youth"
  wrY[i] <- 1
  srY[i] <- (25.74 - SR200mWomenY)/(25.74-WR200mWomenY)
  i <- i + 1
}
i <- 1
radar_frameS <- data.frame(Name = a_name,
                           Result = result, 
                           Class = class, 
                           WR = wr,
                           SR = sr)
radar_frameJ <- data.frame(Name = a_nameJ,
                           Result = resultJ, 
                           Class = classJ, 
                           WR = wrJ,
                           SR = srJ)
radar_frameY <- data.frame(Name = a_nameY,
                           Result = resultY, 
                           Class = classY, 
                           WR = wrY,
                           SR = srY)

radar_frame200W <- merge(x = merge(x = radar_frameS, y = radar_frameJ, by = "Name"), y = radar_frameY, by = "Name")
radar_frame200W

radar_frame200W <- subset(radar_frame200W, select = -c(Class.x, WR.x, SR.x, Class.y, WR.y, SR.y, Class, WR, SR))

colnames(radar_frame200W) <- c("Name", "Seniors", "Juniors", "Youth")

radar_frame200W[(length(radar_frame200W$Name) + 1), ] <- c("World Record in the class", 1,1,1)
radar_frame200W[(length(radar_frame200W$Name) + 1), ] <- c("Fictious baseline", 0,0,0)
radar_frame200W[(length(radar_frame200W$Name) + 1), ] <- c("Swiss Record in the class", (25.74 - SR200mWomen)/(25.74-WR200mWomen), (25.74- SR200mWomenJ)/(25.74-WR200mWomenJ), (25.74- SR200mWomenY)/(25.74-WR200mWomenY))
radar_frame200W$Seniors <- as.numeric(radar_frame200W$Seniors)
radar_frame200W$Juniors <- as.numeric(radar_frame200W$Juniors)
radar_frame200W$Youth <- as.numeric(radar_frame200W$Youth)
radar_frame200W
```

```{r plot200mW2MK, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frame200W[which(radar_frame200W$Name == "Mujinga Kambundji" | radar_frame200W$Name == "World Record in the class"
                              | radar_frame200W$Name == "Fictious baseline" | radar_frame200W$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frame200W[which(radar_frame200W$Name == "Mujinga Kambundji" | radar_frame200W$Name == "World Record in the class"
                                             | radar_frame200W$Name == "Fictious baseline" | radar_frame200W$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=1, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)

```

```{r plot200mW2SA, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frame200W[which(radar_frame200W$Name == "Sarah Atcho" | radar_frame200W$Name == "World Record in the class"
                              | radar_frame200W$Name == "Fictious baseline" | radar_frame200W$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frame200W[which(radar_frame200W$Name == "Sarah Atcho" | radar_frame200W$Name == "World Record in the class"
                                             | radar_frame200W$Name == "Fictious baseline" | radar_frame200W$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=1, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

**NB**: it is important to understand that, sometimes, athletes with good final results have 0% in one or two classes. This is not due to the fact that they were extremely bad at one point of their career. In fact, we can explain this problem with the lack of records. It could be that the athlete gained the chance to participate in one of the major competitions in a Senior age or that the athlete is still in Youth/Junior age and he has no records in the Senior class. 

```{r plot200mW3, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
athlete200mW[, "Difference_8"] <- athlete200mW$Result - athlete200mW$Top_8

pKabumbundji <- ggplot(data = athlete200mW)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .15) +
  geom_histogram(data = athlete200mW[which(athlete200mW$Name == "Mujinga Kambundji"), ],
                 aes(x = Difference_8), binwidth = 0.15) +
  scale_fill_manual(name= "Mujinga Kambundji", values = heat.colors(4))   +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

pAtcho <- ggplot(data = athlete200mW)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .15) +
  geom_histogram(data = athlete200mW[which(athlete200mW$Name == "Sarah Atcho"), ],
                 aes(x = Difference_8), binwidth = 0.15) +
  scale_fill_manual(name = "Sarah Atcho", values = heat.colors(4))   +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  ) +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

grid.arrange(pKabumbundji, pAtcho, ncol=1, nrow = 2)
```

**NB**: in this case the more the black bars are on the left, the better the result of the athlete.

We believe that in this case the general situation is very positive. In fact the Federation can count on one of the fastest women on earth, and together with her there are many other athletes that are extremely performing. In conclusion, we suggest that the only strategy here could be maintain the investments, developing Youth and Juniors athletes for a bright future in the discipline 

## 3.5 Men's 400m

As we can see from the scatter plot the 400m is a discipline relatively new for Swiss Athletes since the first record was in the 90s. The scatter plot divides each class using different colours, a linear regression per group is shown to let the readers better understand the global trends.

```{r 400mMplotEDA, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
suimale400m <- olympics[which(olympics$Discipline == "400m"), ]
suimale400m <- suimale400m[which(suimale400m$Gender == "Men"), ]
suimale400m <- suimale400m[which(suimale400m$Class != "Under 23"), ]
suimale400m <- suimale400m[which(suimale400m$Nationality == "SUI"), ]
suimale400m <- suimale400m[which(suimale400m$Result != ""), ]
suimale400m[, "Result"] <- as.double(suimale400m$Result)
# summary(suimale400m$Result)
# 
# fit <- lm(data = suimale400m, 
#           formula = Result ~ Year)
# summary(fit)

p <- ggplot(data = suimale400m,
            aes(x = Year, y = Result, colour = Class)) +
  geom_point() +
  geom_smooth(method = "lm")

ggplotly(p)
```

In the graph we can see how the results are not equally distributed in the years, having long periods without records. However, we think that in the last two years a lot of Swiss athletes have become more and more competitive, being largely under the 46s. In particular, a Swiss athlete that is doing very well is Ricky Petrucciani, silver medal in the European Championship in 2022 and gold medal in the Under 23 European Championship in 2021. 

Our question is “how far are we from records?”. To answer, we need further analysis

We decided to show the analysis of two runners, Ricky Petrucciani and Lionel Spitz.

```{r script400mM, echo=FALSE, include = FALSE}
sprint400mMan <- olympics[which(olympics$Discipline == "400m"), ]
sprint400mMan <- sprint400mMan[which(sprint400mMan$Year>=1990), ]
sprint400mMan <- sprint400mMan[which(sprint400mMan$Competition == "Olympic Games" 
                                         | sprint400mMan$Competition == "World Championships"), ]
sprint400mMan <- sprint400mMan[which(sprint400mMan$Gender == "Men"), ]
sprint400mMan <- sprint400mMan[which(sprint400mMan$Class == "Seniors"), ]
sprint400mMan <- sprint400mMan[which(sprint400mMan$Result != ""), ]
# sprint400mMan <- sprint400mMan[which(sprint400mMan$Medal != ""), ]
sprint400mMan[, "Result"] <- as.double(sprint400mMan$Result)
sprint400mMan <- sprint400mMan[which(!is.na(sprint400mMan$Result)), ]
summary(sprint400mMan$Result[which(!is.na(sprint400mMan$Result))])

sprint400mManJunior <- olympics[which(olympics$Discipline == "400m"), ]
sprint400mManJunior <- sprint400mManJunior[which(sprint400mManJunior$Year>=1990), ]
sprint400mManJunior <- sprint400mManJunior[which(sprint400mManJunior$Competition == "World Junior Championships"), ]
sprint400mManJunior <- sprint400mManJunior[which(sprint400mManJunior$Gender == "Men"), ]
sprint400mManJunior <- sprint400mManJunior[which(sprint400mManJunior$Class == "Juniors"), ]
sprint400mManJunior <- sprint400mManJunior[which(sprint400mManJunior$Result != ""), ]
# sprint400mManJunior <- sprint400mManJunior[which(sprint400mManJunior$Medal != ""), ]
sprint400mManJunior[, "Result"] <- as.double(sprint400mManJunior$Result)
sprint400mManJunior <- sprint400mManJunior[which(!is.na(sprint400mManJunior$Result)), ]
summary(sprint400mManJunior$Result)

sprint400mManYouth <- olympics[which(olympics$Discipline == "400m"), ]
sprint400mManYouth <- sprint400mManYouth[which(sprint400mManYouth$Year>=1990), ]
sprint400mManYouth <- sprint400mManYouth[which(sprint400mManYouth$Competition == "World Youth Championships"
                                                   | sprint400mManYouth$Competition == "Youth Olympic Games"), ]
sprint400mManYouth <- sprint400mManYouth[which(sprint400mManYouth$Gender == "Men"), ]
sprint400mManYouth <- sprint400mManYouth[which(sprint400mManYouth$Class == "Youth"), ]
sprint400mManYouth <- sprint400mManYouth[which(sprint400mManYouth$Result != ""), ]
# sprint400mManYouth <- sprint400mManYouth[which(sprint400mManYouth$Medal != ""), ]
sprint400mManYouth[, "Result"] <- as.double(sprint400mManYouth$Result)
summary(sprint400mManYouth$Result)


i <- 2
j <- 2
k <- 2
vector_senior_year <- c(min(sprint400mMan[which(sprint400mMan$Year == 2000), "Result"]))
vector_junior_year <- c(min(sprint400mManJunior[which(sprint400mManJunior$Year == 2000), "Result"]))
vector_youth_year <- c(min(sprint400mManYouth[which(sprint400mManYouth$Year == 2001), "Result"]))
for (year in 2001:2022){
  vector_senior_year[i] <- min(c(min(sprint400mMan[which(sprint400mMan$Year == year), "Result"]), vector_senior_year[i-1]))
  i <- i + 1
  vector_junior_year[j] <- min(c(min(sprint400mManJunior[which(sprint400mManJunior$Year == year), "Result"]), vector_junior_year[j-1]))
  j <- j + 1
  vector_youth_year[k] <- min(c(min(sprint400mManYouth[which(sprint400mManYouth$Year == year), "Result"]), vector_youth_year[k-1]))
  k <- k + 1
}

i <- 2
j <- 2
k <- 2
vector_senior_year_8 <- c(sprint400mMan[which(sprint400mMan$Year == 2000 & sprint400mMan$Rank == "8"), "Result"])
vector_junior_year_8 <- c(sprint400mManJunior[which(sprint400mManJunior$Year == 2000 & sprint400mManJunior$Rank == "8"), "Result"])
vector_youth_year_8 <- c(sprint400mManYouth[which(sprint400mManYouth$Year == 2003 & sprint400mManYouth$Rank == "8"), "Result"])
for (year in 2001:2022){
  vector_senior_year_8[i] <- min(c(sprint400mMan[which(sprint400mMan$Year == year & sprint400mMan$Rank == "8"), "Result"], vector_senior_year_8[i-1]))
  i <- i + 1
  vector_junior_year_8[j] <- min(c(sprint400mManJunior[which(sprint400mManJunior$Year == year & sprint400mManJunior$Rank == "8"), "Result"], vector_junior_year_8[j-1]))
  j <- j + 1
  vector_youth_year_8[k] <- min(c(sprint400mManYouth[which(sprint400mManYouth$Year == year & sprint400mManYouth$Rank == "8"), "Result"], vector_youth_year_8[k-1]))
  k <- k + 1
}

vector_best_year <- c(vector_senior_year, vector_junior_year, vector_youth_year)
vector_8_year <- c(vector_senior_year_8, vector_junior_year_8, vector_youth_year_8)
v1 <- 2000:2022
years <- c(v1,v1,v1)
years
vector_class <- c()
vector_class[1:23] <- "Seniors"
vector_class[24:46] <- "Juniors"
vector_class[47:69] <- "Youth"
vector_class

df_result <- data.frame(Year = years,
                        Top_8 = vector_8_year,
                        Top_1 = vector_best_year,
                        Class = vector_class)
df_result

switzerland_athlete_Men_400m <- olympics[which(olympics$Discipline == "400m"), ]
switzerland_athlete_Men_400m <- switzerland_athlete_Men_400m[which(switzerland_athlete_Men_400m$Year>=2000), ]
switzerland_athlete_Men_400m <- switzerland_athlete_Men_400m[which(switzerland_athlete_Men_400m$Gender == "Men"), ]
switzerland_athlete_Men_400m <- switzerland_athlete_Men_400m[which(switzerland_athlete_Men_400m$Nationality == "SUI"), ]
switzerland_athlete_Men_400m <- switzerland_athlete_Men_400m[which(switzerland_athlete_Men_400m$Result != ""), ]
# sprint400mMan <- sprint400mMan[which(sprint400mMan$Medal != ""), ]
switzerland_athlete_Men_400m[, "Result"] <- as.double(switzerland_athlete_Men_400m$Result)
summary(switzerland_athlete_Men_400m$Result)
table(switzerland_athlete_Men_400m$Person)


switzerland_athlete_Men_400m <- data.frame(Name = switzerland_athlete_Men_400m$Person,
                                             Result = switzerland_athlete_Men_400m$Result,
                                             Year = switzerland_athlete_Men_400m$Year,
                                             Class = switzerland_athlete_Men_400m$Class)

switzerland_athlete_Men_400m <- merge(x = switzerland_athlete_Men_400m,
                                        y = df_result, 
                                        by = c("Year", "Class")
)
switzerland_athlete_Men_400m


# Da fare in shiny con un input sul nome dell'atleta.

athlete_list_M_400m <- as.list(unique(switzerland_athlete_Men_400m$Name))
athlete_result <- c()
athlete_name <- c()
athlete_year <- c()
athlete_class <- c()
top8 <- c()
top1 <- c()
i = 1
for (name in athlete_list_M_400m){
  print(name)
  for (year in min(switzerland_athlete_Men_400m$Year):max(switzerland_athlete_Men_400m$Year)){
    print(year)
    if(length(switzerland_athlete_Men_400m[which(switzerland_athlete_Men_400m$Name == name 
                                                   & switzerland_athlete_Men_400m$Year == year), "Result"] != 0)){
      athlete_name[i] <- name
      
      athlete_result[i] <- min(switzerland_athlete_Men_400m[which(switzerland_athlete_Men_400m$Name == name
                                                                    & switzerland_athlete_Men_400m$Year == year),"Result"])
      athlete_year[i] <- year
      athlete_class[i] <- switzerland_athlete_Men_400m[which(switzerland_athlete_Men_400m$Result == athlete_result[i] &
                                                                 switzerland_athlete_Men_400m$Name == name & 
                                                                 switzerland_athlete_Men_400m$Year == year),"Class"]
      top1[i] <- switzerland_athlete_Men_400m[which(switzerland_athlete_Men_400m$Result == athlete_result[i] &
                                                        switzerland_athlete_Men_400m$Name == name & 
                                                        switzerland_athlete_Men_400m$Year == year),"Top_1"]
      print(top1[i])
      top8[i] <- switzerland_athlete_Men_400m[which(switzerland_athlete_Men_400m$Result == athlete_result[i] &
                                                        switzerland_athlete_Men_400m$Name == name & 
                                                        switzerland_athlete_Men_400m$Year == year),"Top_8"]
      i <- i + 1
    }
  }
}
athlete400mM <- data.frame(Year = athlete_year,
                           Name = athlete_name,
                           Result = athlete_result,
                           Class = athlete_class,
                           Top_8 = top8,
                           Top_1 = top1)
athlete400mM
```

```{r plot400mM1, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
pPetrucciani <- ggplot(data = athlete400mM[which(athlete400mM$Name == "Ricky Petrucciani"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Ricky Petrucciani") +
  xlab("Year") + 
  ylab("Time") 

pSpitz <- ggplot(data = athlete400mM[which(athlete400mM$Name == "Lionel Spitz"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Lionel Spitz") +
  xlab("Year") + 
  ylab("Time") 

library(gridExtra)

grid.arrange(pPetrucciani, pSpitz, ncol=1, nrow = 2)
```

The first graph is about the difference from the best performance of an athlete against the best results. The range of top results is represented by a blue coloured band in which the upper bound is the best time for a runner that finished the competition in the 8th palace and the lower bound is the best time of the winner.

As before, we want to add two other graphs to show more information. The first one is the radar chart. As we can see Ricky Petrucciani is the Swiss record man in Seniors and Juniors class (even though his best result is in Under 23). In the second graph we are showing the frequency of distance from the best result of a runner that ended the run in 8th place. The black blocks represent the athlete count. The intervals have a width of 0.25s.

```{r radarchart400mM, echo=FALSE, include =FALSE, warning=FALSE, message=FALSE}
WR400mMen <- min(sprint400mMan$Result)
WR400mMenJ <- min(sprint400mManJunior$Result)
WR400mMenY <- min(sprint400mManYouth$Result)

SR400mMen <- min(athlete400mM$Result[which(athlete400mM$Class == "Seniors")])
SR400mMenJ <- min(athlete400mM$Result[which(athlete400mM$Class == "Juniors")])
SR400mMenY <- min(athlete400mM$Result[which(athlete400mM$Class == "Youth")])

i <- 1
a_name <- c()
result <- c()
class <- c()
wr <- c()
sr <- c()
for (name in athlete_list_M_400m){
  a_name[i] <- name
  if (min(athlete400mM[which(athlete400mM$Name == name & athlete400mM$Class == "Seniors"), "Result"]) == Inf){
    result[i] <- 0
  }
  else{
    result[i] <- (50.97 - min(athlete400mM[which(athlete400mM$Name == name & athlete400mM$Class == "Seniors"), "Result"]))/(50.97 - WR400mMen)
  }
  print(result[i])
  class[i] <- "Seniors"
  wr[i] <- 1
  sr[i] <- (50.97 - SR400mMen)/(50.97-WR400mMen)
  i <- i + 1
}
i <- 1
a_nameJ <- c()
resultJ <- c()
classJ <- c()
wrJ <- c()
srJ <- c()
for (name in athlete_list_M_400m){
  a_nameJ[i] <- name
  if (min(athlete400mM[which(athlete400mM$Name == name & athlete400mM$Class == "Juniors"), "Result"]) == Inf){
    resultJ[i] <- 0
  }
  else{
    resultJ[i] <- (50.97 - min(athlete400mM[which(athlete400mM$Name == name & athlete400mM$Class == "Juniors"), "Result"]))/(50.97 - WR400mMenJ)
  }
  print(result[i])
  classJ[i] <- "Juniors"
  wrJ[i] <- 1
  srJ[i] <- (50.97 - SR400mMenJ)/(50.97-WR400mMenJ)
  
  i <- i + 1
}
i <- 1
a_nameY <- c()
resultY <- c()
classY <- c()
wrY <- c()
srY <- c()
for (name in athlete_list_M_400m){
  a_nameY[i] <- name
  if (min(athlete400mM[which(athlete400mM$Name == name & athlete400mM$Class == "Youth"), "Result"]) == Inf){
    resultY[i] <- 0
  }
  else{
    resultY[i] <- (50.97 - min(athlete400mM[which(athlete400mM$Name == name & athlete400mM$Class == "Youth"), "Result"]))/(50.97 - WR400mMenY)
  }
  classY[i] <- "Youth"
  wrY[i] <- 1
  srY[i] <- (50.97 - SR400mMenY)/(50.97-WR400mMenY)
  i <- i + 1
}
i <- 1
radar_frameS <- data.frame(Name = a_name,
                           Result = result, 
                           Class = class, 
                           WR = wr,
                           SR = sr)
radar_frameJ <- data.frame(Name = a_nameJ,
                           Result = resultJ, 
                           Class = classJ, 
                           WR = wrJ,
                           SR = srJ)
radar_frameY <- data.frame(Name = a_nameY,
                           Result = resultY, 
                           Class = classY, 
                           WR = wrY,
                           SR = srY)

radar_frame400 <- merge(x = merge(x = radar_frameS, y = radar_frameJ, by = "Name"), y = radar_frameY, by = "Name")

radar_frame400 <- subset(radar_frame400, select = -c(Class.x, WR.x, SR.x, Class.y, WR.y, SR.y, Class, WR, SR))

colnames(radar_frame400) <- c("Name", "Seniors", "Juniors", "Youth")

radar_frame400[(length(radar_frame400$Name) + 1), ] <- c("World Record in the class", 1,1,1)
radar_frame400[(length(radar_frame400$Name) + 1), ] <- c("Fictious baseline", 0,0,0)
radar_frame400[(length(radar_frame400$Name) + 1), ] <- c("Swiss Record in the class", (50.97 - SR400mMen)/(50.97-WR400mMen), (50.97 - SR400mMenJ)/(50.97-WR400mMenJ), (50.97 - SR400mMenY)/(50.97-WR400mMenY))
radar_frame400$Seniors <- as.numeric(radar_frame400$Seniors)
radar_frame400$Juniors <- as.numeric(radar_frame400$Juniors)
radar_frame400$Youth <- as.numeric(radar_frame400$Youth)
radar_frame400
```

```{r plot400mMRP, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frame400[which(radar_frame400$Name == "Ricky Petrucciani" | radar_frame400$Name == "World Record in the class"
                                | radar_frame400$Name == "Fictious baseline" | radar_frame400$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frame400[which(radar_frame400$Name == "Ricky Petrucciani" | radar_frame400$Name == "World Record in the class"
                                               | radar_frame400$Name == "Fictious baseline" | radar_frame400$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=0.75, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

```{r plot400mM2LS, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frame400[which(radar_frame400$Name == "Lionel Spitz" | radar_frame400$Name == "World Record in the class"
                                | radar_frame400$Name == "Fictious baseline" | radar_frame400$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frame400[which(radar_frame400$Name == "Lionel Spitz" | radar_frame400$Name == "World Record in the class"
                                               | radar_frame400$Name == "Fictious baseline" | radar_frame400$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=0.75, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

**NB**: it is important to understand that, sometimes, athletes with good final results have 0% in one or two classes. This is not due to the fact that they were extremely bad at one point of their career. In fact, we can explain this problem with the lack of records. It could be that the athlete gained the chance to participate in one of the major competitions in a Senior age or that the athlete is still in Youth/Junior age and he has no records in the Senior class. 

```{r plot400mM3, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
athlete400mM[, "Difference_8"] <- athlete400mM$Result - athlete400mM$Top_8

pPetrucciani <- ggplot(data = athlete400mM)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .25) +
  geom_histogram(data = athlete400mM[which(athlete400mM$Name == "Ricky Petrucciani"), ],
                 aes(x = Difference_8), binwidth = .25) +
  scale_fill_manual(name = "Ricky Petrucciani", values = heat.colors(4)) +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

pSpitz <- ggplot(data = athlete400mM)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .25) +
  geom_histogram(data = athlete400mM[which(athlete400mM$Name == "Lionel Spitz"), ],
                 aes(x = Difference_8), binwidth = .25) +
  scale_fill_manual(name = "Lionel Spitz", values = heat.colors(4)) +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  ) +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

grid.arrange(pPetrucciani, pSpitz, ncol=1, nrow = 2)
```

**NB**: in this case the more the black bars are on the left, the better the result of the athlete.

Swiss athletes are becoming more and more performant in the discipline. However, even if Petrucciani won some medals during his career, we are quite far from the world record (2 seconds). Investing in athlete development could be a solution. Unfortunately, there is just a little data and, more importantly, concentrated in specific periods of time. We, therefore, suggest waiting to invest in the 400m, giving precedence to other disciplines. Our prevision is that in 5 years we can conduct a more deep analysis, hoping to maintain the last two years trend. 

## 3.6 Women's 400m

400m is a category very little populated in Switzerland. In particular, we do not have enough data in any class. We will then show just a little information. We decided to use a simple scatterplot in which every class has its own colour. We opted for showing the linear regression line. This operation does not mean we are trying to forecast anything, we just believe that in this way the reader can have a clearer idea of the global trend.

```{r 400mWplotEDA, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
suifemale400m <- olympics[which(olympics$Discipline == "400m"), ]
suifemale400m <- suifemale400m[which(suifemale400m$Gender == "Women"), ]
suifemale400m <- suifemale400m[which(suifemale400m$Class != "Under 23"), ]
suifemale400m <- suifemale400m[which(suifemale400m$Nationality == "SUI"), ]
suifemale400m <- suifemale400m[which(suifemale400m$Result != ""), ]
suifemale400m[, "Result"] <- as.double(suifemale400m$Result)
# summary(suifemale400m$Result)
# 
# #not enough records
# fit <- lm(data = suifemale400m, 
#           formula = Result ~ Year)
# summary(fit)

p <- ggplot(data = suifemale400m,
            aes(x = Year, y = Result, colour = Class)) +
  geom_point() +
  geom_smooth(method = "lm")

ggplotly(p)
```

The situation is quite strange, there are more records in the Juniors and Youth class than in the Seniors. The athlete that holds the Swiss record is Lea Sprunger. She won two gold medals in her career, in 400m indoor and 400m hurdles. However, she could not achieve a significant result in the 400m (our focus). 

As usual, we want now to answer the question “how far are we from records?”. In order to do it, we need to analyse Swiss top athletes in detail. 

We decided to show the analysis of three important runners, Giulia Senn and Rachel Pellaud. 

```{r script400mW, echo=FALSE, include = FALSE}
sprint400mwoman <- olympics[which(olympics$Discipline == "400m"), ]
sprint400mwoman <- sprint400mwoman[which(sprint400mwoman$Year>=1990), ]
sprint400mwoman <- sprint400mwoman[which(sprint400mwoman$Competition == "Olympic Games" 
                                     | sprint400mwoman$Competition == "World Championships"), ]
sprint400mwoman <- sprint400mwoman[which(sprint400mwoman$Gender == "Women"), ]
sprint400mwoman <- sprint400mwoman[which(sprint400mwoman$Class == "Seniors"), ]
sprint400mwoman <- sprint400mwoman[which(sprint400mwoman$Result != ""), ]
# sprint400mwoman <- sprint400mwoman[which(sprint400mwoman$Medal != ""), ]
sprint400mwoman[, "Result"] <- as.double(sprint400mwoman$Result)
sprint400mwoman <- sprint400mwoman[which(!is.na(sprint400mwoman$Result)), ]
summary(sprint400mwoman$Result[which(!is.na(sprint400mwoman$Result))])

sprint400mWomanJunior <- olympics[which(olympics$Discipline == "400m"), ]
sprint400mWomanJunior <- sprint400mWomanJunior[which(sprint400mWomanJunior$Year>=1990), ]
sprint400mWomanJunior <- sprint400mWomanJunior[which(sprint400mWomanJunior$Competition == "World Junior Championships"), ]
sprint400mWomanJunior <- sprint400mWomanJunior[which(sprint400mWomanJunior$Gender == "Women"), ]
sprint400mWomanJunior <- sprint400mWomanJunior[which(sprint400mWomanJunior$Class == "Juniors"), ]
sprint400mWomanJunior <- sprint400mWomanJunior[which(sprint400mWomanJunior$Result != ""), ]
# sprint400mWomanJunior <- sprint400mWomanJunior[which(sprint400mWomanJunior$Medal != ""), ]
sprint400mWomanJunior[, "Result"] <- as.double(sprint400mWomanJunior$Result)
sprint400mWomanJunior <- sprint400mWomanJunior[which(!is.na(sprint400mWomanJunior$Result)), ]
summary(sprint400mWomanJunior$Result)

sprint400mWomanYouth <- olympics[which(olympics$Discipline == "400m"), ]
sprint400mWomanYouth <- sprint400mWomanYouth[which(sprint400mWomanYouth$Year>=1990), ]
sprint400mWomanYouth <- sprint400mWomanYouth[which(sprint400mWomanYouth$Competition == "World Youth Championships"
                                               | sprint400mWomanYouth$Competition == "Youth Olympic Games"), ]
sprint400mWomanYouth <- sprint400mWomanYouth[which(sprint400mWomanYouth$Gender == "Women"), ]
sprint400mWomanYouth <- sprint400mWomanYouth[which(sprint400mWomanYouth$Class == "Youth"), ]
sprint400mWomanYouth <- sprint400mWomanYouth[which(sprint400mWomanYouth$Result != ""), ]
# sprint400mManYouth <- sprint400mManYouth[which(sprint400mManYouth$Medal != ""), ]
sprint400mWomanYouth[, "Result"] <- as.double(sprint400mWomanYouth$Result)
sprint400mWomanYouth <- sprint400mWomanYouth[which(!is.na(sprint400mWomanYouth$Result)), ]
summary(sprint400mWomanYouth$Result)


i <- 2
j <- 2
k <- 2
vector_senior_year <- c(min(sprint400mwoman[which(sprint400mwoman$Year == 2000), "Result"]))
vector_junior_year <- c(min(sprint400mWomanJunior[which(sprint400mWomanJunior$Year == 2000), "Result"]))
vector_youth_year <- c(min(sprint400mWomanYouth[which(sprint400mWomanYouth$Year == 2001), "Result"]))
for (year in 2001:2022){
  vector_senior_year[i] <- min(c(min(sprint400mwoman[which(sprint400mwoman$Year == year), "Result"]), vector_senior_year[i-1]))
  i <- i + 1
  vector_junior_year[j] <- min(c(min(sprint400mWomanJunior[which(sprint400mWomanJunior$Year == year), "Result"]), vector_junior_year[j-1]))
  j <- j + 1
  vector_youth_year[k] <- min(c(min(sprint400mWomanYouth[which(sprint400mWomanYouth$Year == year), "Result"]), vector_youth_year[k-1]))
  k <- k + 1
}

i <- 2
j <- 2
k <- 2
vector_senior_year_8 <- c(sprint400mwoman[which(sprint400mwoman$Year == 2000 & sprint400mwoman$Rank == "8"), "Result"])
vector_junior_year_8 <- c(sprint400mWomanJunior[which(sprint400mWomanJunior$Year == 2000 & sprint400mWomanJunior$Rank == "8"), "Result"])
vector_youth_year_8 <- c(sprint400mWomanYouth[which(sprint400mWomanYouth$Year == 2003 & sprint400mWomanYouth$Rank == "8"), "Result"])
for (year in 2001:2022){
  vector_senior_year_8[i] <- min(c(sprint400mwoman[which(sprint400mwoman$Year == year & sprint400mwoman$Rank == "8"), "Result"], vector_senior_year_8[i-1]))
  i <- i + 1
  vector_junior_year_8[j] <- min(c(sprint400mWomanJunior[which(sprint400mWomanJunior$Year == year & sprint400mWomanJunior$Rank == "8"), "Result"], vector_junior_year_8[j-1]))
  j <- j + 1
  vector_youth_year_8[k] <- min(c(sprint400mWomanYouth[which(sprint400mWomanYouth$Year == year & sprint400mWomanYouth$Rank == "8"), "Result"], vector_youth_year_8[k-1]))
  k <- k + 1
}

vector_best_year <- c(vector_senior_year, vector_junior_year, vector_youth_year)
vector_8_year <- c(vector_senior_year_8, vector_junior_year_8, vector_youth_year_8)
v1 <- 2000:2022
years <- c(v1,v1,v1)
years
vector_class <- c()
vector_class[1:23] <- "Seniors"
vector_class[24:46] <- "Juniors"
vector_class[47:69] <- "Youth"
vector_class

df_result <- data.frame(Year = years,
                        Top_8 = vector_8_year,
                        Top_1 = vector_best_year,
                        Class = vector_class)
df_result

switzerland_athlete_Women_400m <- olympics[which(olympics$Discipline == "400m"), ]
switzerland_athlete_Women_400m <- switzerland_athlete_Women_400m[which(switzerland_athlete_Women_400m$Year>=2000), ]
switzerland_athlete_Women_400m <- switzerland_athlete_Women_400m[which(switzerland_athlete_Women_400m$Gender == "Women"), ]
switzerland_athlete_Women_400m <- switzerland_athlete_Women_400m[which(switzerland_athlete_Women_400m$Nationality == "SUI"), ]
switzerland_athlete_Women_400m <- switzerland_athlete_Women_400m[which(switzerland_athlete_Women_400m$Result != ""), ]
# sprint400mMan <- sprint400mMan[which(sprint400mMan$Medal != ""), ]
switzerland_athlete_Women_400m[, "Result"] <- as.double(switzerland_athlete_Women_400m$Result)
summary(switzerland_athlete_Women_400m$Result)
table(switzerland_athlete_Women_400m$Person)


switzerland_athlete_Women_400m <- data.frame(Name = switzerland_athlete_Women_400m$Person,
                                           Result = switzerland_athlete_Women_400m$Result,
                                           Year = switzerland_athlete_Women_400m$Year,
                                           Class = switzerland_athlete_Women_400m$Class)

switzerland_athlete_Women_400m <- merge(x = switzerland_athlete_Women_400m,
                                      y = df_result, 
                                      by = c("Year", "Class")
)
switzerland_athlete_Women_400m


# Da fare in shiny con un input sul nome dell'atleta.

athlete_list_W_400m <- as.list(unique(switzerland_athlete_Women_400m$Name))
athlete_result <- c()
athlete_name <- c()
athlete_year <- c()
athlete_class <- c()
top8 <- c()
top1 <- c()
i = 1
for (name in athlete_list_W_400m){
  print(name)
  for (year in min(switzerland_athlete_Women_400m$Year):max(switzerland_athlete_Women_400m$Year)){
    print(year)
    if(length(switzerland_athlete_Women_400m[which(switzerland_athlete_Women_400m$Name == name 
                                                 & switzerland_athlete_Women_400m$Year == year), "Result"] != 0)){
      athlete_name[i] <- name
      
      athlete_result[i] <- min(switzerland_athlete_Women_400m[which(switzerland_athlete_Women_400m$Name == name
                                                                  & switzerland_athlete_Women_400m$Year == year),"Result"])
      athlete_year[i] <- year
      athlete_class[i] <- switzerland_athlete_Women_400m[which(switzerland_athlete_Women_400m$Result == athlete_result[i] &
                                                               switzerland_athlete_Women_400m$Name == name & 
                                                               switzerland_athlete_Women_400m$Year == year),"Class"]
      top1[i] <- switzerland_athlete_Women_400m[which(switzerland_athlete_Women_400m$Result == athlete_result[i] &
                                                      switzerland_athlete_Women_400m$Name == name & 
                                                      switzerland_athlete_Women_400m$Year == year),"Top_1"]
      print(top1[i])
      top8[i] <- switzerland_athlete_Women_400m[which(switzerland_athlete_Women_400m$Result == athlete_result[i] &
                                                      switzerland_athlete_Women_400m$Name == name & 
                                                      switzerland_athlete_Women_400m$Year == year),"Top_8"]
      i <- i + 1
    }
  }
}
athlete400mW <- data.frame(Year = athlete_year,
                           Name = athlete_name,
                           Result = athlete_result,
                           Class = athlete_class,
                           Top_8 = top8,
                           Top_1 = top1)
athlete400mW
```

```{r plot400mW1, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}

pPellaud <- ggplot(data = athlete400mW[which(athlete400mW$Name == "Rachel Pellaud"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Rachel Pellaud") +
  xlab("Year") + 
  ylab("Distance") 

pSenn <- ggplot(data = athlete400mW[which(athlete400mW$Name == "Giulia Senn"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Giulia Senn") +
  xlab("Year") + 
  ylab("Distance") 

library(gridExtra)

grid.arrange(pSenn, pPellaud, ncol=1, nrow = 2)
```

The first graph is about the difference from the best performance of an athlete against the best results. The range of top results is represented by a blue coloured band in which the upper bound is the best time for a runner that finished the competition in the 8th palace and the lower bound is the best time of the winner .

In the first graph below, the radar chart, we want to compare two athletes, Lea Sprunger and Giulia Senn. In the next part, we are using a histogram counting the frequency of the difference in time from the minimum result to achieve a certificate. The black blocks represent the athlete count. The intervals have a width of 0.25s. In this case, we focus again on Giulia Senn and Rachel Pellaud. 

```{r radarchart400mW, echo=FALSE, include =FALSE, warning=FALSE, message=FALSE}
WR400mWomen <- min(sprint400mwoman$Result)
WR400mWomenJ <- min(sprint400mWomanJunior$Result)
WR400mWomenY <- min(sprint400mWomanYouth$Result)

SR400mWomen <- min(athlete400mW$Result[which(athlete400mW$Class == "Seniors")])
SR400mWomenJ <- min(athlete400mW$Result[which(athlete400mW$Class == "Juniors")])
SR400mWomenY <- min(athlete400mW$Result[which(athlete400mW$Class == "Youth")])

i <- 1
a_name <- c()
result <- c()
class <- c()
wr <- c()
sr <- c()
for (name in athlete_list_W_400m){
  a_name[i] <- name
  if (min(athlete400mW[which(athlete400mW$Name == name & athlete400mW$Class == "Seniors"), "Result"]) == Inf){
    result[i] <- 0
  }
  else{
    result[i] <- (58.57 - min(athlete400mW[which(athlete400mW$Name == name & athlete400mW$Class == "Seniors"), "Result"]))/(58.57 - WR400mWomen)
  }
  print(result[i])
  class[i] <- "Seniors"
  wr[i] <- 1
  sr[i] <- (58.57 - SR400mWomen)/(58.57-WR400mWomen)
  i <- i + 1
}
i <- 1
a_nameJ <- c()
resultJ <- c()
classJ <- c()
wrJ <- c()
srJ <- c()
for (name in athlete_list_W_400m){
  a_nameJ[i] <- name
  if (min(athlete400mW[which(athlete400mW$Name == name & athlete400mW$Class == "Juniors"), "Result"]) == Inf){
    resultJ[i] <- 0
  }
  else{
    resultJ[i] <- (58.57 - min(athlete400mW[which(athlete400mW$Name == name & athlete400mW$Class == "Juniors"), "Result"]))/(58.57 - WR400mWomenJ)
  }
  print(result[i])
  classJ[i] <- "Juniors"
  wrJ[i] <- 1
  srJ[i] <- (58.57 - SR400mWomenJ)/(58.57-WR400mWomenJ)
  
  i <- i + 1
}
i <- 1
a_nameY <- c()
resultY <- c()
classY <- c()
wrY <- c()
srY <- c()
for (name in athlete_list_W_400m){
  a_nameY[i] <- name
  if (min(athlete400mW[which(athlete400mW$Name == name & athlete400mW$Class == "Youth"), "Result"]) == Inf){
    resultY[i] <- 0
  }
  else{
    resultY[i] <- (58.57 - min(athlete400mW[which(athlete400mW$Name == name & athlete400mW$Class == "Youth"), "Result"]))/(58.57 - WR400mWomenY)
  }
  classY[i] <- "Youth"
  wrY[i] <- 1
  srY[i] <- (58.57 - SR400mWomenY)/(58.57-WR400mWomenY)
  i <- i + 1
}
i <- 1
radar_frameS <- data.frame(Name = a_name,
                           Result = result, 
                           Class = class, 
                           WR = wr,
                           SR = sr)
radar_frameJ <- data.frame(Name = a_nameJ,
                           Result = resultJ, 
                           Class = classJ, 
                           WR = wrJ,
                           SR = srJ)
radar_frameY <- data.frame(Name = a_nameY,
                           Result = resultY, 
                           Class = classY, 
                           WR = wrY,
                           SR = srY)

radar_frame400W <- merge(x = merge(x = radar_frameS, y = radar_frameJ, by = "Name"), y = radar_frameY, by = "Name")
radar_frame400W

radar_frame400W <- subset(radar_frame400W, select = -c(Class.x, WR.x, SR.x, Class.y, WR.y, SR.y, Class, WR, SR))

colnames(radar_frame400W) <- c("Name", "Seniors", "Juniors", "Youth")

radar_frame400W[(length(radar_frame400W$Name) + 1), ] <- c("World Record in the class", 1,1,1)
radar_frame400W[(length(radar_frame400W$Name) + 1), ] <- c("Fictious baseline", 0,0,0)
radar_frame400W[(length(radar_frame400W$Name) + 1), ] <- c("Swiss Record in the class", (58.57 - SR400mWomen)/(58.57-WR400mWomen),
                                                           (58.57- SR400mWomenJ)/(58.57-WR400mWomenJ), 
                                                           (58.57- SR400mWomenY)/(58.57-WR400mWomenY))
radar_frame400W$Seniors <- as.numeric(radar_frame400W$Seniors)
radar_frame400W$Juniors <- as.numeric(radar_frame400W$Juniors)
radar_frame400W$Youth <- as.numeric(radar_frame400W$Youth)
radar_frame400W
```

```{r plot400mWLS, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frame400W[which(radar_frame400W$Name == "Lea Sprunger" | radar_frame400W$Name == "World Record in the class"
                                 | radar_frame400W$Name == "Fictious baseline" | radar_frame400W$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frame400W[which(radar_frame400W$Name == "Lea Sprunger" | radar_frame400W$Name == "World Record in the class" | radar_frame400W$Name == "Fictious baseline" | radar_frame400W$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=1, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

```{r plot400mW2RP, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frame400W[which(radar_frame400W$Name == "Giulia Senn" | radar_frame400W$Name == "World Record in the class"
                                 | radar_frame400W$Name == "Fictious baseline" | radar_frame400W$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frame400W[which(radar_frame400W$Name == "Giulia Senn" | radar_frame400W$Name == "World Record in the class" | radar_frame400W$Name == "Fictious baseline" | radar_frame400W$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=1, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

**NB**: it is important to understand that, sometimes, athletes with good final results have 0% in one or two classes. This is not due to the fact that they were extremely bad at one point of their career. In fact, we can explain this problem with the lack of records. It could be that the athlete gained the chance to participate in one of the major competitions in a Senior age or that the athlete is still in Youth/Junior age and he has no records in the Senior class. 

```{r plot400mW3, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
athlete400mW[, "Difference_8"] <- athlete400mW$Result - athlete400mW$Top_8

pSenn <- ggplot(data = athlete400mW)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .25) +
  geom_histogram(data = athlete400mW[which(athlete400mW$Name == "Giulia Senn"), ],
                 aes(x = Difference_8), binwidth = 0.25) +
  scale_fill_manual(name = "Giulia Senn", values = heat.colors(4))  +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

pPellaud <- ggplot(data = athlete400mW)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .25) +
  geom_histogram(data = athlete400mW[which(athlete400mW$Name == "Rachel Pellaud"), ],
                 aes(x = Difference_8), binwidth = 0.25) +
  scale_fill_manual(name = "Rachel Pellaud", values = heat.colors(4))  +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

library(gridExtra)

grid.arrange(pSenn, pPellaud, ncol=1, nrow = 2)
```

**NB**: in this case the more the black bars are on the left, the better the result of the athlete.

We believe that, at the moment, the amount of work to do in order to improve the results is extremely high. There are no performers that are close to the records. The Swiss Record is 50.52s while the world record is 3s faster (47.60s). In addition we do not have many runners. 
We suggest investing in the discipline in case there are enough funds. If it is not the case, we would suggest maintaining the actual situation.

## 3.7 Men's Long Jump

Long jump is a discipline performed by a lot of Swiss athletes. In particular, in the period between 2000 and today. We used a scatter plot in which every class has its own colour. We show the linear regression line, to let the reader have a clearer idea of the global trend.

```{r LJMplotEDA, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
suimaleLJ <- olympics[which(olympics$Discipline == "Long Jump"), ]
suimaleLJ <- suimaleLJ[which(suimaleLJ$Class != "Under 23"), ]
suimaleLJ <- suimaleLJ[which(suimaleLJ$Gender == "Men"), ]
suimaleLJ <- suimaleLJ[which(suimaleLJ$Nationality == "SUI"), ]
suimaleLJ <- suimaleLJ[which(suimaleLJ$Result != ""), ]
suimaleLJ[, "Result"] <- as.double(suimaleLJ$Result)
# summary(suimaleLJ$Result)
# 
# # no fit
# fit <- lm(data = suimaleLJ, 
#           formula = Result ~ Year)
# summary(fit)

p <- ggplot(data = suimaleLJ,
            aes(x = Year, y = Result, colour = Class)) +
  geom_point() +
  geom_smooth(method = "lm")
ggplotly(p)
```

The majority of Swiss athletes are in the Seniors class. There are just a  few records in the other two classes considered. We believe that, as in the case of men’s 200m, it could be just a case, or it could be a problem in generational change. Among the athletes, the most performing is Simon Ehammer. This long jumper has important palmares in the discipline of decathlon. He started to participate in the long jump competition in 2021, in the Under 23 European Championship, winning the competition. His best result was in 2022 in the World Championship, where he gained the bronze medal. It is interesting that he never participated in any Junior or Youth events. Another interesting athlete is Jarod Biya, who was very performant in Youth and Junior competition. 

As usual, we want now to answer the question “how far are we from records?”. In order to do it, we need to analyse Swiss top athletes in detail. 

We decided to show the analysis of three important runners, Giulia Senn and Rachel Pellaud. 

```{r scriptLJM, echo=FALSE, include = FALSE}
longJumpMan <- olympics[which(olympics$Discipline == "Long Jump"), ]
longJumpMan <- longJumpMan[which(longJumpMan$Year>=1990), ]
longJumpMan <- longJumpMan[which(longJumpMan$Competition == "Olympic Games" 
                                         | longJumpMan$Competition == "World Championships"), ]
longJumpMan <- longJumpMan[which(longJumpMan$Gender == "Men"), ]
longJumpMan <- longJumpMan[which(longJumpMan$Class == "Seniors"), ]
longJumpMan <- longJumpMan[which(longJumpMan$Result != ""), ]
# longJumpMan <- longJumpMan[which(longJumpMan$Medal != ""), ]
longJumpMan[, "Result"] <- as.double(longJumpMan$Result)
longJumpMan <- longJumpMan[which(!is.na(longJumpMan$Result)), ]
summary(longJumpMan$Result[which(!is.na(longJumpMan$Result))])

longJumpManJunior <- olympics[which(olympics$Discipline == "Long Jump"), ]
longJumpManJunior <- longJumpManJunior[which(longJumpManJunior$Year>=1990), ]
longJumpManJunior <- longJumpManJunior[which(longJumpManJunior$Competition == "World Junior Championships"), ]
longJumpManJunior <- longJumpManJunior[which(longJumpManJunior$Gender == "Men"), ]
longJumpManJunior <- longJumpManJunior[which(longJumpManJunior$Class == "Juniors"), ]
longJumpManJunior <- longJumpManJunior[which(longJumpManJunior$Result != ""), ]
# sprint400mWomanJunior <- longJumpManJunior[which(longJumpManJunior$Medal != ""), ]
longJumpManJunior[, "Result"] <- as.double(longJumpManJunior$Result)
longJumpManJunior <- longJumpManJunior[which(!is.na(longJumpManJunior$Result)), ]
summary(longJumpManJunior$Result)

longJumpManYouth <- olympics[which(olympics$Discipline == "Long Jump"), ]
longJumpManYouth <- longJumpManYouth[which(longJumpManYouth$Year>=1990), ]
longJumpManYouth <- longJumpManYouth[which(longJumpManYouth$Competition == "World Youth Championships"
                                                   | longJumpManYouth$Competition == "Youth Olympic Games"), ]
longJumpManYouth <- longJumpManYouth[which(longJumpManYouth$Gender == "Men"), ]
longJumpManYouth <- longJumpManYouth[which(longJumpManYouth$Class == "Youth"), ]
longJumpManYouth <- longJumpManYouth[which(longJumpManYouth$Result != ""), ]
# longJumpManYouth <- longJumpManYouth[which(longJumpManYouth$Medal != ""), ]
longJumpManYouth[, "Result"] <- as.double(longJumpManYouth$Result)
longJumpManYouth <- longJumpManYouth[which(!is.na(longJumpManYouth$Result)), ]
summary(longJumpManYouth$Result)


i <- 2
j <- 2
k <- 2
vector_senior_year <- c(max(longJumpMan[which(longJumpMan$Year == 2000), "Result"]))
vector_junior_year <- c(max(longJumpManJunior[which(longJumpManJunior$Year == 2000), "Result"]))
vector_youth_year <- c(max(longJumpManYouth[which(longJumpManYouth$Year == 2001), "Result"]))
for (year in 2001:2022){
  vector_senior_year[i] <- max(c(max(longJumpMan[which(longJumpMan$Year == year), "Result"]), vector_senior_year[i-1]))
  i <- i + 1
  vector_junior_year[j] <- max(c(max(longJumpManJunior[which(longJumpManJunior$Year == year), "Result"]), vector_junior_year[j-1]))
  j <- j + 1
  vector_youth_year[k] <- max(c(max(longJumpManYouth[which(longJumpManYouth$Year == year), "Result"]), vector_youth_year[k-1]))
  k <- k + 1
}

i <- 2
j <- 2
k <- 2
vector_senior_year_8 <- c(longJumpMan[which(longJumpMan$Year == 2000 & longJumpMan$Rank == "8"), "Result"])
vector_junior_year_8 <- c(longJumpManJunior[which(longJumpManJunior$Year == 2000 & longJumpManJunior$Rank == "8"), "Result"])
vector_youth_year_8 <- c(longJumpManYouth[which(longJumpManYouth$Year == 2001 & longJumpManYouth$Rank == "8"), "Result"])
for (year in 2001:2022){
  vector_senior_year_8[i] <- max(c(longJumpMan[which(longJumpMan$Year == year & longJumpMan$Rank == "8"), "Result"], vector_senior_year_8[i-1]))
  i <- i + 1
  vector_junior_year_8[j] <- max(c(longJumpManJunior[which(longJumpManJunior$Year == year & longJumpManJunior$Rank == "8"), "Result"], vector_junior_year_8[j-1]))
  j <- j + 1
  vector_youth_year_8[k] <- max(c(longJumpManYouth[which(longJumpManYouth$Year == year & longJumpManYouth$Rank == "8"), "Result"], vector_youth_year_8[k-1]))
  k <- k + 1
}

vector_best_year <- c(vector_senior_year, vector_junior_year, vector_youth_year)
vector_8_year <- c(vector_senior_year_8, vector_junior_year_8, vector_youth_year_8)
v1 <- 2000:2022
years <- c(v1,v1,v1)
years
vector_class <- c()
vector_class[1:23] <- "Seniors"
vector_class[24:46] <- "Juniors"
vector_class[47:69] <- "Youth"
vector_class

df_result <- data.frame(Year = years,
                        Top_8 = vector_8_year,
                        Top_1 = vector_best_year,
                        Class = vector_class)
df_result

switzerland_athlete_Men_LongJump <- olympics[which(olympics$Discipline == "Long Jump"), ]
switzerland_athlete_Men_LongJump <- switzerland_athlete_Men_LongJump[which(switzerland_athlete_Men_LongJump$Year>=2000), ]
switzerland_athlete_Men_LongJump <- switzerland_athlete_Men_LongJump[which(switzerland_athlete_Men_LongJump$Gender == "Men"), ]
switzerland_athlete_Men_LongJump <- switzerland_athlete_Men_LongJump[which(switzerland_athlete_Men_LongJump$Nationality == "SUI"), ]
switzerland_athlete_Men_LongJump <- switzerland_athlete_Men_LongJump[which(switzerland_athlete_Men_LongJump$Result != ""), ]
# sprint400mMan <- sprint400mMan[which(sprint400mMan$Medal != ""), ]
switzerland_athlete_Men_LongJump[, "Result"] <- as.double(switzerland_athlete_Men_LongJump$Result)
summary(switzerland_athlete_Men_LongJump$Result)
table(switzerland_athlete_Men_LongJump$Person)


switzerland_athlete_Men_LongJump <- data.frame(Name = switzerland_athlete_Men_LongJump$Person,
                                             Result = switzerland_athlete_Men_LongJump$Result,
                                             Year = switzerland_athlete_Men_LongJump$Year,
                                             Class = switzerland_athlete_Men_LongJump$Class)

switzerland_athlete_Men_LongJump <- merge(x = switzerland_athlete_Men_LongJump,
                                        y = df_result, 
                                        by = c("Year", "Class")
)
switzerland_athlete_Men_LongJump


# Da fare in shiny con un input sul nome dell'atleta.

athlete_list_M_LongJump <- as.list(unique(switzerland_athlete_Men_LongJump$Name))
athlete_result <- c()
athlete_name <- c()
athlete_year <- c()
athlete_class <- c()
top8 <- c()
top1 <- c()
i = 1
for (name in athlete_list_M_LongJump){
  print(name)
  for (year in min(switzerland_athlete_Men_LongJump$Year):max(switzerland_athlete_Men_LongJump$Year)){
    if(length(switzerland_athlete_Men_LongJump[which(switzerland_athlete_Men_LongJump$Name == name 
                                                   & switzerland_athlete_Men_LongJump$Year == year), "Result"] != 0)){
      athlete_name[i] <- name
      
      athlete_result[i] <- max(switzerland_athlete_Men_LongJump[which(switzerland_athlete_Men_LongJump$Name == name
                                                                    & switzerland_athlete_Men_LongJump$Year == year),"Result"])
      athlete_year[i] <- year
      athlete_class[i] <- switzerland_athlete_Men_LongJump[which(switzerland_athlete_Men_LongJump$Result == athlete_result[i] &
                                                                 switzerland_athlete_Men_LongJump$Name == name & 
                                                                 switzerland_athlete_Men_LongJump$Year == year),"Class"]
      top1[i] <- switzerland_athlete_Men_LongJump[which(switzerland_athlete_Men_LongJump$Result == athlete_result[i] &
                                                          switzerland_athlete_Men_LongJump$Name == name & 
                                                          switzerland_athlete_Men_LongJump$Year == year),"Top_1"]
      top8[i] <- switzerland_athlete_Men_LongJump[which(switzerland_athlete_Men_LongJump$Result == athlete_result[i] &
                                                          switzerland_athlete_Men_LongJump$Name == name & 
                                                          switzerland_athlete_Men_LongJump$Year == year),"Top_8"]
      i <- i + 1
    }
  }
}
athleteLongJumpM <- data.frame(Year = athlete_year,
                           Name = athlete_name,
                           Result = athlete_result,
                           Class = athlete_class,
                           Top_8 = top8,
                           Top_1 = top1)
athleteLongJumpM
```

```{r plotLJM1, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}

pEhammer <- ggplot(data = athleteLongJumpM[which(athleteLongJumpM$Name == "Simon Ehammer"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Simon Ehammer") +
  xlab("Year") + 
  ylab("Height")

pBiya <- ggplot(data = athleteLongJumpM[which(athleteLongJumpM$Name == "Jarod Biya"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Jarod Biya") +
  xlab("Year") + 
  ylab("Time")

library(gridExtra)

grid.arrange(pEhammer, pBiya, ncol=1, nrow = 2)
```

The first graph is about the difference from the best performance of an athlete against the best results. The range of top results is represented by a blue coloured band in which the upper bound is the best time for a runner that finished the competition in the 8th palace and the lower bound is the best time of the winner .

As before, we are going to use a radar chart and an histogram to explain differences in time from the top. In particular, in the frequency histogram we are using intervals with width of 0.2. 

```{r radarchartLJM, echo=FALSE, include =FALSE, warning=FALSE, message=FALSE}
WRLJMen <- max(longJumpMan$Result)
WRLJMenJ <- max(longJumpManJunior$Result)
WRLJMenY <- max(longJumpManYouth$Result)

SRLJMen <- max(athleteLongJumpM$Result[which(athleteLongJumpM$Class == "Seniors")])
SRLJMenJ <- max(athleteLongJumpM$Result[which(athleteLongJumpM$Class == "Juniors")])
SRLJMenY <- max(athleteLongJumpM$Result[which(athleteLongJumpM$Class == "Youth")])

i <- 1
a_name <- c()
result <- c()
class <- c()
wr <- c()
sr <- c()
for (name in athlete_list_M_LongJump){
  a_name[i] <- name
  if (max(athleteLongJumpM[which(athleteLongJumpM$Name == name & athleteLongJumpM$Class == "Seniors"), "Result"]) == -Inf){
    result[i] <- 0
  }
  else{
    result[i] <- (max(athleteLongJumpM[which(athleteLongJumpM$Name == name & athleteLongJumpM$Class == "Seniors"), "Result"]))/(WRLJMen)
  }
  print(result[i])
  class[i] <- "Seniors"
  wr[i] <- 1
  sr[i] <- (SRLJMen)/(WRLJMen)
  i <- i + 1
}
i <- 1
a_nameJ <- c()
resultJ <- c()
classJ <- c()
wrJ <- c()
srJ <- c()
for (name in athlete_list_M_LongJump){
  a_nameJ[i] <- name
  if (max(athleteLongJumpM[which(athleteLongJumpM$Name == name & athleteLongJumpM$Class == "Juniors"), "Result"]) == -Inf){
    resultJ[i] <- 0
  }
  else{
    resultJ[i] <- (max(athleteLongJumpM[which(athleteLongJumpM$Name == name & athleteLongJumpM$Class == "Juniors"), "Result"]))/(WRLJMenJ)
  }
  print(result[i])
  classJ[i] <- "Juniors"
  wrJ[i] <- 1
  srJ[i] <- (SRLJMenJ)/(WRLJMenJ)
  
  i <- i + 1
}
i <- 1
a_nameY <- c()
resultY <- c()
classY <- c()
wrY <- c()
srY <- c()
for (name in athlete_list_M_LongJump){
  a_nameY[i] <- name
  if (max(athleteLongJumpM[which(athleteLongJumpM$Name == name & athleteLongJumpM$Class == "Youth"), "Result"]) == -Inf){
    resultY[i] <- 0
  }
  else{
    resultY[i] <- (max(athleteLongJumpM[which(athleteLongJumpM$Name == name & athleteLongJumpM$Class == "Youth"), "Result"]))/(WRLJMenY)
  }
  classY[i] <- "Youth"
  wrY[i] <- 1
  srY[i] <- (SRLJMenY)/(WRLJMenY)
  i <- i + 1
}
i <- 1
radar_frameS <- data.frame(Name = a_name,
                           Result = result, 
                           Class = class, 
                           WR = wr,
                           SR = sr)
radar_frameJ <- data.frame(Name = a_nameJ,
                           Result = resultJ, 
                           Class = classJ, 
                           WR = wrJ,
                           SR = srJ)
radar_frameY <- data.frame(Name = a_nameY,
                           Result = resultY, 
                           Class = classY, 
                           WR = wrY,
                           SR = srY)

radar_frameLJ <- merge(x = merge(x = radar_frameS, y = radar_frameJ, by = "Name"), y = radar_frameY, by = "Name")
radar_frameLJ

radar_frameLJ <- subset(radar_frameLJ, select = -c(Class.x, WR.x, SR.x, Class.y, WR.y, SR.y, Class, WR, SR))

colnames(radar_frameLJ) <- c("Name", "Seniors", "Juniors", "Youth")

radar_frameLJ[(length(radar_frameLJ$Name) + 1), ] <- c("World Record in the class", 1,1,1)
radar_frameLJ[(length(radar_frameLJ$Name) + 1), ] <- c("Fictious baseline", 0,0,0)
radar_frameLJ[(length(radar_frameLJ$Name) + 1), ] <- c("Swiss Record in the class", (SRLJMen)/(WRLJMen),
                                                           (SRLJMenJ)/(WRLJMenJ), 
                                                           (SRLJMenY)/(WRLJMenY))
radar_frameLJ$Seniors <- as.numeric(radar_frameLJ$Seniors)
radar_frameLJ$Juniors <- as.numeric(radar_frameLJ$Juniors)
radar_frameLJ$Youth <- as.numeric(radar_frameLJ$Youth)
radar_frameLJ
```

```{r plotLJM2LS, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frameLJ[which(radar_frameLJ$Name == "Jarod Biya" | radar_frameLJ$Name == "World Record in the class"
                                 | radar_frameLJ$Name == "Fictious baseline" | radar_frameLJ$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5, 1.2, legend=unique(radar_frameLJ[which(radar_frameLJ$Name == "Jarod Biya" | radar_frameLJ$Name == "World Record in the class"
                                                | radar_frameLJ$Name == "Fictious baseline" | radar_frameLJ$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=1, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

```{r plotLJM2RP, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frameLJ[which(radar_frameLJ$Name == "Simon Ehammer" | radar_frameLJ$Name == "World Record in the class"
                                 | radar_frameLJ$Name == "Fictious baseline" | radar_frameLJ$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5, 1.2, legend=unique(radar_frameLJ[which(radar_frameLJ$Name == "Simon Ehammer" | radar_frameLJ$Name == "World Record in the class"
                                                | radar_frameLJ$Name == "Fictious baseline" | radar_frameLJ$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=1, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

**NB**: it is important to understand that, sometimes, athletes with good final results have 0% in one or two classes. This is not due to the fact that they were extremely bad at one point of their career. In fact, we can explain this problem with the lack of records. It could be that the athlete gained the chance to participate in one of the major competitions in a Senior age or that the athlete is still in Youth/Junior age and he has no records in the Senior class. 

```{r plotLJM3, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
athleteLongJumpM[, "Difference_8"] <- athleteLongJumpM$Result - athleteLongJumpM$Top_8

pBiya <- ggplot(data = athleteLongJumpM)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .2) +
  geom_histogram(data = athleteLongJumpM[which(athleteLongJumpM$Name == "Jarod Biya"), ],
                 aes(x = Difference_8), binwidth = 0.2) +
  scale_fill_manual(name = "Jarod Biya", values = heat.colors(4)) +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

pEhammer <- ggplot(data = athleteLongJumpM)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .2) +
  geom_histogram(data = athleteLongJumpM[which(athleteLongJumpM$Name == "Simon Ehammer"), ],
                 aes(x = Difference_8), binwidth = 0.2) +
  scale_fill_manual(name = "Simon Ehammer", values = heat.colors(4)) +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

library(gridExtra)

grid.arrange(pEhammer, pBiya, ncol=1, nrow = 2)
```

**NB**: in this case the more the black bars are on the right, the better the result of the athlete.

We believe in the good work of the Federation in the field. It is very complicated to perform in this discipline, but more and more Swiss athletes are going to challenge the best jumpers in the world. We believe that maintaining the effort in developing athletes could be the path to follow. 
Moreover, we suggest monitoring the Youth and Juniors since there is a lack in numbers. As we were saying above we think that the situation should be analysed more deeply in time. 

## 3.8 Woman's Long Jump

This discipline is performed by a discrete number of athletes in Switzerland. We have used a scatter plot in which every class has its own colour, showing the linear regression line to have a clearer idea of trends and possible patterns.

```{r LJWplotEDA, echo=FALSE, include=TRUE, warning=FALSE, message=FALSE}
suifemaleLJ <- olympics[which(olympics$Discipline == "Long Jump"), ]
suifemaleLJ <- suifemaleLJ[which(suifemaleLJ$Gender == "Women"), ]
suifemaleLJ <- suifemaleLJ[which(suifemaleLJ$Class != "Under 23"), ]
suifemaleLJ <- suifemaleLJ[which(suifemaleLJ$Nationality == "SUI"), ]
suifemaleLJ <- suifemaleLJ[which(suifemaleLJ$Result != ""), ]
suifemaleLJ[, "Result"] <- as.double(suifemaleLJ$Result)
suifemaleLJ <- suifemaleLJ[which(suifemaleLJ$Result>2.1),]
# summary(suimaleLJ$Result)
# 
# # no fit
# fit <- lm(data = suifemaleLJ, 
#           formula = Result ~ Year)
# summary(fit)

p <- ggplot(data = suifemaleLJ,
            aes(x = Year, y = Result, colour = Class)) +
  geom_point() +
  geom_smooth(method = "lm")

ggplotly(p)
```

The situation in women’s long Jump reflects the men's. Lot of records in the Senior class, concentrated in a temporal window that goes from 2000 to today. To be fair, in the last 5 years the number of athletes has decreased rapidly. As before in the Junior and Youth classes there are just a few records, let us wonder if there is some problem in the sector.

As usual, we want now to answer the question “how far are we from records?”. In order to do it, we need to analyse Swiss top athletes in detail. 

The two athletes considered in this case are Irene Pusterla and Annik Kälin. 

```{r scriptLJW, echo=FALSE, include = FALSE}
longJumpWoman <- olympics[which(olympics$Discipline == "Long Jump"), ]
longJumpWoman <- longJumpWoman[which(longJumpWoman$Year>=1990), ]
longJumpWoman <- longJumpWoman[which(longJumpWoman$Competition == "Olympic Games" 
                                 | longJumpWoman$Competition == "World Championships"), ]
longJumpWoman <- longJumpWoman[which(longJumpWoman$Gender == "Women"), ]
longJumpWoman <- longJumpWoman[which(longJumpWoman$Class == "Seniors"), ]
longJumpWoman <- longJumpWoman[which(longJumpWoman$Result != ""), ]
# longJumpWoman <- longJumpWoman[which(longJumpWoman$Medal != ""), ]
longJumpWoman[, "Result"] <- as.double(longJumpWoman$Result)
longJumpWoman <- longJumpWoman[which(!is.na(longJumpWoman$Result)), ]
summary(longJumpWoman$Result[which(!is.na(longJumpWoman$Result))])

longJumpWomanJunior <- olympics[which(olympics$Discipline == "Long Jump"), ]
longJumpWomanJunior <- longJumpWomanJunior[which(longJumpWomanJunior$Year>=1990), ]
longJumpWomanJunior <- longJumpWomanJunior[which(longJumpWomanJunior$Competition == "World Junior Championships"), ]
longJumpWomanJunior <- longJumpWomanJunior[which(longJumpWomanJunior$Gender == "Women"), ]
longJumpWomanJunior <- longJumpWomanJunior[which(longJumpWomanJunior$Class == "Juniors"), ]
longJumpWomanJunior <- longJumpWomanJunior[which(longJumpWomanJunior$Result != ""), ]
# longJumpWomanJunior <- longJumpWomanJunior[which(longJumpWomanJunior$Medal != ""), ]
longJumpWomanJunior[, "Result"] <- as.double(longJumpWomanJunior$Result)
longJumpWomanJunior <- longJumpWomanJunior[which(!is.na(longJumpWomanJunior$Result)), ]
summary(longJumpWomanJunior$Result)

longJumpWomanYouth <- olympics[which(olympics$Discipline == "Long Jump"), ]
longJumpWomanYouth <- longJumpWomanYouth[which(longJumpWomanYouth$Year>=1990), ]
longJumpWomanYouth <- longJumpWomanYouth[which(longJumpWomanYouth$Competition == "World Youth Championships"
                                           | longJumpWomanYouth$Competition == "Youth Olympic Games"), ]
longJumpWomanYouth <- longJumpWomanYouth[which(longJumpWomanYouth$Gender == "Women"), ]
longJumpWomanYouth <- longJumpWomanYouth[which(longJumpWomanYouth$Class == "Youth"), ]
longJumpWomanYouth <- longJumpWomanYouth[which(longJumpWomanYouth$Result != ""), ]
# longJumpWomanYouth <- longJumpWomanYouth[which(longJumpWomanYouth$Medal != ""), ]
longJumpWomanYouth[, "Result"] <- as.double(longJumpWomanYouth$Result)
longJumpWomanYouth <- longJumpWomanYouth[which(!is.na(longJumpWomanYouth$Result)), ]
summary(longJumpWomanYouth$Result)


i <- 2
j <- 2
k <- 2
vector_senior_year <- c(max(longJumpWoman[which(longJumpWoman$Year == 2000), "Result"]))
vector_junior_year <- c(max(longJumpWomanJunior[which(longJumpWomanJunior$Year == 2000), "Result"]))
vector_youth_year <- c(max(longJumpWomanYouth[which(longJumpWomanYouth$Year == 2001), "Result"]))
for (year in 2001:2022){
  vector_senior_year[i] <- max(c(max(longJumpWoman[which(longJumpWoman$Year == year), "Result"]), vector_senior_year[i-1]))
  i <- i + 1
  vector_junior_year[j] <- max(c(max(longJumpWomanJunior[which(longJumpWomanJunior$Year == year), "Result"]), vector_junior_year[j-1]))
  j <- j + 1
  vector_youth_year[k] <- max(c(max(longJumpWomanYouth[which(longJumpWomanYouth$Year == year), "Result"]), vector_youth_year[k-1]))
  k <- k + 1
}

i <- 2
j <- 2
k <- 2
vector_senior_year_8 <- c(longJumpWoman[which(longJumpWoman$Year == 2000 & longJumpWoman$Rank == "8"), "Result"])
vector_junior_year_8 <- c(longJumpWomanJunior[which(longJumpWomanJunior$Year == 2000 & longJumpWomanJunior$Rank == "8"), "Result"])
vector_youth_year_8 <- c(longJumpWomanYouth[which(longJumpWomanYouth$Year == 2001 & longJumpWomanYouth$Rank == "8"), "Result"])
for (year in 2001:2022){
  vector_senior_year_8[i] <- max(c(longJumpWoman[which(longJumpWoman$Year == year & longJumpWoman$Rank == "8"), "Result"], vector_senior_year_8[i-1]))
  i <- i + 1
  vector_junior_year_8[j] <- max(c(longJumpWomanJunior[which(longJumpWomanJunior$Year == year & longJumpWomanJunior$Rank == "8"), "Result"], vector_junior_year_8[j-1]))
  j <- j + 1
  vector_youth_year_8[k] <- max(c(longJumpWomanYouth[which(longJumpWomanYouth$Year == year & longJumpWomanYouth$Rank == "8"), "Result"], vector_youth_year_8[k-1]))
  k <- k + 1
}

vector_best_year <- c(vector_senior_year, vector_junior_year, vector_youth_year)
vector_8_year <- c(vector_senior_year_8, vector_junior_year_8, vector_youth_year_8)
v1 <- 2000:2022
years <- c(v1,v1,v1)
years
vector_class <- c()
vector_class[1:23] <- "Seniors"
vector_class[24:46] <- "Juniors"
vector_class[47:69] <- "Youth"
vector_class

df_result <- data.frame(Year = years,
                        Top_8 = vector_8_year,
                        Top_1 = vector_best_year,
                        Class = vector_class)
df_result

switzerland_athlete_Women_LongJump <- olympics[which(olympics$Discipline == "Long Jump"), ]
switzerland_athlete_Women_LongJump <- switzerland_athlete_Women_LongJump[which(switzerland_athlete_Women_LongJump$Year>=2000), ]
switzerland_athlete_Women_LongJump <- switzerland_athlete_Women_LongJump[which(switzerland_athlete_Women_LongJump$Gender == "Women"), ]
switzerland_athlete_Women_LongJump <- switzerland_athlete_Women_LongJump[which(switzerland_athlete_Women_LongJump$Nationality == "SUI"), ]
switzerland_athlete_Women_LongJump <- switzerland_athlete_Women_LongJump[which(switzerland_athlete_Women_LongJump$Result != ""), ]
# sprint400mMan <- sprint400mMan[which(sprint400mMan$Medal != ""), ]
switzerland_athlete_Women_LongJump[, "Result"] <- as.double(switzerland_athlete_Women_LongJump$Result)
summary(switzerland_athlete_Women_LongJump$Result)
table(switzerland_athlete_Women_LongJump$Person)


switzerland_athlete_Women_LongJump <- data.frame(Name = switzerland_athlete_Women_LongJump$Person,
                                               Result = switzerland_athlete_Women_LongJump$Result,
                                               Year = switzerland_athlete_Women_LongJump$Year,
                                               Class = switzerland_athlete_Women_LongJump$Class)

switzerland_athlete_Women_LongJump <- merge(x = switzerland_athlete_Women_LongJump,
                                          y = df_result, 
                                          by = c("Year", "Class")
)
switzerland_athlete_Women_LongJump


# Da fare in shiny con un input sul nome dell'atleta.

athlete_list_W_LongJump <- as.list(unique(switzerland_athlete_Women_LongJump$Name))
athlete_result <- c()
athlete_name <- c()
athlete_year <- c()
athlete_class <- c()
top8 <- c()
top1 <- c()
i = 1
for (name in athlete_list_W_LongJump){
  print(name)
  for (year in min(switzerland_athlete_Women_LongJump$Year):max(switzerland_athlete_Women_LongJump$Year)){
    print(year)
    if(length(switzerland_athlete_Women_LongJump[which(switzerland_athlete_Women_LongJump$Name == name 
                                                     & switzerland_athlete_Women_LongJump$Year == year), "Result"] != 0)){
      athlete_name[i] <- name
      
      athlete_result[i] <- max(switzerland_athlete_Women_LongJump[which(switzerland_athlete_Women_LongJump$Name == name
                                                                      & switzerland_athlete_Women_LongJump$Year == year),"Result"])
      athlete_year[i] <- year
      athlete_class[i] <- switzerland_athlete_Women_LongJump[which(switzerland_athlete_Women_LongJump$Result == athlete_result[i] &
                                                                     switzerland_athlete_Women_LongJump$Name == name & 
                                                                     switzerland_athlete_Women_LongJump$Year == year),"Class"]
      top1[i] <- switzerland_athlete_Women_LongJump[which(switzerland_athlete_Women_LongJump$Result == athlete_result[i] &
                                                          switzerland_athlete_Women_LongJump$Name == name & 
                                                          switzerland_athlete_Women_LongJump$Year == year),"Top_1"]
      print(top1[i])
      top8[i] <- switzerland_athlete_Women_LongJump[which(switzerland_athlete_Women_LongJump$Result == athlete_result[i] &
                                                            switzerland_athlete_Women_LongJump$Name == name & 
                                                            switzerland_athlete_Women_LongJump$Year == year),"Top_8"]
      i <- i + 1
    }
  }
}
athleteLongJumpW <- data.frame(Year = athlete_year,
                               Name = athlete_name,
                               Result = athlete_result,
                               Class = athlete_class,
                               Top_8 = top8,
                               Top_1 = top1)
athleteLongJumpW
```

```{r plotLJW1, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
pPusterla <- ggplot(data = athleteLongJumpW[which(athleteLongJumpW$Name == "Irene Pusterla"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Irene Pusterla") +
  xlab("Year") + 
  ylab("Distance") 

pKälin <- ggplot(data = athleteLongJumpW[which(athleteLongJumpW$Name == "Annik Kälin"), ],
            aes(x = Year, y = Result)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2.5) +
  geom_ribbon(aes(x = Year, ymax = Top_8, ymin = Top_1), fill = "blue", alpha = 0.2) +
  geom_text(
    aes(label = Result),
    nudge_x = 0.01,
    nudge_y = 0.1,
    check_overlap = TRUE,
    size = 4
  )  + 
  ggtitle("Difference of Suisse athletes in comparison with top 8 range, Annik Kälin") +
  xlab("Year") + 
  ylab("Distance") 

library(gridExtra)

grid.arrange(pPusterla, pKälin, ncol=1, nrow = 2)
```

The first graph is about the difference from the best performance of an athlete against the best results. The range of top results is represented by a blue coloured band in which the upper bound is the best time for a runner that finished the competition in the 8th palace and the lower bound is the best time of the winner .

In the first graph below, the radar chart, we want to compare athletes with best results in the world. In the next part, we are using a histogram counting the frequency of the difference in time from the minimum result to achieve a certificate. The black blocks represent the athlete count. The intervals have a width of 0.2s.

```{r radarchartLJW, echo=FALSE, include =FALSE, warning=FALSE, message=FALSE}
WRLJWomen <- max(longJumpWoman$Result)
WRLJWomenJ <- max(longJumpWomanJunior$Result)
WRLJWomenY <- max(longJumpWomanYouth$Result)

SRLJWomen <- max(athleteLongJumpW$Result[which(athleteLongJumpW$Class == "Seniors")])
SRLJWomenJ <- max(athleteLongJumpW$Result[which(athleteLongJumpW$Class == "Juniors")])
SRLJWomenY <- max(athleteLongJumpW$Result[which(athleteLongJumpW$Class == "Youth")])

i <- 1
a_name <- c()
result <- c()
class <- c()
wr <- c()
sr <- c()
for (name in athlete_list_W_LongJump){
  a_name[i] <- name
  if (max(athleteLongJumpW[which(athleteLongJumpW$Name == name & athleteLongJumpW$Class == "Seniors"), "Result"]) == -Inf){
    result[i] <- 0
  }
  else{
    result[i] <- (max(athleteLongJumpW[which(athleteLongJumpW$Name == name & athleteLongJumpW$Class == "Seniors"), "Result"]))/(WRLJWomen)
  }
  print(result[i])
  class[i] <- "Seniors"
  wr[i] <- 1
  sr[i] <- (SRLJWomen)/(WRLJWomen)
  i <- i + 1
}
i <- 1
a_nameJ <- c()
resultJ <- c()
classJ <- c()
wrJ <- c()
srJ <- c()
for (name in athlete_list_W_LongJump){
  a_nameJ[i] <- name
  if (max(athleteLongJumpW[which(athleteLongJumpW$Name == name & athleteLongJumpW$Class == "Juniors"), "Result"]) == -Inf){
    resultJ[i] <- 0
  }
  else{
    resultJ[i] <- (max(athleteLongJumpW[which(athleteLongJumpW$Name == name & athleteLongJumpW$Class == "Juniors"), "Result"]))/(WRLJWomenJ)
  }
  print(result[i])
  classJ[i] <- "Juniors"
  wrJ[i] <- 1
  srJ[i] <- (SRLJWomenJ)/(WRLJWomenJ)
  
  i <- i + 1
}
i <- 1
a_nameY <- c()
resultY <- c()
classY <- c()
wrY <- c()
srY <- c()
for (name in athlete_list_W_LongJump){
  a_nameY[i] <- name
  if (max(athleteLongJumpW[which(athleteLongJumpW$Name == name & athleteLongJumpW$Class == "Youth"), "Result"]) == -Inf){
    resultY[i] <- 0
  }
  else{
    resultY[i] <- (max(athleteLongJumpW[which(athleteLongJumpW$Name == name & athleteLongJumpW$Class == "Youth"), "Result"]))/(WRLJMenY)
  }
  classY[i] <- "Youth"
  wrY[i] <- 1
  srY[i] <- (SRLJWomenY)/(WRLJWomenY)
  i <- i + 1
}
i <- 1
radar_frameS <- data.frame(Name = a_name,
                           Result = result, 
                           Class = class, 
                           WR = wr,
                           SR = sr)
radar_frameJ <- data.frame(Name = a_nameJ,
                           Result = resultJ, 
                           Class = classJ, 
                           WR = wrJ,
                           SR = srJ)
radar_frameY <- data.frame(Name = a_nameY,
                           Result = resultY, 
                           Class = classY, 
                           WR = wrY,
                           SR = srY)

radar_frameLJW <- merge(x = merge(x = radar_frameS, y = radar_frameJ, by = "Name"), y = radar_frameY, by = "Name")
radar_frameLJW

radar_frameLJW <- subset(radar_frameLJW, select = -c(Class.x, WR.x, SR.x, Class.y, WR.y, SR.y, Class, WR, SR))

colnames(radar_frameLJW) <- c("Name", "Seniors", "Juniors", "Youth")

radar_frameLJW[(length(radar_frameLJW$Name) + 1), ] <- c("World Record in the class", 1,1,1)
radar_frameLJW[(length(radar_frameLJW$Name) + 1), ] <- c("Fictious baseline", 0,0,0)
radar_frameLJW[(length(radar_frameLJW$Name) + 1), ] <- c("Swiss Record in the class", (SRLJWomen)/(WRLJWomen),
                                                       (SRLJWomenJ)/(WRLJWomenJ), 
                                                       (SRLJWomenY)/(WRLJWomenY))
radar_frameLJW$Seniors <- as.numeric(radar_frameLJW$Seniors)
radar_frameLJW$Juniors <- as.numeric(radar_frameLJW$Juniors)
radar_frameLJW$Youth <- as.numeric(radar_frameLJW$Youth)
radar_frameLJW
```

```{r plotLJW2LS, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frameLJW[which(radar_frameLJW$Name == "Irene Pusterla" | radar_frameLJW$Name == "World Record in the class"
                               | radar_frameLJW$Name == "Fictious baseline" | radar_frameLJW$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frameLJW[which(radar_frameLJW$Name == "Irene Pusterla" | radar_frameLJW$Name == "World Record in the class"
                                              | radar_frameLJW$Name == "Fictious baseline" | radar_frameLJW$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=1, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

```{r plotLJW2RP, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
radarchart(radar_frameLJW[which(radar_frameLJW$Name == "Annik Kälin" | radar_frameLJW$Name == "World Record in the class"
                               | radar_frameLJW$Name == "Fictious baseline" | radar_frameLJW$Name == "Swiss Record in the class"), c("Seniors", "Juniors", "Youth") ],
           maxmin = FALSE,
           axistype = 1,
           vlabels = c("Seniors", "Juniors", "Youth"),
           vlcex = 1.1,
           pcol = c("red", "gold", "lightblue", "darkred"),
           plwd = c(3,1,1,2),
           plty = c("solid", "dashed", "dashed", "dashed"),
           caxislabels = c("0%", "25%", "50%", "75%", "100%"),
           axislabcol = 'grey', 
           cglwd = 0.6
)
legend(0.5,1.2, legend=unique(radar_frameLJW[which(radar_frameLJW$Name == "Annik Kälin" | radar_frameLJW$Name == "World Record in the class"
                                              | radar_frameLJW$Name == "Fictious baseline" | radar_frameLJW$Name == "Swiss Record in the class"), "Name"])
       , seg.len=0.5, pch=1, border = "black",
       bty="n" ,lwd=3, y.intersp=1, horiz=FALSE, col =c("red", "gold", "lightblue", "darkred")
)
```

**NB**: it is important to understand that, sometimes, athletes with good final results have 0% in one or two classes. This is not due to the fact that they were extremely bad at one point of their career. In fact, we can explain this problem with the lack of records. It could be that the athlete gained the chance to participate in one of the major competitions in a Senior age or that the athlete is still in Youth/Junior age and he has no records in the Senior class. 

```{r plotLJW3, echo=FALSE, include = TRUE, warning=FALSE, message=FALSE}
athleteLongJumpW[, "Difference_8"] <- athleteLongJumpW$Result - athleteLongJumpW$Top_8

pPusterla <- ggplot(data = athleteLongJumpW)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .2) +
  geom_histogram(data = athleteLongJumpW[which(athleteLongJumpW$Name == "Irene Pusterla"), ],
                 aes(x = Difference_8), binwidth = 0.2) +
  scale_fill_manual(name = "Irene Pusterla", values = heat.colors(4))  +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

pKälin <- ggplot(data = athleteLongJumpW)+
  geom_histogram(aes(x = Difference_8, fill = Class), binwidth = .2) +
  geom_histogram(data = athleteLongJumpW[which(athleteLongJumpW$Name == "Annik Kälin"), ],
                 aes(x = Difference_8), binwidth = 0.2) +
  scale_fill_manual(name = "Annik Kälin", values = heat.colors(4)) +
  theme(
    legend.title = element_text(
      family = "Calibri",
      face = "bold",
      size = 12),
    legend.background = element_rect(fill = "white", colour = "black"),
  )  +
  xlab("Difference from 8th best result") +
  ylab("Frequency")

library(gridExtra)

grid.arrange(pPusterla, pKälin, ncol=1, nrow = 2)
```

**NB**: in this case the more the black bars are on the right, the better the result of the athlete.

The general situation does not seem to be too positive, but neither too negative. We can say that the athletes are quite distant (more than 1 m on average) from the world record. At the moment a medal seems very distant, considering that the best athlete of the last 20 years, Irene Pusterla, could arrive in 12th position as her best result in a world competition, 7th considering a continental one. We are also worried about the lack of athletes in the Senior class between 2016 and 2022. Therefore, we suggest to keep monitoring the situation, and investing money in the discipline if necessary, otherwise the Federation risks to move backwards.
